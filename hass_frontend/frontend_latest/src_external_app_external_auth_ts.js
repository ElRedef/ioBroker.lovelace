"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(self["webpackChunkhome_assistant_frontend"] = self["webpackChunkhome_assistant_frontend"] || []).push([["src_external_app_external_auth_ts"],{

/***/ "./src/external_app/external_auth.ts":
/*!*******************************************!*\
  !*** ./src/external_app/external_auth.ts ***!
  \*******************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   ExternalAuth: () => (/* binding */ ExternalAuth),\n/* harmony export */   createExternalAuth: () => (/* binding */ createExternalAuth)\n/* harmony export */ });\n/* harmony import */ var home_assistant_js_websocket__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! home-assistant-js-websocket */ \"./node_modules/home-assistant-js-websocket/dist/auth.js\");\n/* harmony import */ var _external_messaging__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./external_messaging */ \"./src/external_app/external_messaging.ts\");\n/**\n * Auth class that connects to a native app for authentication.\n */\n\n\nconst CALLBACK_SET_TOKEN = \"externalAuthSetToken\";\nconst CALLBACK_REVOKE_TOKEN = \"externalAuthRevokeToken\";\nif (!window.externalApp && !window.webkit) {\n  throw new Error(\"External auth requires either externalApp or webkit defined on Window object.\");\n}\nclass ExternalAuth extends home_assistant_js_websocket__WEBPACK_IMPORTED_MODULE_1__.Auth {\n  constructor(hassUrl) {\n    super({\n      hassUrl,\n      clientId: \"\",\n      refresh_token: \"\",\n      access_token: \"\",\n      expires_in: 0,\n      // This will trigger connection to do a refresh right away\n      expires: 0\n    });\n    this.external = void 0;\n    this._tokenCallbackPromise = void 0;\n  }\n  async refreshAccessToken(force) {\n    if (this._tokenCallbackPromise && !force) {\n      try {\n        await this._tokenCallbackPromise;\n        return;\n      } catch (err) {\n        // _tokenCallbackPromise is in a rejected state\n        // Clear the _tokenCallbackPromise and go on refreshing access token\n        this._tokenCallbackPromise = undefined;\n      }\n    }\n    const payload = {\n      callback: CALLBACK_SET_TOKEN\n    };\n    if (force) {\n      payload.force = true;\n    }\n    this._tokenCallbackPromise = new Promise((resolve, reject) => {\n      window[CALLBACK_SET_TOKEN] = (success, data) => success ? resolve(data) : reject(data);\n    });\n\n    // we sleep 1 microtask to get the promise to actually set it on the window object.\n    await Promise.resolve();\n    if (window.externalApp) {\n      window.externalApp.getExternalAuth(JSON.stringify(payload));\n    } else {\n      window.webkit.messageHandlers.getExternalAuth.postMessage(payload);\n    }\n    const tokens = await this._tokenCallbackPromise;\n    this.data.access_token = tokens.access_token;\n    this.data.expires = tokens.expires_in * 1000 + Date.now();\n    this._tokenCallbackPromise = undefined;\n  }\n  async revoke() {\n    const payload = {\n      callback: CALLBACK_REVOKE_TOKEN\n    };\n    const callbackPromise = new Promise((resolve, reject) => {\n      window[CALLBACK_REVOKE_TOKEN] = (success, data) => success ? resolve(data) : reject(data);\n    });\n\n    // we sleep 1 microtask to get the promise to actually set it on the window object.\n    await Promise.resolve();\n    if (window.externalApp) {\n      window.externalApp.revokeExternalAuth(JSON.stringify(payload));\n    } else {\n      window.webkit.messageHandlers.revokeExternalAuth.postMessage(payload);\n    }\n    await callbackPromise;\n  }\n}\nconst createExternalAuth = async hassUrl => {\n  const auth = new ExternalAuth(hassUrl);\n  if (window.externalApp && window.externalApp.externalBus || window.webkit && window.webkit.messageHandlers.externalBus) {\n    auth.external = new _external_messaging__WEBPACK_IMPORTED_MODULE_0__.ExternalMessaging();\n    await auth.external.attach();\n  }\n  return auth;\n};//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvZXh0ZXJuYWxfYXBwL2V4dGVybmFsX2F1dGgudHMuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7OztBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBc0NBO0FBQ0E7QUFHQTtBQUVBO0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQVhBO0FBWUE7QUFJQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFFQTtBQUVBOztBQUdBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFBQTtBQUFBO0FBRUE7QUFDQTtBQUVBOztBQUVBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBSUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSIsInNvdXJjZXMiOlsid2VicGFjazovL2hvbWUtYXNzaXN0YW50LWZyb250ZW5kLy4vc3JjL2V4dGVybmFsX2FwcC9leHRlcm5hbF9hdXRoLnRzP2RjMWYiXSwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBBdXRoIGNsYXNzIHRoYXQgY29ubmVjdHMgdG8gYSBuYXRpdmUgYXBwIGZvciBhdXRoZW50aWNhdGlvbi5cbiAqL1xuaW1wb3J0IHsgQXV0aCB9IGZyb20gXCJob21lLWFzc2lzdGFudC1qcy13ZWJzb2NrZXRcIjtcbmltcG9ydCB7IEV4dGVybmFsTWVzc2FnaW5nLCBFTU1lc3NhZ2UgfSBmcm9tIFwiLi9leHRlcm5hbF9tZXNzYWdpbmdcIjtcblxuY29uc3QgQ0FMTEJBQ0tfU0VUX1RPS0VOID0gXCJleHRlcm5hbEF1dGhTZXRUb2tlblwiO1xuY29uc3QgQ0FMTEJBQ0tfUkVWT0tFX1RPS0VOID0gXCJleHRlcm5hbEF1dGhSZXZva2VUb2tlblwiO1xuXG5pbnRlcmZhY2UgQmFzZVBheWxvYWQge1xuICBjYWxsYmFjazogc3RyaW5nO1xufVxuXG5pbnRlcmZhY2UgR2V0RXh0ZXJuYWxBdXRoUGF5bG9hZCBleHRlbmRzIEJhc2VQYXlsb2FkIHtcbiAgZm9yY2U/OiBib29sZWFuO1xufVxuXG5pbnRlcmZhY2UgUmVmcmVzaFRva2VuUmVzcG9uc2Uge1xuICBhY2Nlc3NfdG9rZW46IHN0cmluZztcbiAgZXhwaXJlc19pbjogbnVtYmVyO1xufVxuXG5kZWNsYXJlIGdsb2JhbCB7XG4gIGludGVyZmFjZSBXaW5kb3cge1xuICAgIGV4dGVybmFsQXBwPzoge1xuICAgICAgZ2V0RXh0ZXJuYWxBdXRoKHBheWxvYWQ6IHN0cmluZyk7XG4gICAgICByZXZva2VFeHRlcm5hbEF1dGgocGF5bG9hZDogc3RyaW5nKTtcbiAgICAgIGV4dGVybmFsQnVzKHBheWxvYWQ6IHN0cmluZyk7XG4gICAgfTtcbiAgICB3ZWJraXQ/OiB7XG4gICAgICBtZXNzYWdlSGFuZGxlcnM6IHtcbiAgICAgICAgZ2V0RXh0ZXJuYWxBdXRoOiB7XG4gICAgICAgICAgcG9zdE1lc3NhZ2UocGF5bG9hZDogR2V0RXh0ZXJuYWxBdXRoUGF5bG9hZCk7XG4gICAgICAgIH07XG4gICAgICAgIHJldm9rZUV4dGVybmFsQXV0aDoge1xuICAgICAgICAgIHBvc3RNZXNzYWdlKHBheWxvYWQ6IEJhc2VQYXlsb2FkKTtcbiAgICAgICAgfTtcbiAgICAgICAgZXh0ZXJuYWxCdXM6IHtcbiAgICAgICAgICBwb3N0TWVzc2FnZShwYXlsb2FkOiBFTU1lc3NhZ2UpO1xuICAgICAgICB9O1xuICAgICAgfTtcbiAgICB9O1xuICB9XG59XG5cbmlmICghd2luZG93LmV4dGVybmFsQXBwICYmICF3aW5kb3cud2Via2l0KSB7XG4gIHRocm93IG5ldyBFcnJvcihcbiAgICBcIkV4dGVybmFsIGF1dGggcmVxdWlyZXMgZWl0aGVyIGV4dGVybmFsQXBwIG9yIHdlYmtpdCBkZWZpbmVkIG9uIFdpbmRvdyBvYmplY3QuXCJcbiAgKTtcbn1cblxuZXhwb3J0IGNsYXNzIEV4dGVybmFsQXV0aCBleHRlbmRzIEF1dGgge1xuICBwdWJsaWMgZXh0ZXJuYWw/OiBFeHRlcm5hbE1lc3NhZ2luZztcblxuICBjb25zdHJ1Y3RvcihoYXNzVXJsOiBzdHJpbmcpIHtcbiAgICBzdXBlcih7XG4gICAgICBoYXNzVXJsLFxuICAgICAgY2xpZW50SWQ6IFwiXCIsXG4gICAgICByZWZyZXNoX3Rva2VuOiBcIlwiLFxuICAgICAgYWNjZXNzX3Rva2VuOiBcIlwiLFxuICAgICAgZXhwaXJlc19pbjogMCxcbiAgICAgIC8vIFRoaXMgd2lsbCB0cmlnZ2VyIGNvbm5lY3Rpb24gdG8gZG8gYSByZWZyZXNoIHJpZ2h0IGF3YXlcbiAgICAgIGV4cGlyZXM6IDAsXG4gICAgfSk7XG4gIH1cblxuICBwcml2YXRlIF90b2tlbkNhbGxiYWNrUHJvbWlzZT86IFByb21pc2U8UmVmcmVzaFRva2VuUmVzcG9uc2U+O1xuXG4gIHB1YmxpYyBhc3luYyByZWZyZXNoQWNjZXNzVG9rZW4oZm9yY2U/OiBib29sZWFuKSB7XG4gICAgaWYgKHRoaXMuX3Rva2VuQ2FsbGJhY2tQcm9taXNlICYmICFmb3JjZSkge1xuICAgICAgdHJ5IHtcbiAgICAgICAgYXdhaXQgdGhpcy5fdG9rZW5DYWxsYmFja1Byb21pc2U7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH0gY2F0Y2ggKGVycjogYW55KSB7XG4gICAgICAgIC8vIF90b2tlbkNhbGxiYWNrUHJvbWlzZSBpcyBpbiBhIHJlamVjdGVkIHN0YXRlXG4gICAgICAgIC8vIENsZWFyIHRoZSBfdG9rZW5DYWxsYmFja1Byb21pc2UgYW5kIGdvIG9uIHJlZnJlc2hpbmcgYWNjZXNzIHRva2VuXG4gICAgICAgIHRoaXMuX3Rva2VuQ2FsbGJhY2tQcm9taXNlID0gdW5kZWZpbmVkO1xuICAgICAgfVxuICAgIH1cbiAgICBjb25zdCBwYXlsb2FkOiBHZXRFeHRlcm5hbEF1dGhQYXlsb2FkID0ge1xuICAgICAgY2FsbGJhY2s6IENBTExCQUNLX1NFVF9UT0tFTixcbiAgICB9O1xuICAgIGlmIChmb3JjZSkge1xuICAgICAgcGF5bG9hZC5mb3JjZSA9IHRydWU7XG4gICAgfVxuXG4gICAgdGhpcy5fdG9rZW5DYWxsYmFja1Byb21pc2UgPSBuZXcgUHJvbWlzZTxSZWZyZXNoVG9rZW5SZXNwb25zZT4oXG4gICAgICAocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG4gICAgICAgIHdpbmRvd1tDQUxMQkFDS19TRVRfVE9LRU5dID0gKHN1Y2Nlc3MsIGRhdGEpID0+XG4gICAgICAgICAgc3VjY2VzcyA/IHJlc29sdmUoZGF0YSkgOiByZWplY3QoZGF0YSk7XG4gICAgICB9XG4gICAgKTtcblxuICAgIC8vIHdlIHNsZWVwIDEgbWljcm90YXNrIHRvIGdldCB0aGUgcHJvbWlzZSB0byBhY3R1YWxseSBzZXQgaXQgb24gdGhlIHdpbmRvdyBvYmplY3QuXG4gICAgYXdhaXQgUHJvbWlzZS5yZXNvbHZlKCk7XG5cbiAgICBpZiAod2luZG93LmV4dGVybmFsQXBwKSB7XG4gICAgICB3aW5kb3cuZXh0ZXJuYWxBcHAuZ2V0RXh0ZXJuYWxBdXRoKEpTT04uc3RyaW5naWZ5KHBheWxvYWQpKTtcbiAgICB9IGVsc2Uge1xuICAgICAgd2luZG93LndlYmtpdCEubWVzc2FnZUhhbmRsZXJzLmdldEV4dGVybmFsQXV0aC5wb3N0TWVzc2FnZShwYXlsb2FkKTtcbiAgICB9XG5cbiAgICBjb25zdCB0b2tlbnMgPSBhd2FpdCB0aGlzLl90b2tlbkNhbGxiYWNrUHJvbWlzZTtcblxuICAgIHRoaXMuZGF0YS5hY2Nlc3NfdG9rZW4gPSB0b2tlbnMuYWNjZXNzX3Rva2VuO1xuICAgIHRoaXMuZGF0YS5leHBpcmVzID0gdG9rZW5zLmV4cGlyZXNfaW4gKiAxMDAwICsgRGF0ZS5ub3coKTtcbiAgICB0aGlzLl90b2tlbkNhbGxiYWNrUHJvbWlzZSA9IHVuZGVmaW5lZDtcbiAgfVxuXG4gIHB1YmxpYyBhc3luYyByZXZva2UoKSB7XG4gICAgY29uc3QgcGF5bG9hZDogQmFzZVBheWxvYWQgPSB7IGNhbGxiYWNrOiBDQUxMQkFDS19SRVZPS0VfVE9LRU4gfTtcblxuICAgIGNvbnN0IGNhbGxiYWNrUHJvbWlzZSA9IG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICAgIHdpbmRvd1tDQUxMQkFDS19SRVZPS0VfVE9LRU5dID0gKHN1Y2Nlc3MsIGRhdGEpID0+XG4gICAgICAgIHN1Y2Nlc3MgPyByZXNvbHZlKGRhdGEpIDogcmVqZWN0KGRhdGEpO1xuICAgIH0pO1xuXG4gICAgLy8gd2Ugc2xlZXAgMSBtaWNyb3Rhc2sgdG8gZ2V0IHRoZSBwcm9taXNlIHRvIGFjdHVhbGx5IHNldCBpdCBvbiB0aGUgd2luZG93IG9iamVjdC5cbiAgICBhd2FpdCBQcm9taXNlLnJlc29sdmUoKTtcblxuICAgIGlmICh3aW5kb3cuZXh0ZXJuYWxBcHApIHtcbiAgICAgIHdpbmRvdy5leHRlcm5hbEFwcC5yZXZva2VFeHRlcm5hbEF1dGgoSlNPTi5zdHJpbmdpZnkocGF5bG9hZCkpO1xuICAgIH0gZWxzZSB7XG4gICAgICB3aW5kb3cud2Via2l0IS5tZXNzYWdlSGFuZGxlcnMucmV2b2tlRXh0ZXJuYWxBdXRoLnBvc3RNZXNzYWdlKHBheWxvYWQpO1xuICAgIH1cblxuICAgIGF3YWl0IGNhbGxiYWNrUHJvbWlzZTtcbiAgfVxufVxuXG5leHBvcnQgY29uc3QgY3JlYXRlRXh0ZXJuYWxBdXRoID0gYXN5bmMgKGhhc3NVcmw6IHN0cmluZykgPT4ge1xuICBjb25zdCBhdXRoID0gbmV3IEV4dGVybmFsQXV0aChoYXNzVXJsKTtcbiAgaWYgKFxuICAgICh3aW5kb3cuZXh0ZXJuYWxBcHAgJiYgd2luZG93LmV4dGVybmFsQXBwLmV4dGVybmFsQnVzKSB8fFxuICAgICh3aW5kb3cud2Via2l0ICYmIHdpbmRvdy53ZWJraXQubWVzc2FnZUhhbmRsZXJzLmV4dGVybmFsQnVzKVxuICApIHtcbiAgICBhdXRoLmV4dGVybmFsID0gbmV3IEV4dGVybmFsTWVzc2FnaW5nKCk7XG4gICAgYXdhaXQgYXV0aC5leHRlcm5hbC5hdHRhY2goKTtcbiAgfVxuICByZXR1cm4gYXV0aDtcbn07XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./src/external_app/external_auth.ts\n");

/***/ }),

/***/ "./src/external_app/external_messaging.ts":
/*!************************************************!*\
  !*** ./src/external_app/external_messaging.ts ***!
  \************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   ExternalMessaging: () => (/* binding */ ExternalMessaging)\n/* harmony export */ });\nconst CALLBACK_EXTERNAL_BUS = \"externalBus\";\nclass ExternalMessaging {\n  constructor() {\n    this.config = void 0;\n    this.commands = {};\n    this.msgId = 0;\n    this._commandHandler = void 0;\n  }\n  async attach() {\n    window[CALLBACK_EXTERNAL_BUS] = msg => this.receiveMessage(msg);\n    window.addEventListener(\"connection-status\", ev => this.fireMessage({\n      type: \"connection-status\",\n      payload: {\n        event: ev.detail\n      }\n    }));\n    this.config = await this.sendMessage({\n      type: \"config/get\"\n    });\n  }\n  addCommandHandler(handler) {\n    this._commandHandler = handler;\n  }\n\n  /**\n   * Send message to external app that expects a response.\n   * @param msg message to send\n   */\n  sendMessage(msg) {\n    const msgId = ++this.msgId;\n    msg.id = msgId;\n    this._sendExternal(msg);\n    return new Promise((resolve, reject) => {\n      this.commands[msgId] = {\n        resolve,\n        reject\n      };\n    });\n  }\n\n  /**\n   * Send message to external app without expecting a response.\n   * @param msg message to send\n   */\n  fireMessage(msg) {\n    if (!msg.id) {\n      msg.id = ++this.msgId;\n    }\n    this._sendExternal(msg);\n  }\n  receiveMessage(msg) {\n    if (true) {\n      // eslint-disable-next-line no-console\n      console.log(\"Receiving message from external app\", msg);\n    }\n    if (msg.type === \"command\") {\n      if (!this._commandHandler || !this._commandHandler(msg)) {\n        let code;\n        let message;\n        if (this._commandHandler) {\n          code = \"not_ready\";\n          message = \"Command handler not ready\";\n        } else {\n          code = \"unknown_command\";\n          message = `Unknown command ${msg.command}`;\n        }\n        // eslint-disable-next-line no-console\n        console.warn(message, msg);\n        this.fireMessage({\n          id: msg.id,\n          type: \"result\",\n          success: false,\n          error: {\n            code,\n            message\n          }\n        });\n      }\n      return;\n    }\n    const pendingCmd = this.commands[msg.id];\n    if (!pendingCmd) {\n      // eslint-disable-next-line no-console\n      console.warn(`Received unknown msg ID`, msg.id);\n      return;\n    }\n    if (msg.type === \"result\") {\n      if (msg.success) {\n        pendingCmd.resolve(msg.result);\n      } else {\n        pendingCmd.reject(msg.error);\n      }\n    }\n  }\n  _sendExternal(msg) {\n    if (true) {\n      // eslint-disable-next-line no-console\n      console.log(\"Sending message to external app\", msg);\n    }\n    if (window.externalApp) {\n      window.externalApp.externalBus(JSON.stringify(msg));\n    } else {\n      window.webkit.messageHandlers.externalBus.postMessage(msg);\n    }\n  }\n}//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvZXh0ZXJuYWxfYXBwL2V4dGVybmFsX21lc3NhZ2luZy50cy5qcyIsIm1hcHBpbmdzIjoiOzs7O0FBQUE7QUFzS0E7QUFBQTtBQUFBO0FBQ0E7QUFFQTtBQUVBO0FBRUE7QUFFQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQUE7QUFBQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUdBO0FBQ0E7QUFFQTtBQUVBO0FBRUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSIsInNvdXJjZXMiOlsid2VicGFjazovL2hvbWUtYXNzaXN0YW50LWZyb250ZW5kLy4vc3JjL2V4dGVybmFsX2FwcC9leHRlcm5hbF9tZXNzYWdpbmcudHM/MDc3OCJdLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCBDQUxMQkFDS19FWFRFUk5BTF9CVVMgPSBcImV4dGVybmFsQnVzXCI7XG5cbmludGVyZmFjZSBDb21tYW5kSW5GbGlnaHQge1xuICByZXNvbHZlOiAoZGF0YTogYW55KSA9PiB2b2lkO1xuICByZWplY3Q6IChlcnI6IEVNRXJyb3IpID0+IHZvaWQ7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgRU1NZXNzYWdlIHtcbiAgaWQ/OiBudW1iZXI7XG4gIHR5cGU6IHN0cmluZztcbn1cblxuaW50ZXJmYWNlIEVNRXJyb3Ige1xuICBjb2RlOiBzdHJpbmc7XG4gIG1lc3NhZ2U6IHN0cmluZztcbn1cblxuaW50ZXJmYWNlIEVNTWVzc2FnZVJlc3VsdFN1Y2Nlc3Mge1xuICBpZDogbnVtYmVyO1xuICB0eXBlOiBcInJlc3VsdFwiO1xuICBzdWNjZXNzOiB0cnVlO1xuICByZXN1bHQ6IHVua25vd247XG59XG5cbmludGVyZmFjZSBFTU1lc3NhZ2VSZXN1bHRFcnJvciB7XG4gIGlkOiBudW1iZXI7XG4gIHR5cGU6IFwicmVzdWx0XCI7XG4gIHN1Y2Nlc3M6IGZhbHNlO1xuICBlcnJvcjogRU1FcnJvcjtcbn1cblxuaW50ZXJmYWNlIEVNT3V0Z29pbmdNZXNzYWdlQ29uZmlnR2V0IGV4dGVuZHMgRU1NZXNzYWdlIHtcbiAgdHlwZTogXCJjb25maWcvZ2V0XCI7XG59XG5cbmludGVyZmFjZSBFTU91dGdvaW5nTWVzc2FnZU1hdHRlckNvbW1pc3Npb24gZXh0ZW5kcyBFTU1lc3NhZ2Uge1xuICB0eXBlOiBcIm1hdHRlci9jb21taXNzaW9uXCI7XG59XG5cbnR5cGUgRU1PdXRnb2luZ01lc3NhZ2VXaXRoQW5zd2VyID0ge1xuICBcImNvbmZpZy9nZXRcIjoge1xuICAgIHJlcXVlc3Q6IEVNT3V0Z29pbmdNZXNzYWdlQ29uZmlnR2V0O1xuICAgIHJlc3BvbnNlOiBFeHRlcm5hbENvbmZpZztcbiAgfTtcbn07XG5cbmludGVyZmFjZSBFTU91dGdvaW5nTWVzc2FnZUV4b3BsYXllclBsYXlITFMgZXh0ZW5kcyBFTU1lc3NhZ2Uge1xuICB0eXBlOiBcImV4b3BsYXllci9wbGF5X2hsc1wiO1xuICBwYXlsb2FkOiB7XG4gICAgdXJsOiBzdHJpbmc7XG4gICAgbXV0ZWQ6IGJvb2xlYW47XG4gIH07XG59XG5pbnRlcmZhY2UgRU1PdXRnb2luZ01lc3NhZ2VFeG9wbGF5ZXJSZXNpemUgZXh0ZW5kcyBFTU1lc3NhZ2Uge1xuICB0eXBlOiBcImV4b3BsYXllci9yZXNpemVcIjtcbiAgcGF5bG9hZDoge1xuICAgIGxlZnQ6IG51bWJlcjtcbiAgICB0b3A6IG51bWJlcjtcbiAgICByaWdodDogbnVtYmVyO1xuICAgIGJvdHRvbTogbnVtYmVyO1xuICB9O1xufVxuXG5pbnRlcmZhY2UgRU1PdXRnb2luZ01lc3NhZ2VFeG9wbGF5ZXJTdG9wIGV4dGVuZHMgRU1NZXNzYWdlIHtcbiAgdHlwZTogXCJleG9wbGF5ZXIvc3RvcFwiO1xufVxuXG5pbnRlcmZhY2UgRU1PdXRnb2luZ01lc3NhZ2VUaGVtZVVwZGF0ZSBleHRlbmRzIEVNTWVzc2FnZSB7XG4gIHR5cGU6IFwidGhlbWUtdXBkYXRlXCI7XG59XG5cbmludGVyZmFjZSBFTU91dGdvaW5nTWVzc2FnZUhhcHRpYyBleHRlbmRzIEVNTWVzc2FnZSB7XG4gIHR5cGU6IFwiaGFwdGljXCI7XG4gIHBheWxvYWQ6IHsgaGFwdGljVHlwZTogc3RyaW5nIH07XG59XG5cbmludGVyZmFjZSBFTU91dGdvaW5nTWVzc2FnZUNvbm5lY3Rpb25TdGF0dXMgZXh0ZW5kcyBFTU1lc3NhZ2Uge1xuICB0eXBlOiBcImNvbm5lY3Rpb24tc3RhdHVzXCI7XG4gIHBheWxvYWQ6IHsgZXZlbnQ6IHN0cmluZyB9O1xufVxuXG5pbnRlcmZhY2UgRU1PdXRnb2luZ01lc3NhZ2VBcHBDb25maWd1cmF0aW9uIGV4dGVuZHMgRU1NZXNzYWdlIHtcbiAgdHlwZTogXCJjb25maWdfc2NyZWVuL3Nob3dcIjtcbn1cblxuaW50ZXJmYWNlIEVNT3V0Z29pbmdNZXNzYWdlVGFnV3JpdGUgZXh0ZW5kcyBFTU1lc3NhZ2Uge1xuICB0eXBlOiBcInRhZy93cml0ZVwiO1xuICBwYXlsb2FkOiB7XG4gICAgbmFtZTogc3RyaW5nIHwgbnVsbDtcbiAgICB0YWc6IHN0cmluZztcbiAgfTtcbn1cblxuaW50ZXJmYWNlIEVNT3V0Z29pbmdNZXNzYWdlU2lkZWJhclNob3cgZXh0ZW5kcyBFTU1lc3NhZ2Uge1xuICB0eXBlOiBcInNpZGViYXIvc2hvd1wiO1xufVxuXG5pbnRlcmZhY2UgRU1PdXRnb2luZ01lc3NhZ2VBc3Npc3RTaG93IGV4dGVuZHMgRU1NZXNzYWdlIHtcbiAgdHlwZTogXCJhc3Npc3Qvc2hvd1wiO1xuICBwYXlsb2FkPzoge1xuICAgIHBpcGVsaW5lX2lkPzogc3RyaW5nO1xuICAgIHN0YXJ0X2xpc3RlbmluZz86IGJvb2xlYW47XG4gIH07XG59XG5cbnR5cGUgRU1PdXRnb2luZ01lc3NhZ2VXaXRob3V0QW5zd2VyID1cbiAgfCBFTU91dGdvaW5nTWVzc2FnZUhhcHRpY1xuICB8IEVNT3V0Z29pbmdNZXNzYWdlQ29ubmVjdGlvblN0YXR1c1xuICB8IEVNT3V0Z29pbmdNZXNzYWdlQXBwQ29uZmlndXJhdGlvblxuICB8IEVNT3V0Z29pbmdNZXNzYWdlVGFnV3JpdGVcbiAgfCBFTU91dGdvaW5nTWVzc2FnZVNpZGViYXJTaG93XG4gIHwgRU1PdXRnb2luZ01lc3NhZ2VBc3Npc3RTaG93XG4gIHwgRU1PdXRnb2luZ01lc3NhZ2VFeG9wbGF5ZXJQbGF5SExTXG4gIHwgRU1PdXRnb2luZ01lc3NhZ2VFeG9wbGF5ZXJSZXNpemVcbiAgfCBFTU91dGdvaW5nTWVzc2FnZUV4b3BsYXllclN0b3BcbiAgfCBFTU91dGdvaW5nTWVzc2FnZVRoZW1lVXBkYXRlXG4gIHwgRU1NZXNzYWdlUmVzdWx0U3VjY2Vzc1xuICB8IEVNTWVzc2FnZVJlc3VsdEVycm9yXG4gIHwgRU1PdXRnb2luZ01lc3NhZ2VNYXR0ZXJDb21taXNzaW9uO1xuXG5pbnRlcmZhY2UgRU1JbmNvbWluZ01lc3NhZ2VSZXN0YXJ0IHtcbiAgaWQ6IG51bWJlcjtcbiAgdHlwZTogXCJjb21tYW5kXCI7XG4gIGNvbW1hbmQ6IFwicmVzdGFydFwiO1xufVxuXG5pbnRlcmZhY2UgRU1JbmNvbWluZ01lc3NhZ2VTaG93Tm90aWZpY2F0aW9ucyB7XG4gIGlkOiBudW1iZXI7XG4gIHR5cGU6IFwiY29tbWFuZFwiO1xuICBjb21tYW5kOiBcIm5vdGlmaWNhdGlvbnMvc2hvd1wiO1xufVxuXG5pbnRlcmZhY2UgRU1JbmNvbWluZ01lc3NhZ2VUb2dnbGVTaWRlYmFyIHtcbiAgaWQ6IG51bWJlcjtcbiAgdHlwZTogXCJjb21tYW5kXCI7XG4gIGNvbW1hbmQ6IFwic2lkZWJhci90b2dnbGVcIjtcbn1cblxuaW50ZXJmYWNlIEVNSW5jb21pbmdNZXNzYWdlU2hvd1NpZGViYXIge1xuICBpZDogbnVtYmVyO1xuICB0eXBlOiBcImNvbW1hbmRcIjtcbiAgY29tbWFuZDogXCJzaWRlYmFyL3Nob3dcIjtcbn1cblxuZXhwb3J0IHR5cGUgRU1JbmNvbWluZ01lc3NhZ2VDb21tYW5kcyA9XG4gIHwgRU1JbmNvbWluZ01lc3NhZ2VSZXN0YXJ0XG4gIHwgRU1JbmNvbWluZ01lc3NhZ2VTaG93Tm90aWZpY2F0aW9uc1xuICB8IEVNSW5jb21pbmdNZXNzYWdlVG9nZ2xlU2lkZWJhclxuICB8IEVNSW5jb21pbmdNZXNzYWdlU2hvd1NpZGViYXI7XG5cbnR5cGUgRU1JbmNvbWluZ01lc3NhZ2UgPVxuICB8IEVNTWVzc2FnZVJlc3VsdFN1Y2Nlc3NcbiAgfCBFTU1lc3NhZ2VSZXN1bHRFcnJvclxuICB8IEVNSW5jb21pbmdNZXNzYWdlQ29tbWFuZHM7XG5cbnR5cGUgRU1JbmNvbWluZ01lc3NhZ2VIYW5kbGVyID0gKG1zZzogRU1JbmNvbWluZ01lc3NhZ2VDb21tYW5kcykgPT4gYm9vbGVhbjtcblxuZXhwb3J0IGludGVyZmFjZSBFeHRlcm5hbENvbmZpZyB7XG4gIGhhc1NldHRpbmdzU2NyZWVuOiBib29sZWFuO1xuICBoYXNTaWRlYmFyOiBib29sZWFuO1xuICBjYW5Xcml0ZVRhZzogYm9vbGVhbjtcbiAgaGFzRXhvUGxheWVyOiBib29sZWFuO1xuICBjYW5Db21taXNzaW9uTWF0dGVyOiBib29sZWFuO1xuICBoYXNBc3Npc3Q6IGJvb2xlYW47XG59XG5cbmV4cG9ydCBjbGFzcyBFeHRlcm5hbE1lc3NhZ2luZyB7XG4gIHB1YmxpYyBjb25maWchOiBFeHRlcm5hbENvbmZpZztcblxuICBwdWJsaWMgY29tbWFuZHM6IHsgW21zZ0lkOiBudW1iZXJdOiBDb21tYW5kSW5GbGlnaHQgfSA9IHt9O1xuXG4gIHB1YmxpYyBtc2dJZCA9IDA7XG5cbiAgcHJpdmF0ZSBfY29tbWFuZEhhbmRsZXI/OiBFTUluY29taW5nTWVzc2FnZUhhbmRsZXI7XG5cbiAgcHVibGljIGFzeW5jIGF0dGFjaCgpIHtcbiAgICB3aW5kb3dbQ0FMTEJBQ0tfRVhURVJOQUxfQlVTXSA9IChtc2cpID0+IHRoaXMucmVjZWl2ZU1lc3NhZ2UobXNnKTtcbiAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcihcImNvbm5lY3Rpb24tc3RhdHVzXCIsIChldikgPT5cbiAgICAgIHRoaXMuZmlyZU1lc3NhZ2Uoe1xuICAgICAgICB0eXBlOiBcImNvbm5lY3Rpb24tc3RhdHVzXCIsXG4gICAgICAgIHBheWxvYWQ6IHsgZXZlbnQ6IGV2LmRldGFpbCB9LFxuICAgICAgfSlcbiAgICApO1xuICAgIHRoaXMuY29uZmlnID0gYXdhaXQgdGhpcy5zZW5kTWVzc2FnZTxcImNvbmZpZy9nZXRcIj4oe1xuICAgICAgdHlwZTogXCJjb25maWcvZ2V0XCIsXG4gICAgfSk7XG4gIH1cblxuICBwdWJsaWMgYWRkQ29tbWFuZEhhbmRsZXIoaGFuZGxlcjogRU1JbmNvbWluZ01lc3NhZ2VIYW5kbGVyKSB7XG4gICAgdGhpcy5fY29tbWFuZEhhbmRsZXIgPSBoYW5kbGVyO1xuICB9XG5cbiAgLyoqXG4gICAqIFNlbmQgbWVzc2FnZSB0byBleHRlcm5hbCBhcHAgdGhhdCBleHBlY3RzIGEgcmVzcG9uc2UuXG4gICAqIEBwYXJhbSBtc2cgbWVzc2FnZSB0byBzZW5kXG4gICAqL1xuICBwdWJsaWMgc2VuZE1lc3NhZ2U8VCBleHRlbmRzIGtleW9mIEVNT3V0Z29pbmdNZXNzYWdlV2l0aEFuc3dlcj4oXG4gICAgbXNnOiBFTU91dGdvaW5nTWVzc2FnZVdpdGhBbnN3ZXJbVF1bXCJyZXF1ZXN0XCJdXG4gICk6IFByb21pc2U8RU1PdXRnb2luZ01lc3NhZ2VXaXRoQW5zd2VyW1RdW1wicmVzcG9uc2VcIl0+IHtcbiAgICBjb25zdCBtc2dJZCA9ICsrdGhpcy5tc2dJZDtcbiAgICBtc2cuaWQgPSBtc2dJZDtcblxuICAgIHRoaXMuX3NlbmRFeHRlcm5hbChtc2cpO1xuXG4gICAgcmV0dXJuIG5ldyBQcm9taXNlPEVNT3V0Z29pbmdNZXNzYWdlV2l0aEFuc3dlcltUXVtcInJlc3BvbnNlXCJdPihcbiAgICAgIChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICAgICAgdGhpcy5jb21tYW5kc1ttc2dJZF0gPSB7IHJlc29sdmUsIHJlamVjdCB9O1xuICAgICAgfVxuICAgICk7XG4gIH1cblxuICAvKipcbiAgICogU2VuZCBtZXNzYWdlIHRvIGV4dGVybmFsIGFwcCB3aXRob3V0IGV4cGVjdGluZyBhIHJlc3BvbnNlLlxuICAgKiBAcGFyYW0gbXNnIG1lc3NhZ2UgdG8gc2VuZFxuICAgKi9cbiAgcHVibGljIGZpcmVNZXNzYWdlKG1zZzogRU1PdXRnb2luZ01lc3NhZ2VXaXRob3V0QW5zd2VyKSB7XG4gICAgaWYgKCFtc2cuaWQpIHtcbiAgICAgIG1zZy5pZCA9ICsrdGhpcy5tc2dJZDtcbiAgICB9XG4gICAgdGhpcy5fc2VuZEV4dGVybmFsKG1zZyk7XG4gIH1cblxuICBwdWJsaWMgcmVjZWl2ZU1lc3NhZ2UobXNnOiBFTUluY29taW5nTWVzc2FnZSkge1xuICAgIGlmIChfX0RFVl9fKSB7XG4gICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tY29uc29sZVxuICAgICAgY29uc29sZS5sb2coXCJSZWNlaXZpbmcgbWVzc2FnZSBmcm9tIGV4dGVybmFsIGFwcFwiLCBtc2cpO1xuICAgIH1cblxuICAgIGlmIChtc2cudHlwZSA9PT0gXCJjb21tYW5kXCIpIHtcbiAgICAgIGlmICghdGhpcy5fY29tbWFuZEhhbmRsZXIgfHwgIXRoaXMuX2NvbW1hbmRIYW5kbGVyKG1zZykpIHtcbiAgICAgICAgbGV0IGNvZGU6IHN0cmluZztcbiAgICAgICAgbGV0IG1lc3NhZ2U6IHN0cmluZztcbiAgICAgICAgaWYgKHRoaXMuX2NvbW1hbmRIYW5kbGVyKSB7XG4gICAgICAgICAgY29kZSA9IFwibm90X3JlYWR5XCI7XG4gICAgICAgICAgbWVzc2FnZSA9IFwiQ29tbWFuZCBoYW5kbGVyIG5vdCByZWFkeVwiO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGNvZGUgPSBcInVua25vd25fY29tbWFuZFwiO1xuICAgICAgICAgIG1lc3NhZ2UgPSBgVW5rbm93biBjb21tYW5kICR7bXNnLmNvbW1hbmR9YDtcbiAgICAgICAgfVxuICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tY29uc29sZVxuICAgICAgICBjb25zb2xlLndhcm4obWVzc2FnZSwgbXNnKTtcbiAgICAgICAgdGhpcy5maXJlTWVzc2FnZSh7XG4gICAgICAgICAgaWQ6IG1zZy5pZCxcbiAgICAgICAgICB0eXBlOiBcInJlc3VsdFwiLFxuICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgIGVycm9yOiB7XG4gICAgICAgICAgICBjb2RlLFxuICAgICAgICAgICAgbWVzc2FnZSxcbiAgICAgICAgICB9LFxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBjb25zdCBwZW5kaW5nQ21kID0gdGhpcy5jb21tYW5kc1ttc2cuaWRdO1xuXG4gICAgaWYgKCFwZW5kaW5nQ21kKSB7XG4gICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tY29uc29sZVxuICAgICAgY29uc29sZS53YXJuKGBSZWNlaXZlZCB1bmtub3duIG1zZyBJRGAsIG1zZy5pZCk7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgaWYgKG1zZy50eXBlID09PSBcInJlc3VsdFwiKSB7XG4gICAgICBpZiAobXNnLnN1Y2Nlc3MpIHtcbiAgICAgICAgcGVuZGluZ0NtZC5yZXNvbHZlKG1zZy5yZXN1bHQpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcGVuZGluZ0NtZC5yZWplY3QobXNnLmVycm9yKTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICBwcm90ZWN0ZWQgX3NlbmRFeHRlcm5hbChtc2c6IEVNTWVzc2FnZSkge1xuICAgIGlmIChfX0RFVl9fKSB7XG4gICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tY29uc29sZVxuICAgICAgY29uc29sZS5sb2coXCJTZW5kaW5nIG1lc3NhZ2UgdG8gZXh0ZXJuYWwgYXBwXCIsIG1zZyk7XG4gICAgfVxuICAgIGlmICh3aW5kb3cuZXh0ZXJuYWxBcHApIHtcbiAgICAgIHdpbmRvdy5leHRlcm5hbEFwcC5leHRlcm5hbEJ1cyhKU09OLnN0cmluZ2lmeShtc2cpKTtcbiAgICB9IGVsc2Uge1xuICAgICAgd2luZG93LndlYmtpdCEubWVzc2FnZUhhbmRsZXJzLmV4dGVybmFsQnVzLnBvc3RNZXNzYWdlKG1zZyk7XG4gICAgfVxuICB9XG59XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./src/external_app/external_messaging.ts\n");

/***/ })

}]);