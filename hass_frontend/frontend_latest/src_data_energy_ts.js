"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(self["webpackChunkhome_assistant_frontend"] = self["webpackChunkhome_assistant_frontend"] || []).push([["src_data_energy_ts"],{

/***/ "./src/common/util/group-by.ts":
/*!*************************************!*\
  !*** ./src/common/util/group-by.ts ***!
  \*************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   groupBy: () => (/* binding */ groupBy)\n/* harmony export */ });\nconst groupBy = (list, keySelector) => {\n  const result = {};\n  for (const item of list) {\n    const key = keySelector(item);\n    if (key in result) {\n      result[key].push(item);\n    } else {\n      result[key] = [item];\n    }\n  }\n  return result;\n};//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvY29tbW9uL3V0aWwvZ3JvdXAtYnkudHMuanMiLCJtYXBwaW5ncyI6Ijs7OztBQUFBO0FBSUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSIsInNvdXJjZXMiOlsid2VicGFjazovL2hvbWUtYXNzaXN0YW50LWZyb250ZW5kLy4vc3JjL2NvbW1vbi91dGlsL2dyb3VwLWJ5LnRzPzM4ODciXSwic291cmNlc0NvbnRlbnQiOlsiZXhwb3J0IGNvbnN0IGdyb3VwQnkgPSA8VD4oXG4gIGxpc3Q6IFRbXSxcbiAga2V5U2VsZWN0b3I6IChpdGVtOiBUKSA9PiBzdHJpbmdcbik6IHsgW2tleTogc3RyaW5nXTogVFtdIH0gPT4ge1xuICBjb25zdCByZXN1bHQgPSB7fTtcbiAgZm9yIChjb25zdCBpdGVtIG9mIGxpc3QpIHtcbiAgICBjb25zdCBrZXkgPSBrZXlTZWxlY3RvcihpdGVtKTtcbiAgICBpZiAoa2V5IGluIHJlc3VsdCkge1xuICAgICAgcmVzdWx0W2tleV0ucHVzaChpdGVtKTtcbiAgICB9IGVsc2Uge1xuICAgICAgcmVzdWx0W2tleV0gPSBbaXRlbV07XG4gICAgfVxuICB9XG4gIHJldHVybiByZXN1bHQ7XG59O1xuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./src/common/util/group-by.ts\n");

/***/ }),

/***/ "./src/data/config_entries.ts":
/*!************************************!*\
  !*** ./src/data/config_entries.ts ***!
  \************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   ERROR_STATES: () => (/* binding */ ERROR_STATES),\n/* harmony export */   RECOVERABLE_STATES: () => (/* binding */ RECOVERABLE_STATES),\n/* harmony export */   deleteConfigEntry: () => (/* binding */ deleteConfigEntry),\n/* harmony export */   disableConfigEntry: () => (/* binding */ disableConfigEntry),\n/* harmony export */   enableConfigEntry: () => (/* binding */ enableConfigEntry),\n/* harmony export */   getConfigEntries: () => (/* binding */ getConfigEntries),\n/* harmony export */   getConfigEntry: () => (/* binding */ getConfigEntry),\n/* harmony export */   reloadConfigEntry: () => (/* binding */ reloadConfigEntry),\n/* harmony export */   subscribeConfigEntries: () => (/* binding */ subscribeConfigEntries),\n/* harmony export */   updateConfigEntry: () => (/* binding */ updateConfigEntry)\n/* harmony export */ });\n// https://github.com/home-assistant/core/blob/2286dea636fda001f03433ba14d7adbda43979e5/homeassistant/config_entries.py#L81\nconst ERROR_STATES = [\"migration_error\", \"setup_error\", \"setup_retry\"];\n\n// https://github.com/home-assistant/core/blob/2286dea636fda001f03433ba14d7adbda43979e5/homeassistant/config_entries.py#L81\nconst RECOVERABLE_STATES = [\"not_loaded\", \"loaded\", \"setup_error\", \"setup_retry\"];\nconst subscribeConfigEntries = (hass, callbackFunction, filters) => {\n  const params = {\n    type: \"config_entries/subscribe\"\n  };\n  if (filters && filters.type) {\n    params.type_filter = filters.type;\n  }\n  return hass.connection.subscribeMessage(message => callbackFunction(message), params);\n};\nconst getConfigEntries = (hass, filters) => {\n  const params = {};\n  if (filters) {\n    if (filters.type) {\n      params.type_filter = filters.type;\n    }\n    if (filters.domain) {\n      params.domain = filters.domain;\n    }\n  }\n  return hass.callWS({\n    type: \"config_entries/get\",\n    ...params\n  });\n};\nconst getConfigEntry = (hass, configEntryId) => hass.callWS({\n  type: \"config_entries/get_single\",\n  entry_id: configEntryId\n});\nconst updateConfigEntry = (hass, configEntryId, updatedValues) => hass.callWS({\n  type: \"config_entries/update\",\n  entry_id: configEntryId,\n  ...updatedValues\n});\nconst deleteConfigEntry = (hass, configEntryId) => hass.callApi(\"DELETE\", `config/config_entries/entry/${configEntryId}`);\nconst reloadConfigEntry = (hass, configEntryId) => hass.callApi(\"POST\", `config/config_entries/entry/${configEntryId}/reload`);\nconst disableConfigEntry = (hass, configEntryId) => hass.callWS({\n  type: \"config_entries/disable\",\n  entry_id: configEntryId,\n  disabled_by: \"user\"\n});\nconst enableConfigEntry = (hass, configEntryId) => hass.callWS({\n  type: \"config_entries/disable\",\n  entry_id: configEntryId,\n  disabled_by: null\n});//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvZGF0YS9jb25maWdfZW50cmllcy50cy5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7O0FBaUNBO0FBQ0E7O0FBTUE7QUFDQTtBQWFBO0FBUUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFJQTtBQUVBO0FBT0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBRUE7QUFDQTtBQUNBO0FBRUE7QUFNQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBS0E7QUFTQTtBQUtBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFJQTtBQUNBO0FBQ0E7QUFDQSIsInNvdXJjZXMiOlsid2VicGFjazovL2hvbWUtYXNzaXN0YW50LWZyb250ZW5kLy4vc3JjL2RhdGEvY29uZmlnX2VudHJpZXMudHM/NGZkMCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBVbnN1YnNjcmliZUZ1bmMgfSBmcm9tIFwiaG9tZS1hc3Npc3RhbnQtanMtd2Vic29ja2V0XCI7XG5pbXBvcnQgeyBIb21lQXNzaXN0YW50IH0gZnJvbSBcIi4uL3R5cGVzXCI7XG5pbXBvcnQgeyBJbnRlZ3JhdGlvblR5cGUgfSBmcm9tIFwiLi9pbnRlZ3JhdGlvblwiO1xuXG5leHBvcnQgaW50ZXJmYWNlIENvbmZpZ0VudHJ5IHtcbiAgZW50cnlfaWQ6IHN0cmluZztcbiAgZG9tYWluOiBzdHJpbmc7XG4gIHRpdGxlOiBzdHJpbmc7XG4gIHNvdXJjZTogc3RyaW5nO1xuICBzdGF0ZTpcbiAgICB8IFwibG9hZGVkXCJcbiAgICB8IFwic2V0dXBfZXJyb3JcIlxuICAgIHwgXCJtaWdyYXRpb25fZXJyb3JcIlxuICAgIHwgXCJzZXR1cF9yZXRyeVwiXG4gICAgfCBcIm5vdF9sb2FkZWRcIlxuICAgIHwgXCJmYWlsZWRfdW5sb2FkXCJcbiAgICB8IFwic2V0dXBfaW5fcHJvZ3Jlc3NcIjtcbiAgc3VwcG9ydHNfb3B0aW9uczogYm9vbGVhbjtcbiAgc3VwcG9ydHNfcmVtb3ZlX2RldmljZTogYm9vbGVhbjtcbiAgc3VwcG9ydHNfdW5sb2FkOiBib29sZWFuO1xuICBwcmVmX2Rpc2FibGVfbmV3X2VudGl0aWVzOiBib29sZWFuO1xuICBwcmVmX2Rpc2FibGVfcG9sbGluZzogYm9vbGVhbjtcbiAgZGlzYWJsZWRfYnk6IFwidXNlclwiIHwgbnVsbDtcbiAgcmVhc29uOiBzdHJpbmcgfCBudWxsO1xufVxuXG5leHBvcnQgdHlwZSBDb25maWdFbnRyeU11dGFibGVQYXJhbXMgPSBQYXJ0aWFsPFxuICBQaWNrPFxuICAgIENvbmZpZ0VudHJ5LFxuICAgIFwidGl0bGVcIiB8IFwicHJlZl9kaXNhYmxlX25ld19lbnRpdGllc1wiIHwgXCJwcmVmX2Rpc2FibGVfcG9sbGluZ1wiXG4gID5cbj47XG5cbi8vIGh0dHBzOi8vZ2l0aHViLmNvbS9ob21lLWFzc2lzdGFudC9jb3JlL2Jsb2IvMjI4NmRlYTYzNmZkYTAwMWYwMzQzM2JhMTRkN2FkYmRhNDM5NzllNS9ob21lYXNzaXN0YW50L2NvbmZpZ19lbnRyaWVzLnB5I0w4MVxuZXhwb3J0IGNvbnN0IEVSUk9SX1NUQVRFUzogQ29uZmlnRW50cnlbXCJzdGF0ZVwiXVtdID0gW1xuICBcIm1pZ3JhdGlvbl9lcnJvclwiLFxuICBcInNldHVwX2Vycm9yXCIsXG4gIFwic2V0dXBfcmV0cnlcIixcbl07XG5cbi8vIGh0dHBzOi8vZ2l0aHViLmNvbS9ob21lLWFzc2lzdGFudC9jb3JlL2Jsb2IvMjI4NmRlYTYzNmZkYTAwMWYwMzQzM2JhMTRkN2FkYmRhNDM5NzllNS9ob21lYXNzaXN0YW50L2NvbmZpZ19lbnRyaWVzLnB5I0w4MVxuZXhwb3J0IGNvbnN0IFJFQ09WRVJBQkxFX1NUQVRFUzogQ29uZmlnRW50cnlbXCJzdGF0ZVwiXVtdID0gW1xuICBcIm5vdF9sb2FkZWRcIixcbiAgXCJsb2FkZWRcIixcbiAgXCJzZXR1cF9lcnJvclwiLFxuICBcInNldHVwX3JldHJ5XCIsXG5dO1xuXG5leHBvcnQgaW50ZXJmYWNlIENvbmZpZ0VudHJ5VXBkYXRlIHtcbiAgLy8gbnVsbCBtZWFucyBubyB1cGRhdGUgYXMgaXMgdGhlIGN1cnJlbnQgc3RhdGVcbiAgdHlwZTogbnVsbCB8IFwiYWRkZWRcIiB8IFwicmVtb3ZlZFwiIHwgXCJ1cGRhdGVkXCI7XG4gIGVudHJ5OiBDb25maWdFbnRyeTtcbn1cblxuZXhwb3J0IGNvbnN0IHN1YnNjcmliZUNvbmZpZ0VudHJpZXMgPSAoXG4gIGhhc3M6IEhvbWVBc3Npc3RhbnQsXG4gIGNhbGxiYWNrRnVuY3Rpb246IChtZXNzYWdlOiBDb25maWdFbnRyeVVwZGF0ZVtdKSA9PiB2b2lkLFxuICBmaWx0ZXJzPzoge1xuICAgIHR5cGU/OiBJbnRlZ3JhdGlvblR5cGVbXTtcbiAgICBkb21haW4/OiBzdHJpbmc7XG4gIH1cbik6IFByb21pc2U8VW5zdWJzY3JpYmVGdW5jPiA9PiB7XG4gIGNvbnN0IHBhcmFtczogYW55ID0ge1xuICAgIHR5cGU6IFwiY29uZmlnX2VudHJpZXMvc3Vic2NyaWJlXCIsXG4gIH07XG4gIGlmIChmaWx0ZXJzICYmIGZpbHRlcnMudHlwZSkge1xuICAgIHBhcmFtcy50eXBlX2ZpbHRlciA9IGZpbHRlcnMudHlwZTtcbiAgfVxuICByZXR1cm4gaGFzcy5jb25uZWN0aW9uLnN1YnNjcmliZU1lc3NhZ2U8Q29uZmlnRW50cnlVcGRhdGVbXT4oXG4gICAgKG1lc3NhZ2UpID0+IGNhbGxiYWNrRnVuY3Rpb24obWVzc2FnZSksXG4gICAgcGFyYW1zXG4gICk7XG59O1xuXG5leHBvcnQgY29uc3QgZ2V0Q29uZmlnRW50cmllcyA9IChcbiAgaGFzczogSG9tZUFzc2lzdGFudCxcbiAgZmlsdGVycz86IHtcbiAgICB0eXBlPzogSW50ZWdyYXRpb25UeXBlW107XG4gICAgZG9tYWluPzogc3RyaW5nO1xuICB9XG4pOiBQcm9taXNlPENvbmZpZ0VudHJ5W10+ID0+IHtcbiAgY29uc3QgcGFyYW1zOiBhbnkgPSB7fTtcbiAgaWYgKGZpbHRlcnMpIHtcbiAgICBpZiAoZmlsdGVycy50eXBlKSB7XG4gICAgICBwYXJhbXMudHlwZV9maWx0ZXIgPSBmaWx0ZXJzLnR5cGU7XG4gICAgfVxuICAgIGlmIChmaWx0ZXJzLmRvbWFpbikge1xuICAgICAgcGFyYW1zLmRvbWFpbiA9IGZpbHRlcnMuZG9tYWluO1xuICAgIH1cbiAgfVxuICByZXR1cm4gaGFzcy5jYWxsV1M8Q29uZmlnRW50cnlbXT4oe1xuICAgIHR5cGU6IFwiY29uZmlnX2VudHJpZXMvZ2V0XCIsXG4gICAgLi4ucGFyYW1zLFxuICB9KTtcbn07XG5cbmV4cG9ydCBjb25zdCBnZXRDb25maWdFbnRyeSA9IChoYXNzOiBIb21lQXNzaXN0YW50LCBjb25maWdFbnRyeUlkOiBzdHJpbmcpID0+XG4gIGhhc3MuY2FsbFdTPHsgY29uZmlnX2VudHJ5OiBDb25maWdFbnRyeSB9Pih7XG4gICAgdHlwZTogXCJjb25maWdfZW50cmllcy9nZXRfc2luZ2xlXCIsXG4gICAgZW50cnlfaWQ6IGNvbmZpZ0VudHJ5SWQsXG4gIH0pO1xuXG5leHBvcnQgY29uc3QgdXBkYXRlQ29uZmlnRW50cnkgPSAoXG4gIGhhc3M6IEhvbWVBc3Npc3RhbnQsXG4gIGNvbmZpZ0VudHJ5SWQ6IHN0cmluZyxcbiAgdXBkYXRlZFZhbHVlczogQ29uZmlnRW50cnlNdXRhYmxlUGFyYW1zXG4pID0+XG4gIGhhc3MuY2FsbFdTPHsgcmVxdWlyZV9yZXN0YXJ0OiBib29sZWFuOyBjb25maWdfZW50cnk6IENvbmZpZ0VudHJ5IH0+KHtcbiAgICB0eXBlOiBcImNvbmZpZ19lbnRyaWVzL3VwZGF0ZVwiLFxuICAgIGVudHJ5X2lkOiBjb25maWdFbnRyeUlkLFxuICAgIC4uLnVwZGF0ZWRWYWx1ZXMsXG4gIH0pO1xuXG5leHBvcnQgY29uc3QgZGVsZXRlQ29uZmlnRW50cnkgPSAoaGFzczogSG9tZUFzc2lzdGFudCwgY29uZmlnRW50cnlJZDogc3RyaW5nKSA9PlxuICBoYXNzLmNhbGxBcGk8e1xuICAgIHJlcXVpcmVfcmVzdGFydDogYm9vbGVhbjtcbiAgfT4oXCJERUxFVEVcIiwgYGNvbmZpZy9jb25maWdfZW50cmllcy9lbnRyeS8ke2NvbmZpZ0VudHJ5SWR9YCk7XG5cbmV4cG9ydCBjb25zdCByZWxvYWRDb25maWdFbnRyeSA9IChoYXNzOiBIb21lQXNzaXN0YW50LCBjb25maWdFbnRyeUlkOiBzdHJpbmcpID0+XG4gIGhhc3MuY2FsbEFwaTx7XG4gICAgcmVxdWlyZV9yZXN0YXJ0OiBib29sZWFuO1xuICB9PihcIlBPU1RcIiwgYGNvbmZpZy9jb25maWdfZW50cmllcy9lbnRyeS8ke2NvbmZpZ0VudHJ5SWR9L3JlbG9hZGApO1xuXG5leHBvcnQgaW50ZXJmYWNlIERpc2FibGVDb25maWdFbnRyeVJlc3VsdCB7XG4gIHJlcXVpcmVfcmVzdGFydDogYm9vbGVhbjtcbn1cblxuZXhwb3J0IGNvbnN0IGRpc2FibGVDb25maWdFbnRyeSA9IChcbiAgaGFzczogSG9tZUFzc2lzdGFudCxcbiAgY29uZmlnRW50cnlJZDogc3RyaW5nXG4pID0+XG4gIGhhc3MuY2FsbFdTPERpc2FibGVDb25maWdFbnRyeVJlc3VsdD4oe1xuICAgIHR5cGU6IFwiY29uZmlnX2VudHJpZXMvZGlzYWJsZVwiLFxuICAgIGVudHJ5X2lkOiBjb25maWdFbnRyeUlkLFxuICAgIGRpc2FibGVkX2J5OiBcInVzZXJcIixcbiAgfSk7XG5cbmV4cG9ydCBjb25zdCBlbmFibGVDb25maWdFbnRyeSA9IChoYXNzOiBIb21lQXNzaXN0YW50LCBjb25maWdFbnRyeUlkOiBzdHJpbmcpID0+XG4gIGhhc3MuY2FsbFdTPHtcbiAgICByZXF1aXJlX3Jlc3RhcnQ6IGJvb2xlYW47XG4gIH0+KHtcbiAgICB0eXBlOiBcImNvbmZpZ19lbnRyaWVzL2Rpc2FibGVcIixcbiAgICBlbnRyeV9pZDogY29uZmlnRW50cnlJZCxcbiAgICBkaXNhYmxlZF9ieTogbnVsbCxcbiAgfSk7XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./src/data/config_entries.ts\n");

/***/ }),

/***/ "./src/data/energy.ts":
/*!****************************!*\
  !*** ./src/data/energy.ts ***!
  \****************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   emptyBatteryEnergyPreference: () => (/* binding */ emptyBatteryEnergyPreference),\n/* harmony export */   emptyFlowFromGridSourceEnergyPreference: () => (/* binding */ emptyFlowFromGridSourceEnergyPreference),\n/* harmony export */   emptyFlowToGridSourceEnergyPreference: () => (/* binding */ emptyFlowToGridSourceEnergyPreference),\n/* harmony export */   emptyGasEnergyPreference: () => (/* binding */ emptyGasEnergyPreference),\n/* harmony export */   emptyGridSourceEnergyPreference: () => (/* binding */ emptyGridSourceEnergyPreference),\n/* harmony export */   emptySolarEnergyPreference: () => (/* binding */ emptySolarEnergyPreference),\n/* harmony export */   emptyWaterEnergyPreference: () => (/* binding */ emptyWaterEnergyPreference),\n/* harmony export */   energySourcesByType: () => (/* binding */ energySourcesByType),\n/* harmony export */   getEnergyDataCollection: () => (/* binding */ getEnergyDataCollection),\n/* harmony export */   getEnergyGasUnit: () => (/* binding */ getEnergyGasUnit),\n/* harmony export */   getEnergyGasUnitClass: () => (/* binding */ getEnergyGasUnitClass),\n/* harmony export */   getEnergyInfo: () => (/* binding */ getEnergyInfo),\n/* harmony export */   getEnergyPreferenceValidation: () => (/* binding */ getEnergyPreferenceValidation),\n/* harmony export */   getEnergyPreferences: () => (/* binding */ getEnergyPreferences),\n/* harmony export */   getEnergySolarForecasts: () => (/* binding */ getEnergySolarForecasts),\n/* harmony export */   getEnergyWaterUnit: () => (/* binding */ getEnergyWaterUnit),\n/* harmony export */   getFossilEnergyConsumption: () => (/* binding */ getFossilEnergyConsumption),\n/* harmony export */   getReferencedStatisticIds: () => (/* binding */ getReferencedStatisticIds),\n/* harmony export */   saveEnergyPreferences: () => (/* binding */ saveEnergyPreferences)\n/* harmony export */ });\n/* harmony import */ var date_fns_esm__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! date-fns/esm */ \"./node_modules/date-fns/esm/differenceInDays/index.js\");\n/* harmony import */ var date_fns_esm__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! date-fns/esm */ \"./node_modules/date-fns/esm/addMonths/index.js\");\n/* harmony import */ var date_fns_esm__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! date-fns/esm */ \"./node_modules/date-fns/esm/addDays/index.js\");\n/* harmony import */ var date_fns_esm__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! date-fns/esm */ \"./node_modules/date-fns/esm/addMilliseconds/index.js\");\n/* harmony import */ var date_fns_esm__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! date-fns/esm */ \"./node_modules/date-fns/esm/startOfToday/index.js\");\n/* harmony import */ var date_fns_esm__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! date-fns/esm */ \"./node_modules/date-fns/esm/startOfYesterday/index.js\");\n/* harmony import */ var date_fns_esm__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! date-fns/esm */ \"./node_modules/date-fns/esm/endOfToday/index.js\");\n/* harmony import */ var date_fns_esm__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! date-fns/esm */ \"./node_modules/date-fns/esm/endOfYesterday/index.js\");\n/* harmony import */ var date_fns_esm__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! date-fns/esm */ \"./node_modules/date-fns/esm/addHours/index.js\");\n/* harmony import */ var home_assistant_js_websocket__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! home-assistant-js-websocket */ \"./node_modules/home-assistant-js-websocket/dist/collection.js\");\n/* harmony import */ var _common_util_group_by__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../common/util/group-by */ \"./src/common/util/group-by.ts\");\n/* harmony import */ var _config_entries__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./config_entries */ \"./src/data/config_entries.ts\");\n/* harmony import */ var _recorder__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./recorder */ \"./src/data/recorder.ts\");\n\n\n\n\n\nconst energyCollectionKeys = [];\nconst emptyFlowFromGridSourceEnergyPreference = () => ({\n  stat_energy_from: \"\",\n  stat_cost: null,\n  entity_energy_price: null,\n  number_energy_price: null\n});\nconst emptyFlowToGridSourceEnergyPreference = () => ({\n  stat_energy_to: \"\",\n  stat_compensation: null,\n  entity_energy_price: null,\n  number_energy_price: null\n});\nconst emptyGridSourceEnergyPreference = () => ({\n  type: \"grid\",\n  flow_from: [],\n  flow_to: [],\n  cost_adjustment_day: 0\n});\nconst emptySolarEnergyPreference = () => ({\n  type: \"solar\",\n  stat_energy_from: \"\",\n  config_entry_solar_forecast: null\n});\nconst emptyBatteryEnergyPreference = () => ({\n  type: \"battery\",\n  stat_energy_from: \"\",\n  stat_energy_to: \"\"\n});\nconst emptyGasEnergyPreference = () => ({\n  type: \"gas\",\n  stat_energy_from: \"\",\n  stat_cost: null,\n  entity_energy_price: null,\n  number_energy_price: null\n});\nconst emptyWaterEnergyPreference = () => ({\n  type: \"water\",\n  stat_energy_from: \"\",\n  stat_cost: null,\n  entity_energy_price: null,\n  number_energy_price: null\n});\nconst getEnergyInfo = hass => hass.callWS({\n  type: \"energy/info\"\n});\nconst getEnergyPreferenceValidation = async hass => {\n  await hass.loadBackendTranslation(\"issues\", \"energy\");\n  return hass.callWS({\n    type: \"energy/validate\"\n  });\n};\nconst getEnergyPreferences = hass => hass.callWS({\n  type: \"energy/get_prefs\"\n});\nconst saveEnergyPreferences = async (hass, prefs) => {\n  const newPrefs = hass.callWS({\n    type: \"energy/save_prefs\",\n    ...prefs\n  });\n  clearEnergyCollectionPreferences(hass);\n  return newPrefs;\n};\nconst getFossilEnergyConsumption = async (hass, startTime, energy_statistic_ids, co2_statistic_id, endTime, period = \"hour\") => hass.callWS({\n  type: \"energy/fossil_energy_consumption\",\n  start_time: startTime.toISOString(),\n  end_time: endTime === null || endTime === void 0 ? void 0 : endTime.toISOString(),\n  energy_statistic_ids,\n  co2_statistic_id,\n  period\n});\nconst energySourcesByType = prefs => (0,_common_util_group_by__WEBPACK_IMPORTED_MODULE_0__.groupBy)(prefs.energy_sources, item => item.type);\nconst getReferencedStatisticIds = (prefs, info, includeTypes) => {\n  const statIDs = [];\n  for (const source of prefs.energy_sources) {\n    if (includeTypes && !includeTypes.includes(source.type)) {\n      continue;\n    }\n    if (source.type === \"solar\") {\n      statIDs.push(source.stat_energy_from);\n      continue;\n    }\n    if (source.type === \"gas\" || source.type === \"water\") {\n      statIDs.push(source.stat_energy_from);\n      if (source.stat_cost) {\n        statIDs.push(source.stat_cost);\n      }\n      const costStatId = info.cost_sensors[source.stat_energy_from];\n      if (costStatId) {\n        statIDs.push(costStatId);\n      }\n      continue;\n    }\n    if (source.type === \"battery\") {\n      statIDs.push(source.stat_energy_from);\n      statIDs.push(source.stat_energy_to);\n      continue;\n    }\n\n    // grid source\n    for (const flowFrom of source.flow_from) {\n      statIDs.push(flowFrom.stat_energy_from);\n      if (flowFrom.stat_cost) {\n        statIDs.push(flowFrom.stat_cost);\n      }\n      const costStatId = info.cost_sensors[flowFrom.stat_energy_from];\n      if (costStatId) {\n        statIDs.push(costStatId);\n      }\n    }\n    for (const flowTo of source.flow_to) {\n      statIDs.push(flowTo.stat_energy_to);\n      if (flowTo.stat_compensation) {\n        statIDs.push(flowTo.stat_compensation);\n      }\n      const costStatId = info.cost_sensors[flowTo.stat_energy_to];\n      if (costStatId) {\n        statIDs.push(costStatId);\n      }\n    }\n  }\n  return statIDs;\n};\nconst getEnergyData = async (hass, prefs, start, end, compare) => {\n  const [configEntries, info] = await Promise.all([(0,_config_entries__WEBPACK_IMPORTED_MODULE_1__.getConfigEntries)(hass, {\n    domain: \"co2signal\"\n  }), getEnergyInfo(hass)]);\n  const co2SignalConfigEntry = configEntries.length ? configEntries[0] : undefined;\n  let co2SignalEntity;\n  if (co2SignalConfigEntry) {\n    for (const entity of Object.values(hass.entities)) {\n      if (entity.platform !== \"co2signal\") {\n        continue;\n      }\n\n      // The integration offers 2 entities. We want the % one.\n      const co2State = hass.states[entity.entity_id];\n      if (!co2State || co2State.attributes.unit_of_measurement !== \"%\") {\n        continue;\n      }\n      co2SignalEntity = co2State.entity_id;\n      break;\n    }\n  }\n  const consumptionStatIDs = [];\n  for (const source of prefs.energy_sources) {\n    // grid source\n    if (source.type === \"grid\") {\n      for (const flowFrom of source.flow_from) {\n        consumptionStatIDs.push(flowFrom.stat_energy_from);\n      }\n    }\n  }\n  const energyStatIds = getReferencedStatisticIds(prefs, info, [\"grid\", \"solar\", \"battery\", \"gas\"]);\n  const waterStatIds = getReferencedStatisticIds(prefs, info, [\"water\"]);\n  const allStatIDs = [...energyStatIds, ...waterStatIds];\n  const dayDifference = (0,date_fns_esm__WEBPACK_IMPORTED_MODULE_3__[\"default\"])(end || new Date(), start);\n  const period = dayDifference > 35 ? \"month\" : dayDifference > 2 ? \"day\" : \"hour\";\n  const lengthUnit = hass.config.unit_system.length || \"\";\n  const energyUnits = {\n    energy: \"kWh\",\n    volume: lengthUnit === \"km\" ? \"m³\" : \"ft³\"\n  };\n  const waterUnits = {\n    volume: lengthUnit === \"km\" ? \"L\" : \"gal\"\n  };\n  const _energyStats = energyStatIds.length ? (0,_recorder__WEBPACK_IMPORTED_MODULE_2__.fetchStatistics)(hass, start, end, energyStatIds, period, energyUnits, [\"change\"]) : {};\n  const _waterStats = waterStatIds.length ? (0,_recorder__WEBPACK_IMPORTED_MODULE_2__.fetchStatistics)(hass, start, end, waterStatIds, period, waterUnits, [\"change\"]) : {};\n  let statsCompare;\n  let startCompare;\n  let endCompare;\n  let _energyStatsCompare = {};\n  let _waterStatsCompare = {};\n  if (compare) {\n    if (dayDifference > 27 && dayDifference < 32) {\n      // When comparing a month, we want to start at the begining of the month\n      startCompare = (0,date_fns_esm__WEBPACK_IMPORTED_MODULE_4__[\"default\"])(start, -1);\n    } else {\n      startCompare = (0,date_fns_esm__WEBPACK_IMPORTED_MODULE_5__[\"default\"])(start, (dayDifference + 1) * -1);\n    }\n    endCompare = (0,date_fns_esm__WEBPACK_IMPORTED_MODULE_6__[\"default\"])(start, -1);\n    if (energyStatIds.length) {\n      _energyStatsCompare = (0,_recorder__WEBPACK_IMPORTED_MODULE_2__.fetchStatistics)(hass, startCompare, endCompare, energyStatIds, period, energyUnits, [\"change\"]);\n    }\n    if (waterStatIds.length) {\n      _waterStatsCompare = (0,_recorder__WEBPACK_IMPORTED_MODULE_2__.fetchStatistics)(hass, startCompare, endCompare, waterStatIds, period, waterUnits, [\"change\"]);\n    }\n  }\n  let _fossilEnergyConsumption;\n  let _fossilEnergyConsumptionCompare;\n  if (co2SignalEntity !== undefined) {\n    _fossilEnergyConsumption = getFossilEnergyConsumption(hass, start, consumptionStatIDs, co2SignalEntity, end, dayDifference > 35 ? \"month\" : dayDifference > 2 ? \"day\" : \"hour\");\n    if (compare) {\n      _fossilEnergyConsumptionCompare = getFossilEnergyConsumption(hass, startCompare, consumptionStatIDs, co2SignalEntity, endCompare, dayDifference > 35 ? \"month\" : dayDifference > 2 ? \"day\" : \"hour\");\n    }\n  }\n  const statsMetadata = {};\n  const _getStatisticMetadata = allStatIDs.length ? (0,_recorder__WEBPACK_IMPORTED_MODULE_2__.getStatisticMetadata)(hass, allStatIDs) : [];\n  const [energyStats, waterStats, energyStatsCompare, waterStatsCompare, statsMetadataArray, fossilEnergyConsumption, fossilEnergyConsumptionCompare] = await Promise.all([_energyStats, _waterStats, _energyStatsCompare, _waterStatsCompare, _getStatisticMetadata, _fossilEnergyConsumption, _fossilEnergyConsumptionCompare]);\n  const stats = {\n    ...energyStats,\n    ...waterStats\n  };\n  if (compare) {\n    statsCompare = {\n      ...energyStatsCompare,\n      ...waterStatsCompare\n    };\n  }\n  if (allStatIDs.length) {\n    statsMetadataArray.forEach(x => {\n      statsMetadata[x.statistic_id] = x;\n    });\n  }\n  const data = {\n    start,\n    end,\n    startCompare,\n    endCompare,\n    info,\n    prefs,\n    stats,\n    statsMetadata,\n    statsCompare,\n    co2SignalConfigEntry,\n    co2SignalEntity,\n    fossilEnergyConsumption,\n    fossilEnergyConsumptionCompare\n  };\n  return data;\n};\nconst clearEnergyCollectionPreferences = hass => {\n  energyCollectionKeys.forEach(key => {\n    const energyCollection = getEnergyDataCollection(hass, {\n      key\n    });\n    energyCollection.clearPrefs();\n    if (energyCollection._active) {\n      energyCollection.refresh();\n    }\n  });\n};\nconst getEnergyDataCollection = (hass, options = {}) => {\n  let key = \"_energy\";\n  if (options.key) {\n    if (!options.key.startsWith(\"energy_\")) {\n      throw new Error(\"Key need to start with energy_\");\n    }\n    key = `_${options.key}`;\n  }\n  if (hass.connection[key]) {\n    return hass.connection[key];\n  }\n  energyCollectionKeys.push(options.key);\n  const collection = (0,home_assistant_js_websocket__WEBPACK_IMPORTED_MODULE_7__.getCollection)(hass.connection, key, async () => {\n    if (!collection.prefs) {\n      // This will raise if not found.\n      // Detect by checking `e.code === \"not_found\"\n      collection.prefs = await getEnergyPreferences(hass);\n    }\n    if (collection._refreshTimeout) {\n      clearTimeout(collection._refreshTimeout);\n    }\n    if (collection._active && (!collection.end || collection.end > new Date())) {\n      // The stats are created every hour\n      // Schedule a refresh for 20 minutes past the hour\n      // If the end is larger than the current time.\n      const nextFetch = new Date();\n      if (nextFetch.getMinutes() >= 20) {\n        nextFetch.setHours(nextFetch.getHours() + 1);\n      }\n      nextFetch.setMinutes(20, 0, 0);\n      collection._refreshTimeout = window.setTimeout(() => collection.refresh(), nextFetch.getTime() - Date.now());\n    }\n    return getEnergyData(hass, collection.prefs, collection.start, collection.end, collection.compare);\n  });\n  const origSubscribe = collection.subscribe;\n  collection.subscribe = subscriber => {\n    const unsub = origSubscribe(subscriber);\n    collection._active++;\n    return () => {\n      collection._active--;\n      if (collection._active < 1) {\n        clearTimeout(collection._refreshTimeout);\n        collection._refreshTimeout = undefined;\n      }\n      unsub();\n    };\n  };\n  collection._active = 0;\n  collection.prefs = options.prefs;\n  const now = new Date();\n  // Set start to start of today if we have data for today, otherwise yesterday\n  collection.start = now.getHours() > 0 ? (0,date_fns_esm__WEBPACK_IMPORTED_MODULE_8__[\"default\"])() : (0,date_fns_esm__WEBPACK_IMPORTED_MODULE_9__[\"default\"])();\n  collection.end = now.getHours() > 0 ? (0,date_fns_esm__WEBPACK_IMPORTED_MODULE_10__[\"default\"])() : (0,date_fns_esm__WEBPACK_IMPORTED_MODULE_11__[\"default\"])();\n  const scheduleUpdatePeriod = () => {\n    collection._updatePeriodTimeout = window.setTimeout(() => {\n      collection.start = (0,date_fns_esm__WEBPACK_IMPORTED_MODULE_8__[\"default\"])();\n      collection.end = (0,date_fns_esm__WEBPACK_IMPORTED_MODULE_10__[\"default\"])();\n      scheduleUpdatePeriod();\n    }, (0,date_fns_esm__WEBPACK_IMPORTED_MODULE_12__[\"default\"])((0,date_fns_esm__WEBPACK_IMPORTED_MODULE_10__[\"default\"])(), 1).getTime() - Date.now() // Switch to next day an hour after the day changed\n    );\n  };\n\n  scheduleUpdatePeriod();\n  collection.clearPrefs = () => {\n    collection.prefs = undefined;\n  };\n  collection.setPeriod = (newStart, newEnd) => {\n    var _collection$end;\n    collection.start = newStart;\n    collection.end = newEnd;\n    if (collection.start.getTime() === (0,date_fns_esm__WEBPACK_IMPORTED_MODULE_8__[\"default\"])().getTime() && ((_collection$end = collection.end) === null || _collection$end === void 0 ? void 0 : _collection$end.getTime()) === (0,date_fns_esm__WEBPACK_IMPORTED_MODULE_10__[\"default\"])().getTime() && !collection._updatePeriodTimeout) {\n      scheduleUpdatePeriod();\n    } else if (collection._updatePeriodTimeout) {\n      clearTimeout(collection._updatePeriodTimeout);\n      collection._updatePeriodTimeout = undefined;\n    }\n  };\n  collection.setCompare = compare => {\n    collection.compare = compare;\n  };\n  return collection;\n};\nconst getEnergySolarForecasts = hass => hass.callWS({\n  type: \"energy/solar_forecast\"\n});\nconst energyGasUnitClass = [\"volume\", \"energy\"];\nconst getEnergyGasUnitClass = (prefs, statisticsMetaData = {}, excludeSource) => {\n  for (const source of prefs.energy_sources) {\n    if (source.type !== \"gas\") {\n      continue;\n    }\n    if (excludeSource && excludeSource === source.stat_energy_from) {\n      continue;\n    }\n    const statisticIdWithMeta = statisticsMetaData[source.stat_energy_from];\n    if (energyGasUnitClass.includes(statisticIdWithMeta === null || statisticIdWithMeta === void 0 ? void 0 : statisticIdWithMeta.unit_class)) {\n      return statisticIdWithMeta.unit_class;\n    }\n  }\n  return undefined;\n};\nconst getEnergyGasUnit = (hass, prefs, statisticsMetaData = {}) => {\n  const unitClass = getEnergyGasUnitClass(prefs, statisticsMetaData);\n  if (unitClass === undefined) {\n    return undefined;\n  }\n  return unitClass === \"energy\" ? \"kWh\" : hass.config.unit_system.length === \"km\" ? \"m³\" : \"ft³\";\n};\nconst getEnergyWaterUnit = hass => hass.config.unit_system.length === \"km\" ? \"L\" : \"gal\";//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvZGF0YS9lbmVyZ3kudHMuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBQTtBQVdBO0FBQ0E7QUFFQTtBQUNBO0FBUUE7QUFFQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFxSEE7QUFFQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFFQTtBQUNBO0FBRUE7QUFJQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQU1BO0FBU0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFVQTtBQW1CQTtBQUtBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUVBO0FBT0E7QUFDQTtBQUFBO0FBSUE7QUFJQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFNQTtBQUVBO0FBRUE7QUFDQTtBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUtBO0FBTUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBU0E7QUFDQTtBQUNBO0FBU0E7QUFDQTtBQUVBO0FBQ0E7QUFHQTtBQUNBO0FBUUE7QUFDQTtBQVFBO0FBQ0E7QUFFQTtBQUNBO0FBS0E7QUFpQkE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQWVBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUlBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBRUE7QUFFQTtBQUlBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFFQTtBQUlBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUlBO0FBRUE7QUFPQTtBQUdBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTs7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFLQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFFQTtBQUNBO0FBRUE7QUFHQTtBQUtBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUtBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUtBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFLQTtBQUVBIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vaG9tZS1hc3Npc3RhbnQtZnJvbnRlbmQvLi9zcmMvZGF0YS9lbmVyZ3kudHM/MjIxOCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge1xuICBhZGREYXlzLFxuICBhZGRIb3VycyxcbiAgYWRkTWlsbGlzZWNvbmRzLFxuICBhZGRNb250aHMsXG4gIGRpZmZlcmVuY2VJbkRheXMsXG4gIGVuZE9mVG9kYXksXG4gIGVuZE9mWWVzdGVyZGF5LFxuICBzdGFydE9mVG9kYXksXG4gIHN0YXJ0T2ZZZXN0ZXJkYXksXG59IGZyb20gXCJkYXRlLWZucy9lc21cIjtcbmltcG9ydCB7IENvbGxlY3Rpb24sIGdldENvbGxlY3Rpb24gfSBmcm9tIFwiaG9tZS1hc3Npc3RhbnQtanMtd2Vic29ja2V0XCI7XG5pbXBvcnQgeyBncm91cEJ5IH0gZnJvbSBcIi4uL2NvbW1vbi91dGlsL2dyb3VwLWJ5XCI7XG5pbXBvcnQgeyBIb21lQXNzaXN0YW50IH0gZnJvbSBcIi4uL3R5cGVzXCI7XG5pbXBvcnQgeyBDb25maWdFbnRyeSwgZ2V0Q29uZmlnRW50cmllcyB9IGZyb20gXCIuL2NvbmZpZ19lbnRyaWVzXCI7XG5pbXBvcnQge1xuICBmZXRjaFN0YXRpc3RpY3MsXG4gIGdldFN0YXRpc3RpY01ldGFkYXRhLFxuICBTdGF0aXN0aWNzLFxuICBTdGF0aXN0aWNzTWV0YURhdGEsXG4gIFN0YXRpc3RpY3NVbml0Q29uZmlndXJhdGlvbixcbn0gZnJvbSBcIi4vcmVjb3JkZXJcIjtcblxuY29uc3QgZW5lcmd5Q29sbGVjdGlvbktleXM6IChzdHJpbmcgfCB1bmRlZmluZWQpW10gPSBbXTtcblxuZXhwb3J0IGNvbnN0IGVtcHR5Rmxvd0Zyb21HcmlkU291cmNlRW5lcmd5UHJlZmVyZW5jZSA9XG4gICgpOiBGbG93RnJvbUdyaWRTb3VyY2VFbmVyZ3lQcmVmZXJlbmNlID0+ICh7XG4gICAgc3RhdF9lbmVyZ3lfZnJvbTogXCJcIixcbiAgICBzdGF0X2Nvc3Q6IG51bGwsXG4gICAgZW50aXR5X2VuZXJneV9wcmljZTogbnVsbCxcbiAgICBudW1iZXJfZW5lcmd5X3ByaWNlOiBudWxsLFxuICB9KTtcblxuZXhwb3J0IGNvbnN0IGVtcHR5Rmxvd1RvR3JpZFNvdXJjZUVuZXJneVByZWZlcmVuY2UgPVxuICAoKTogRmxvd1RvR3JpZFNvdXJjZUVuZXJneVByZWZlcmVuY2UgPT4gKHtcbiAgICBzdGF0X2VuZXJneV90bzogXCJcIixcbiAgICBzdGF0X2NvbXBlbnNhdGlvbjogbnVsbCxcbiAgICBlbnRpdHlfZW5lcmd5X3ByaWNlOiBudWxsLFxuICAgIG51bWJlcl9lbmVyZ3lfcHJpY2U6IG51bGwsXG4gIH0pO1xuXG5leHBvcnQgY29uc3QgZW1wdHlHcmlkU291cmNlRW5lcmd5UHJlZmVyZW5jZSA9XG4gICgpOiBHcmlkU291cmNlVHlwZUVuZXJneVByZWZlcmVuY2UgPT4gKHtcbiAgICB0eXBlOiBcImdyaWRcIixcbiAgICBmbG93X2Zyb206IFtdLFxuICAgIGZsb3dfdG86IFtdLFxuICAgIGNvc3RfYWRqdXN0bWVudF9kYXk6IDAsXG4gIH0pO1xuXG5leHBvcnQgY29uc3QgZW1wdHlTb2xhckVuZXJneVByZWZlcmVuY2UgPVxuICAoKTogU29sYXJTb3VyY2VUeXBlRW5lcmd5UHJlZmVyZW5jZSA9PiAoe1xuICAgIHR5cGU6IFwic29sYXJcIixcbiAgICBzdGF0X2VuZXJneV9mcm9tOiBcIlwiLFxuICAgIGNvbmZpZ19lbnRyeV9zb2xhcl9mb3JlY2FzdDogbnVsbCxcbiAgfSk7XG5cbmV4cG9ydCBjb25zdCBlbXB0eUJhdHRlcnlFbmVyZ3lQcmVmZXJlbmNlID1cbiAgKCk6IEJhdHRlcnlTb3VyY2VUeXBlRW5lcmd5UHJlZmVyZW5jZSA9PiAoe1xuICAgIHR5cGU6IFwiYmF0dGVyeVwiLFxuICAgIHN0YXRfZW5lcmd5X2Zyb206IFwiXCIsXG4gICAgc3RhdF9lbmVyZ3lfdG86IFwiXCIsXG4gIH0pO1xuXG5leHBvcnQgY29uc3QgZW1wdHlHYXNFbmVyZ3lQcmVmZXJlbmNlID0gKCk6IEdhc1NvdXJjZVR5cGVFbmVyZ3lQcmVmZXJlbmNlID0+ICh7XG4gIHR5cGU6IFwiZ2FzXCIsXG4gIHN0YXRfZW5lcmd5X2Zyb206IFwiXCIsXG4gIHN0YXRfY29zdDogbnVsbCxcbiAgZW50aXR5X2VuZXJneV9wcmljZTogbnVsbCxcbiAgbnVtYmVyX2VuZXJneV9wcmljZTogbnVsbCxcbn0pO1xuXG5leHBvcnQgY29uc3QgZW1wdHlXYXRlckVuZXJneVByZWZlcmVuY2UgPVxuICAoKTogV2F0ZXJTb3VyY2VUeXBlRW5lcmd5UHJlZmVyZW5jZSA9PiAoe1xuICAgIHR5cGU6IFwid2F0ZXJcIixcbiAgICBzdGF0X2VuZXJneV9mcm9tOiBcIlwiLFxuICAgIHN0YXRfY29zdDogbnVsbCxcbiAgICBlbnRpdHlfZW5lcmd5X3ByaWNlOiBudWxsLFxuICAgIG51bWJlcl9lbmVyZ3lfcHJpY2U6IG51bGwsXG4gIH0pO1xuXG5pbnRlcmZhY2UgRW5lcmd5U29sYXJGb3JlY2FzdCB7XG4gIHdoX2hvdXJzOiBSZWNvcmQ8c3RyaW5nLCBudW1iZXI+O1xufVxuZXhwb3J0IHR5cGUgRW5lcmd5U29sYXJGb3JlY2FzdHMgPSB7XG4gIFtjb25maWdfZW50cnlfaWQ6IHN0cmluZ106IEVuZXJneVNvbGFyRm9yZWNhc3Q7XG59O1xuXG5leHBvcnQgaW50ZXJmYWNlIERldmljZUNvbnN1bXB0aW9uRW5lcmd5UHJlZmVyZW5jZSB7XG4gIC8vIFRoaXMgaXMgYW4gZXZlciBpbmNyZWFzaW5nIHZhbHVlXG4gIHN0YXRfY29uc3VtcHRpb246IHN0cmluZztcbn1cblxuZXhwb3J0IGludGVyZmFjZSBGbG93RnJvbUdyaWRTb3VyY2VFbmVyZ3lQcmVmZXJlbmNlIHtcbiAgLy8ga1doIG1ldGVyXG4gIHN0YXRfZW5lcmd5X2Zyb206IHN0cmluZztcblxuICAvLyAkIG1ldGVyXG4gIHN0YXRfY29zdDogc3RyaW5nIHwgbnVsbDtcblxuICAvLyBDYW4gYmUgdXNlZCB0byBnZW5lcmF0ZSBjb3N0cyBpZiBzdGF0X2Nvc3Qgb21pdHRlZFxuICBlbnRpdHlfZW5lcmd5X3ByaWNlOiBzdHJpbmcgfCBudWxsO1xuICBudW1iZXJfZW5lcmd5X3ByaWNlOiBudW1iZXIgfCBudWxsO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIEZsb3dUb0dyaWRTb3VyY2VFbmVyZ3lQcmVmZXJlbmNlIHtcbiAgLy8ga1doIG1ldGVyXG4gIHN0YXRfZW5lcmd5X3RvOiBzdHJpbmc7XG5cbiAgLy8gJCBtZXRlclxuICBzdGF0X2NvbXBlbnNhdGlvbjogc3RyaW5nIHwgbnVsbDtcblxuICAvLyBDYW4gYmUgdXNlZCB0byBnZW5lcmF0ZSBjb3N0cyBpZiBzdGF0X2NvbXBlbnNhdGlvbiBvbWl0dGVkXG4gIGVudGl0eV9lbmVyZ3lfcHJpY2U6IHN0cmluZyB8IG51bGw7XG4gIG51bWJlcl9lbmVyZ3lfcHJpY2U6IG51bWJlciB8IG51bGw7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgR3JpZFNvdXJjZVR5cGVFbmVyZ3lQcmVmZXJlbmNlIHtcbiAgdHlwZTogXCJncmlkXCI7XG5cbiAgZmxvd19mcm9tOiBGbG93RnJvbUdyaWRTb3VyY2VFbmVyZ3lQcmVmZXJlbmNlW107XG4gIGZsb3dfdG86IEZsb3dUb0dyaWRTb3VyY2VFbmVyZ3lQcmVmZXJlbmNlW107XG5cbiAgY29zdF9hZGp1c3RtZW50X2RheTogbnVtYmVyO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIFNvbGFyU291cmNlVHlwZUVuZXJneVByZWZlcmVuY2Uge1xuICB0eXBlOiBcInNvbGFyXCI7XG5cbiAgc3RhdF9lbmVyZ3lfZnJvbTogc3RyaW5nO1xuICBjb25maWdfZW50cnlfc29sYXJfZm9yZWNhc3Q6IHN0cmluZ1tdIHwgbnVsbDtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBCYXR0ZXJ5U291cmNlVHlwZUVuZXJneVByZWZlcmVuY2Uge1xuICB0eXBlOiBcImJhdHRlcnlcIjtcbiAgc3RhdF9lbmVyZ3lfZnJvbTogc3RyaW5nO1xuICBzdGF0X2VuZXJneV90bzogc3RyaW5nO1xufVxuZXhwb3J0IGludGVyZmFjZSBHYXNTb3VyY2VUeXBlRW5lcmd5UHJlZmVyZW5jZSB7XG4gIHR5cGU6IFwiZ2FzXCI7XG5cbiAgLy8ga1doL3ZvbHVtZSBtZXRlclxuICBzdGF0X2VuZXJneV9mcm9tOiBzdHJpbmc7XG5cbiAgLy8gJCBtZXRlclxuICBzdGF0X2Nvc3Q6IHN0cmluZyB8IG51bGw7XG5cbiAgLy8gQ2FuIGJlIHVzZWQgdG8gZ2VuZXJhdGUgY29zdHMgaWYgc3RhdF9jb3N0IG9taXR0ZWRcbiAgZW50aXR5X2VuZXJneV9wcmljZTogc3RyaW5nIHwgbnVsbDtcbiAgbnVtYmVyX2VuZXJneV9wcmljZTogbnVtYmVyIHwgbnVsbDtcbiAgdW5pdF9vZl9tZWFzdXJlbWVudD86IHN0cmluZyB8IG51bGw7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgV2F0ZXJTb3VyY2VUeXBlRW5lcmd5UHJlZmVyZW5jZSB7XG4gIHR5cGU6IFwid2F0ZXJcIjtcblxuICAvLyB2b2x1bWUgbWV0ZXJcbiAgc3RhdF9lbmVyZ3lfZnJvbTogc3RyaW5nO1xuXG4gIC8vICQgbWV0ZXJcbiAgc3RhdF9jb3N0OiBzdHJpbmcgfCBudWxsO1xuXG4gIC8vIENhbiBiZSB1c2VkIHRvIGdlbmVyYXRlIGNvc3RzIGlmIHN0YXRfY29zdCBvbWl0dGVkXG4gIGVudGl0eV9lbmVyZ3lfcHJpY2U6IHN0cmluZyB8IG51bGw7XG4gIG51bWJlcl9lbmVyZ3lfcHJpY2U6IG51bWJlciB8IG51bGw7XG4gIHVuaXRfb2ZfbWVhc3VyZW1lbnQ/OiBzdHJpbmcgfCBudWxsO1xufVxuXG50eXBlIEVuZXJneVNvdXJjZSA9XG4gIHwgU29sYXJTb3VyY2VUeXBlRW5lcmd5UHJlZmVyZW5jZVxuICB8IEdyaWRTb3VyY2VUeXBlRW5lcmd5UHJlZmVyZW5jZVxuICB8IEJhdHRlcnlTb3VyY2VUeXBlRW5lcmd5UHJlZmVyZW5jZVxuICB8IEdhc1NvdXJjZVR5cGVFbmVyZ3lQcmVmZXJlbmNlXG4gIHwgV2F0ZXJTb3VyY2VUeXBlRW5lcmd5UHJlZmVyZW5jZTtcblxuZXhwb3J0IGludGVyZmFjZSBFbmVyZ3lQcmVmZXJlbmNlcyB7XG4gIGVuZXJneV9zb3VyY2VzOiBFbmVyZ3lTb3VyY2VbXTtcbiAgZGV2aWNlX2NvbnN1bXB0aW9uOiBEZXZpY2VDb25zdW1wdGlvbkVuZXJneVByZWZlcmVuY2VbXTtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBFbmVyZ3lJbmZvIHtcbiAgY29zdF9zZW5zb3JzOiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+O1xuICBzb2xhcl9mb3JlY2FzdF9kb21haW5zOiBzdHJpbmdbXTtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBFbmVyZ3lWYWxpZGF0aW9uSXNzdWUge1xuICB0eXBlOiBzdHJpbmc7XG4gIGFmZmVjdGVkX2VudGl0aWVzOiBbc3RyaW5nLCB1bmtub3duXVtdO1xuICB0cmFuc2xhdGlvbl9wbGFjZWhvbGRlcnM6IFJlY29yZDxzdHJpbmcsIHN0cmluZz47XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgRW5lcmd5UHJlZmVyZW5jZXNWYWxpZGF0aW9uIHtcbiAgZW5lcmd5X3NvdXJjZXM6IEVuZXJneVZhbGlkYXRpb25Jc3N1ZVtdW107XG4gIGRldmljZV9jb25zdW1wdGlvbjogRW5lcmd5VmFsaWRhdGlvbklzc3VlW11bXTtcbn1cblxuZXhwb3J0IGNvbnN0IGdldEVuZXJneUluZm8gPSAoaGFzczogSG9tZUFzc2lzdGFudCkgPT5cbiAgaGFzcy5jYWxsV1M8RW5lcmd5SW5mbz4oe1xuICAgIHR5cGU6IFwiZW5lcmd5L2luZm9cIixcbiAgfSk7XG5cbmV4cG9ydCBjb25zdCBnZXRFbmVyZ3lQcmVmZXJlbmNlVmFsaWRhdGlvbiA9IGFzeW5jIChoYXNzOiBIb21lQXNzaXN0YW50KSA9PiB7XG4gIGF3YWl0IGhhc3MubG9hZEJhY2tlbmRUcmFuc2xhdGlvbihcImlzc3Vlc1wiLCBcImVuZXJneVwiKTtcbiAgcmV0dXJuIGhhc3MuY2FsbFdTPEVuZXJneVByZWZlcmVuY2VzVmFsaWRhdGlvbj4oe1xuICAgIHR5cGU6IFwiZW5lcmd5L3ZhbGlkYXRlXCIsXG4gIH0pO1xufTtcblxuZXhwb3J0IGNvbnN0IGdldEVuZXJneVByZWZlcmVuY2VzID0gKGhhc3M6IEhvbWVBc3Npc3RhbnQpID0+XG4gIGhhc3MuY2FsbFdTPEVuZXJneVByZWZlcmVuY2VzPih7XG4gICAgdHlwZTogXCJlbmVyZ3kvZ2V0X3ByZWZzXCIsXG4gIH0pO1xuXG5leHBvcnQgY29uc3Qgc2F2ZUVuZXJneVByZWZlcmVuY2VzID0gYXN5bmMgKFxuICBoYXNzOiBIb21lQXNzaXN0YW50LFxuICBwcmVmczogUGFydGlhbDxFbmVyZ3lQcmVmZXJlbmNlcz5cbikgPT4ge1xuICBjb25zdCBuZXdQcmVmcyA9IGhhc3MuY2FsbFdTPEVuZXJneVByZWZlcmVuY2VzPih7XG4gICAgdHlwZTogXCJlbmVyZ3kvc2F2ZV9wcmVmc1wiLFxuICAgIC4uLnByZWZzLFxuICB9KTtcbiAgY2xlYXJFbmVyZ3lDb2xsZWN0aW9uUHJlZmVyZW5jZXMoaGFzcyk7XG4gIHJldHVybiBuZXdQcmVmcztcbn07XG5cbmV4cG9ydCBpbnRlcmZhY2UgRm9zc2lsRW5lcmd5Q29uc3VtcHRpb24ge1xuICBbZGF0ZTogc3RyaW5nXTogbnVtYmVyO1xufVxuXG5leHBvcnQgY29uc3QgZ2V0Rm9zc2lsRW5lcmd5Q29uc3VtcHRpb24gPSBhc3luYyAoXG4gIGhhc3M6IEhvbWVBc3Npc3RhbnQsXG4gIHN0YXJ0VGltZTogRGF0ZSxcbiAgZW5lcmd5X3N0YXRpc3RpY19pZHM6IHN0cmluZ1tdLFxuICBjbzJfc3RhdGlzdGljX2lkOiBzdHJpbmcsXG4gIGVuZFRpbWU/OiBEYXRlLFxuICBwZXJpb2Q6IFwiNW1pbnV0ZVwiIHwgXCJob3VyXCIgfCBcImRheVwiIHwgXCJtb250aFwiID0gXCJob3VyXCJcbikgPT5cbiAgaGFzcy5jYWxsV1M8Rm9zc2lsRW5lcmd5Q29uc3VtcHRpb24+KHtcbiAgICB0eXBlOiBcImVuZXJneS9mb3NzaWxfZW5lcmd5X2NvbnN1bXB0aW9uXCIsXG4gICAgc3RhcnRfdGltZTogc3RhcnRUaW1lLnRvSVNPU3RyaW5nKCksXG4gICAgZW5kX3RpbWU6IGVuZFRpbWU/LnRvSVNPU3RyaW5nKCksXG4gICAgZW5lcmd5X3N0YXRpc3RpY19pZHMsXG4gICAgY28yX3N0YXRpc3RpY19pZCxcbiAgICBwZXJpb2QsXG4gIH0pO1xuXG5pbnRlcmZhY2UgRW5lcmd5U291cmNlQnlUeXBlIHtcbiAgZ3JpZD86IEdyaWRTb3VyY2VUeXBlRW5lcmd5UHJlZmVyZW5jZVtdO1xuICBzb2xhcj86IFNvbGFyU291cmNlVHlwZUVuZXJneVByZWZlcmVuY2VbXTtcbiAgYmF0dGVyeT86IEJhdHRlcnlTb3VyY2VUeXBlRW5lcmd5UHJlZmVyZW5jZVtdO1xuICBnYXM/OiBHYXNTb3VyY2VUeXBlRW5lcmd5UHJlZmVyZW5jZVtdO1xuICB3YXRlcj86IFdhdGVyU291cmNlVHlwZUVuZXJneVByZWZlcmVuY2VbXTtcbn1cblxuZXhwb3J0IGNvbnN0IGVuZXJneVNvdXJjZXNCeVR5cGUgPSAocHJlZnM6IEVuZXJneVByZWZlcmVuY2VzKSA9PlxuICBncm91cEJ5KHByZWZzLmVuZXJneV9zb3VyY2VzLCAoaXRlbSkgPT4gaXRlbS50eXBlKSBhcyBFbmVyZ3lTb3VyY2VCeVR5cGU7XG5cbmV4cG9ydCBpbnRlcmZhY2UgRW5lcmd5RGF0YSB7XG4gIHN0YXJ0OiBEYXRlO1xuICBlbmQ/OiBEYXRlO1xuICBzdGFydENvbXBhcmU/OiBEYXRlO1xuICBlbmRDb21wYXJlPzogRGF0ZTtcbiAgcHJlZnM6IEVuZXJneVByZWZlcmVuY2VzO1xuICBpbmZvOiBFbmVyZ3lJbmZvO1xuICBzdGF0czogU3RhdGlzdGljcztcbiAgc3RhdHNNZXRhZGF0YTogUmVjb3JkPHN0cmluZywgU3RhdGlzdGljc01ldGFEYXRhPjtcbiAgc3RhdHNDb21wYXJlOiBTdGF0aXN0aWNzO1xuICBjbzJTaWduYWxDb25maWdFbnRyeT86IENvbmZpZ0VudHJ5O1xuICBjbzJTaWduYWxFbnRpdHk/OiBzdHJpbmc7XG4gIGZvc3NpbEVuZXJneUNvbnN1bXB0aW9uPzogRm9zc2lsRW5lcmd5Q29uc3VtcHRpb247XG4gIGZvc3NpbEVuZXJneUNvbnN1bXB0aW9uQ29tcGFyZT86IEZvc3NpbEVuZXJneUNvbnN1bXB0aW9uO1xufVxuXG5leHBvcnQgY29uc3QgZ2V0UmVmZXJlbmNlZFN0YXRpc3RpY0lkcyA9IChcbiAgcHJlZnM6IEVuZXJneVByZWZlcmVuY2VzLFxuICBpbmZvOiBFbmVyZ3lJbmZvLFxuICBpbmNsdWRlVHlwZXM/OiBzdHJpbmdbXVxuKTogc3RyaW5nW10gPT4ge1xuICBjb25zdCBzdGF0SURzOiBzdHJpbmdbXSA9IFtdO1xuXG4gIGZvciAoY29uc3Qgc291cmNlIG9mIHByZWZzLmVuZXJneV9zb3VyY2VzKSB7XG4gICAgaWYgKGluY2x1ZGVUeXBlcyAmJiAhaW5jbHVkZVR5cGVzLmluY2x1ZGVzKHNvdXJjZS50eXBlKSkge1xuICAgICAgY29udGludWU7XG4gICAgfVxuXG4gICAgaWYgKHNvdXJjZS50eXBlID09PSBcInNvbGFyXCIpIHtcbiAgICAgIHN0YXRJRHMucHVzaChzb3VyY2Uuc3RhdF9lbmVyZ3lfZnJvbSk7XG4gICAgICBjb250aW51ZTtcbiAgICB9XG5cbiAgICBpZiAoc291cmNlLnR5cGUgPT09IFwiZ2FzXCIgfHwgc291cmNlLnR5cGUgPT09IFwid2F0ZXJcIikge1xuICAgICAgc3RhdElEcy5wdXNoKHNvdXJjZS5zdGF0X2VuZXJneV9mcm9tKTtcblxuICAgICAgaWYgKHNvdXJjZS5zdGF0X2Nvc3QpIHtcbiAgICAgICAgc3RhdElEcy5wdXNoKHNvdXJjZS5zdGF0X2Nvc3QpO1xuICAgICAgfVxuICAgICAgY29uc3QgY29zdFN0YXRJZCA9IGluZm8uY29zdF9zZW5zb3JzW3NvdXJjZS5zdGF0X2VuZXJneV9mcm9tXTtcbiAgICAgIGlmIChjb3N0U3RhdElkKSB7XG4gICAgICAgIHN0YXRJRHMucHVzaChjb3N0U3RhdElkKTtcbiAgICAgIH1cbiAgICAgIGNvbnRpbnVlO1xuICAgIH1cblxuICAgIGlmIChzb3VyY2UudHlwZSA9PT0gXCJiYXR0ZXJ5XCIpIHtcbiAgICAgIHN0YXRJRHMucHVzaChzb3VyY2Uuc3RhdF9lbmVyZ3lfZnJvbSk7XG4gICAgICBzdGF0SURzLnB1c2goc291cmNlLnN0YXRfZW5lcmd5X3RvKTtcbiAgICAgIGNvbnRpbnVlO1xuICAgIH1cblxuICAgIC8vIGdyaWQgc291cmNlXG4gICAgZm9yIChjb25zdCBmbG93RnJvbSBvZiBzb3VyY2UuZmxvd19mcm9tKSB7XG4gICAgICBzdGF0SURzLnB1c2goZmxvd0Zyb20uc3RhdF9lbmVyZ3lfZnJvbSk7XG4gICAgICBpZiAoZmxvd0Zyb20uc3RhdF9jb3N0KSB7XG4gICAgICAgIHN0YXRJRHMucHVzaChmbG93RnJvbS5zdGF0X2Nvc3QpO1xuICAgICAgfVxuICAgICAgY29uc3QgY29zdFN0YXRJZCA9IGluZm8uY29zdF9zZW5zb3JzW2Zsb3dGcm9tLnN0YXRfZW5lcmd5X2Zyb21dO1xuICAgICAgaWYgKGNvc3RTdGF0SWQpIHtcbiAgICAgICAgc3RhdElEcy5wdXNoKGNvc3RTdGF0SWQpO1xuICAgICAgfVxuICAgIH1cbiAgICBmb3IgKGNvbnN0IGZsb3dUbyBvZiBzb3VyY2UuZmxvd190bykge1xuICAgICAgc3RhdElEcy5wdXNoKGZsb3dUby5zdGF0X2VuZXJneV90byk7XG4gICAgICBpZiAoZmxvd1RvLnN0YXRfY29tcGVuc2F0aW9uKSB7XG4gICAgICAgIHN0YXRJRHMucHVzaChmbG93VG8uc3RhdF9jb21wZW5zYXRpb24pO1xuICAgICAgfVxuICAgICAgY29uc3QgY29zdFN0YXRJZCA9IGluZm8uY29zdF9zZW5zb3JzW2Zsb3dUby5zdGF0X2VuZXJneV90b107XG4gICAgICBpZiAoY29zdFN0YXRJZCkge1xuICAgICAgICBzdGF0SURzLnB1c2goY29zdFN0YXRJZCk7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIHN0YXRJRHM7XG59O1xuXG5jb25zdCBnZXRFbmVyZ3lEYXRhID0gYXN5bmMgKFxuICBoYXNzOiBIb21lQXNzaXN0YW50LFxuICBwcmVmczogRW5lcmd5UHJlZmVyZW5jZXMsXG4gIHN0YXJ0OiBEYXRlLFxuICBlbmQ/OiBEYXRlLFxuICBjb21wYXJlPzogYm9vbGVhblxuKTogUHJvbWlzZTxFbmVyZ3lEYXRhPiA9PiB7XG4gIGNvbnN0IFtjb25maWdFbnRyaWVzLCBpbmZvXSA9IGF3YWl0IFByb21pc2UuYWxsKFtcbiAgICBnZXRDb25maWdFbnRyaWVzKGhhc3MsIHsgZG9tYWluOiBcImNvMnNpZ25hbFwiIH0pLFxuICAgIGdldEVuZXJneUluZm8oaGFzcyksXG4gIF0pO1xuXG4gIGNvbnN0IGNvMlNpZ25hbENvbmZpZ0VudHJ5ID0gY29uZmlnRW50cmllcy5sZW5ndGhcbiAgICA/IGNvbmZpZ0VudHJpZXNbMF1cbiAgICA6IHVuZGVmaW5lZDtcblxuICBsZXQgY28yU2lnbmFsRW50aXR5OiBzdHJpbmcgfCB1bmRlZmluZWQ7XG4gIGlmIChjbzJTaWduYWxDb25maWdFbnRyeSkge1xuICAgIGZvciAoY29uc3QgZW50aXR5IG9mIE9iamVjdC52YWx1ZXMoaGFzcy5lbnRpdGllcykpIHtcbiAgICAgIGlmIChlbnRpdHkucGxhdGZvcm0gIT09IFwiY28yc2lnbmFsXCIpIHtcbiAgICAgICAgY29udGludWU7XG4gICAgICB9XG5cbiAgICAgIC8vIFRoZSBpbnRlZ3JhdGlvbiBvZmZlcnMgMiBlbnRpdGllcy4gV2Ugd2FudCB0aGUgJSBvbmUuXG4gICAgICBjb25zdCBjbzJTdGF0ZSA9IGhhc3Muc3RhdGVzW2VudGl0eS5lbnRpdHlfaWRdO1xuICAgICAgaWYgKCFjbzJTdGF0ZSB8fCBjbzJTdGF0ZS5hdHRyaWJ1dGVzLnVuaXRfb2ZfbWVhc3VyZW1lbnQgIT09IFwiJVwiKSB7XG4gICAgICAgIGNvbnRpbnVlO1xuICAgICAgfVxuXG4gICAgICBjbzJTaWduYWxFbnRpdHkgPSBjbzJTdGF0ZS5lbnRpdHlfaWQ7XG4gICAgICBicmVhaztcbiAgICB9XG4gIH1cblxuICBjb25zdCBjb25zdW1wdGlvblN0YXRJRHM6IHN0cmluZ1tdID0gW107XG4gIGZvciAoY29uc3Qgc291cmNlIG9mIHByZWZzLmVuZXJneV9zb3VyY2VzKSB7XG4gICAgLy8gZ3JpZCBzb3VyY2VcbiAgICBpZiAoc291cmNlLnR5cGUgPT09IFwiZ3JpZFwiKSB7XG4gICAgICBmb3IgKGNvbnN0IGZsb3dGcm9tIG9mIHNvdXJjZS5mbG93X2Zyb20pIHtcbiAgICAgICAgY29uc3VtcHRpb25TdGF0SURzLnB1c2goZmxvd0Zyb20uc3RhdF9lbmVyZ3lfZnJvbSk7XG4gICAgICB9XG4gICAgfVxuICB9XG4gIGNvbnN0IGVuZXJneVN0YXRJZHMgPSBnZXRSZWZlcmVuY2VkU3RhdGlzdGljSWRzKHByZWZzLCBpbmZvLCBbXG4gICAgXCJncmlkXCIsXG4gICAgXCJzb2xhclwiLFxuICAgIFwiYmF0dGVyeVwiLFxuICAgIFwiZ2FzXCIsXG4gIF0pO1xuICBjb25zdCB3YXRlclN0YXRJZHMgPSBnZXRSZWZlcmVuY2VkU3RhdGlzdGljSWRzKHByZWZzLCBpbmZvLCBbXCJ3YXRlclwiXSk7XG5cbiAgY29uc3QgYWxsU3RhdElEcyA9IFsuLi5lbmVyZ3lTdGF0SWRzLCAuLi53YXRlclN0YXRJZHNdO1xuXG4gIGNvbnN0IGRheURpZmZlcmVuY2UgPSBkaWZmZXJlbmNlSW5EYXlzKGVuZCB8fCBuZXcgRGF0ZSgpLCBzdGFydCk7XG4gIGNvbnN0IHBlcmlvZCA9XG4gICAgZGF5RGlmZmVyZW5jZSA+IDM1ID8gXCJtb250aFwiIDogZGF5RGlmZmVyZW5jZSA+IDIgPyBcImRheVwiIDogXCJob3VyXCI7XG5cbiAgY29uc3QgbGVuZ3RoVW5pdCA9IGhhc3MuY29uZmlnLnVuaXRfc3lzdGVtLmxlbmd0aCB8fCBcIlwiO1xuICBjb25zdCBlbmVyZ3lVbml0czogU3RhdGlzdGljc1VuaXRDb25maWd1cmF0aW9uID0ge1xuICAgIGVuZXJneTogXCJrV2hcIixcbiAgICB2b2x1bWU6IGxlbmd0aFVuaXQgPT09IFwia21cIiA/IFwibcKzXCIgOiBcImZ0wrNcIixcbiAgfTtcbiAgY29uc3Qgd2F0ZXJVbml0czogU3RhdGlzdGljc1VuaXRDb25maWd1cmF0aW9uID0ge1xuICAgIHZvbHVtZTogbGVuZ3RoVW5pdCA9PT0gXCJrbVwiID8gXCJMXCIgOiBcImdhbFwiLFxuICB9O1xuXG4gIGNvbnN0IF9lbmVyZ3lTdGF0czogU3RhdGlzdGljcyB8IFByb21pc2U8U3RhdGlzdGljcz4gPSBlbmVyZ3lTdGF0SWRzLmxlbmd0aFxuICAgID8gZmV0Y2hTdGF0aXN0aWNzKGhhc3MhLCBzdGFydCwgZW5kLCBlbmVyZ3lTdGF0SWRzLCBwZXJpb2QsIGVuZXJneVVuaXRzLCBbXG4gICAgICAgIFwiY2hhbmdlXCIsXG4gICAgICBdKVxuICAgIDoge307XG4gIGNvbnN0IF93YXRlclN0YXRzOiBTdGF0aXN0aWNzIHwgUHJvbWlzZTxTdGF0aXN0aWNzPiA9IHdhdGVyU3RhdElkcy5sZW5ndGhcbiAgICA/IGZldGNoU3RhdGlzdGljcyhoYXNzISwgc3RhcnQsIGVuZCwgd2F0ZXJTdGF0SWRzLCBwZXJpb2QsIHdhdGVyVW5pdHMsIFtcbiAgICAgICAgXCJjaGFuZ2VcIixcbiAgICAgIF0pXG4gICAgOiB7fTtcblxuICBsZXQgc3RhdHNDb21wYXJlO1xuICBsZXQgc3RhcnRDb21wYXJlO1xuICBsZXQgZW5kQ29tcGFyZTtcbiAgbGV0IF9lbmVyZ3lTdGF0c0NvbXBhcmU6IFN0YXRpc3RpY3MgfCBQcm9taXNlPFN0YXRpc3RpY3M+ID0ge307XG4gIGxldCBfd2F0ZXJTdGF0c0NvbXBhcmU6IFN0YXRpc3RpY3MgfCBQcm9taXNlPFN0YXRpc3RpY3M+ID0ge307XG5cbiAgaWYgKGNvbXBhcmUpIHtcbiAgICBpZiAoZGF5RGlmZmVyZW5jZSA+IDI3ICYmIGRheURpZmZlcmVuY2UgPCAzMikge1xuICAgICAgLy8gV2hlbiBjb21wYXJpbmcgYSBtb250aCwgd2Ugd2FudCB0byBzdGFydCBhdCB0aGUgYmVnaW5pbmcgb2YgdGhlIG1vbnRoXG4gICAgICBzdGFydENvbXBhcmUgPSBhZGRNb250aHMoc3RhcnQsIC0xKTtcbiAgICB9IGVsc2Uge1xuICAgICAgc3RhcnRDb21wYXJlID0gYWRkRGF5cyhzdGFydCwgKGRheURpZmZlcmVuY2UgKyAxKSAqIC0xKTtcbiAgICB9XG4gICAgZW5kQ29tcGFyZSA9IGFkZE1pbGxpc2Vjb25kcyhzdGFydCwgLTEpO1xuICAgIGlmIChlbmVyZ3lTdGF0SWRzLmxlbmd0aCkge1xuICAgICAgX2VuZXJneVN0YXRzQ29tcGFyZSA9IGZldGNoU3RhdGlzdGljcyhcbiAgICAgICAgaGFzcyEsXG4gICAgICAgIHN0YXJ0Q29tcGFyZSxcbiAgICAgICAgZW5kQ29tcGFyZSxcbiAgICAgICAgZW5lcmd5U3RhdElkcyxcbiAgICAgICAgcGVyaW9kLFxuICAgICAgICBlbmVyZ3lVbml0cyxcbiAgICAgICAgW1wiY2hhbmdlXCJdXG4gICAgICApO1xuICAgIH1cbiAgICBpZiAod2F0ZXJTdGF0SWRzLmxlbmd0aCkge1xuICAgICAgX3dhdGVyU3RhdHNDb21wYXJlID0gZmV0Y2hTdGF0aXN0aWNzKFxuICAgICAgICBoYXNzISxcbiAgICAgICAgc3RhcnRDb21wYXJlLFxuICAgICAgICBlbmRDb21wYXJlLFxuICAgICAgICB3YXRlclN0YXRJZHMsXG4gICAgICAgIHBlcmlvZCxcbiAgICAgICAgd2F0ZXJVbml0cyxcbiAgICAgICAgW1wiY2hhbmdlXCJdXG4gICAgICApO1xuICAgIH1cbiAgfVxuXG4gIGxldCBfZm9zc2lsRW5lcmd5Q29uc3VtcHRpb246IHVuZGVmaW5lZCB8IFByb21pc2U8Rm9zc2lsRW5lcmd5Q29uc3VtcHRpb24+O1xuICBsZXQgX2Zvc3NpbEVuZXJneUNvbnN1bXB0aW9uQ29tcGFyZTpcbiAgICB8IHVuZGVmaW5lZFxuICAgIHwgUHJvbWlzZTxGb3NzaWxFbmVyZ3lDb25zdW1wdGlvbj47XG4gIGlmIChjbzJTaWduYWxFbnRpdHkgIT09IHVuZGVmaW5lZCkge1xuICAgIF9mb3NzaWxFbmVyZ3lDb25zdW1wdGlvbiA9IGdldEZvc3NpbEVuZXJneUNvbnN1bXB0aW9uKFxuICAgICAgaGFzcyEsXG4gICAgICBzdGFydCxcbiAgICAgIGNvbnN1bXB0aW9uU3RhdElEcyxcbiAgICAgIGNvMlNpZ25hbEVudGl0eSxcbiAgICAgIGVuZCxcbiAgICAgIGRheURpZmZlcmVuY2UgPiAzNSA/IFwibW9udGhcIiA6IGRheURpZmZlcmVuY2UgPiAyID8gXCJkYXlcIiA6IFwiaG91clwiXG4gICAgKTtcbiAgICBpZiAoY29tcGFyZSkge1xuICAgICAgX2Zvc3NpbEVuZXJneUNvbnN1bXB0aW9uQ29tcGFyZSA9IGdldEZvc3NpbEVuZXJneUNvbnN1bXB0aW9uKFxuICAgICAgICBoYXNzISxcbiAgICAgICAgc3RhcnRDb21wYXJlLFxuICAgICAgICBjb25zdW1wdGlvblN0YXRJRHMsXG4gICAgICAgIGNvMlNpZ25hbEVudGl0eSxcbiAgICAgICAgZW5kQ29tcGFyZSxcbiAgICAgICAgZGF5RGlmZmVyZW5jZSA+IDM1ID8gXCJtb250aFwiIDogZGF5RGlmZmVyZW5jZSA+IDIgPyBcImRheVwiIDogXCJob3VyXCJcbiAgICAgICk7XG4gICAgfVxuICB9XG5cbiAgY29uc3Qgc3RhdHNNZXRhZGF0YTogUmVjb3JkPHN0cmluZywgU3RhdGlzdGljc01ldGFEYXRhPiA9IHt9O1xuICBjb25zdCBfZ2V0U3RhdGlzdGljTWV0YWRhdGE6XG4gICAgfCBQcm9taXNlPFN0YXRpc3RpY3NNZXRhRGF0YVtdPlxuICAgIHwgU3RhdGlzdGljc01ldGFEYXRhW10gPSBhbGxTdGF0SURzLmxlbmd0aFxuICAgID8gZ2V0U3RhdGlzdGljTWV0YWRhdGEoaGFzcywgYWxsU3RhdElEcylcbiAgICA6IFtdO1xuICBjb25zdCBbXG4gICAgZW5lcmd5U3RhdHMsXG4gICAgd2F0ZXJTdGF0cyxcbiAgICBlbmVyZ3lTdGF0c0NvbXBhcmUsXG4gICAgd2F0ZXJTdGF0c0NvbXBhcmUsXG4gICAgc3RhdHNNZXRhZGF0YUFycmF5LFxuICAgIGZvc3NpbEVuZXJneUNvbnN1bXB0aW9uLFxuICAgIGZvc3NpbEVuZXJneUNvbnN1bXB0aW9uQ29tcGFyZSxcbiAgXSA9IGF3YWl0IFByb21pc2UuYWxsKFtcbiAgICBfZW5lcmd5U3RhdHMsXG4gICAgX3dhdGVyU3RhdHMsXG4gICAgX2VuZXJneVN0YXRzQ29tcGFyZSxcbiAgICBfd2F0ZXJTdGF0c0NvbXBhcmUsXG4gICAgX2dldFN0YXRpc3RpY01ldGFkYXRhLFxuICAgIF9mb3NzaWxFbmVyZ3lDb25zdW1wdGlvbixcbiAgICBfZm9zc2lsRW5lcmd5Q29uc3VtcHRpb25Db21wYXJlLFxuICBdKTtcbiAgY29uc3Qgc3RhdHMgPSB7IC4uLmVuZXJneVN0YXRzLCAuLi53YXRlclN0YXRzIH07XG4gIGlmIChjb21wYXJlKSB7XG4gICAgc3RhdHNDb21wYXJlID0geyAuLi5lbmVyZ3lTdGF0c0NvbXBhcmUsIC4uLndhdGVyU3RhdHNDb21wYXJlIH07XG4gIH1cbiAgaWYgKGFsbFN0YXRJRHMubGVuZ3RoKSB7XG4gICAgc3RhdHNNZXRhZGF0YUFycmF5LmZvckVhY2goKHgpID0+IHtcbiAgICAgIHN0YXRzTWV0YWRhdGFbeC5zdGF0aXN0aWNfaWRdID0geDtcbiAgICB9KTtcbiAgfVxuXG4gIGNvbnN0IGRhdGE6IEVuZXJneURhdGEgPSB7XG4gICAgc3RhcnQsXG4gICAgZW5kLFxuICAgIHN0YXJ0Q29tcGFyZSxcbiAgICBlbmRDb21wYXJlLFxuICAgIGluZm8sXG4gICAgcHJlZnMsXG4gICAgc3RhdHMsXG4gICAgc3RhdHNNZXRhZGF0YSxcbiAgICBzdGF0c0NvbXBhcmUsXG4gICAgY28yU2lnbmFsQ29uZmlnRW50cnksXG4gICAgY28yU2lnbmFsRW50aXR5LFxuICAgIGZvc3NpbEVuZXJneUNvbnN1bXB0aW9uLFxuICAgIGZvc3NpbEVuZXJneUNvbnN1bXB0aW9uQ29tcGFyZSxcbiAgfTtcblxuICByZXR1cm4gZGF0YTtcbn07XG5cbmV4cG9ydCBpbnRlcmZhY2UgRW5lcmd5Q29sbGVjdGlvbiBleHRlbmRzIENvbGxlY3Rpb248RW5lcmd5RGF0YT4ge1xuICBzdGFydDogRGF0ZTtcbiAgZW5kPzogRGF0ZTtcbiAgY29tcGFyZT86IGJvb2xlYW47XG4gIHByZWZzPzogRW5lcmd5UHJlZmVyZW5jZXM7XG4gIGNsZWFyUHJlZnMoKTogdm9pZDtcbiAgc2V0UGVyaW9kKG5ld1N0YXJ0OiBEYXRlLCBuZXdFbmQ/OiBEYXRlKTogdm9pZDtcbiAgc2V0Q29tcGFyZShjb21wYXJlOiBib29sZWFuKTogdm9pZDtcbiAgX3JlZnJlc2hUaW1lb3V0PzogbnVtYmVyO1xuICBfdXBkYXRlUGVyaW9kVGltZW91dD86IG51bWJlcjtcbiAgX2FjdGl2ZTogbnVtYmVyO1xufVxuXG5jb25zdCBjbGVhckVuZXJneUNvbGxlY3Rpb25QcmVmZXJlbmNlcyA9IChoYXNzOiBIb21lQXNzaXN0YW50KSA9PiB7XG4gIGVuZXJneUNvbGxlY3Rpb25LZXlzLmZvckVhY2goKGtleSkgPT4ge1xuICAgIGNvbnN0IGVuZXJneUNvbGxlY3Rpb24gPSBnZXRFbmVyZ3lEYXRhQ29sbGVjdGlvbihoYXNzLCB7IGtleSB9KTtcbiAgICBlbmVyZ3lDb2xsZWN0aW9uLmNsZWFyUHJlZnMoKTtcbiAgICBpZiAoZW5lcmd5Q29sbGVjdGlvbi5fYWN0aXZlKSB7XG4gICAgICBlbmVyZ3lDb2xsZWN0aW9uLnJlZnJlc2goKTtcbiAgICB9XG4gIH0pO1xufTtcblxuZXhwb3J0IGNvbnN0IGdldEVuZXJneURhdGFDb2xsZWN0aW9uID0gKFxuICBoYXNzOiBIb21lQXNzaXN0YW50LFxuICBvcHRpb25zOiB7IHByZWZzPzogRW5lcmd5UHJlZmVyZW5jZXM7IGtleT86IHN0cmluZyB9ID0ge31cbik6IEVuZXJneUNvbGxlY3Rpb24gPT4ge1xuICBsZXQga2V5ID0gXCJfZW5lcmd5XCI7XG4gIGlmIChvcHRpb25zLmtleSkge1xuICAgIGlmICghb3B0aW9ucy5rZXkuc3RhcnRzV2l0aChcImVuZXJneV9cIikpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihcIktleSBuZWVkIHRvIHN0YXJ0IHdpdGggZW5lcmd5X1wiKTtcbiAgICB9XG4gICAga2V5ID0gYF8ke29wdGlvbnMua2V5fWA7XG4gIH1cblxuICBpZiAoKGhhc3MuY29ubmVjdGlvbiBhcyBhbnkpW2tleV0pIHtcbiAgICByZXR1cm4gKGhhc3MuY29ubmVjdGlvbiBhcyBhbnkpW2tleV07XG4gIH1cblxuICBlbmVyZ3lDb2xsZWN0aW9uS2V5cy5wdXNoKG9wdGlvbnMua2V5KTtcblxuICBjb25zdCBjb2xsZWN0aW9uID0gZ2V0Q29sbGVjdGlvbjxFbmVyZ3lEYXRhPihcbiAgICBoYXNzLmNvbm5lY3Rpb24sXG4gICAga2V5LFxuICAgIGFzeW5jICgpID0+IHtcbiAgICAgIGlmICghY29sbGVjdGlvbi5wcmVmcykge1xuICAgICAgICAvLyBUaGlzIHdpbGwgcmFpc2UgaWYgbm90IGZvdW5kLlxuICAgICAgICAvLyBEZXRlY3QgYnkgY2hlY2tpbmcgYGUuY29kZSA9PT0gXCJub3RfZm91bmRcIlxuICAgICAgICBjb2xsZWN0aW9uLnByZWZzID0gYXdhaXQgZ2V0RW5lcmd5UHJlZmVyZW5jZXMoaGFzcyk7XG4gICAgICB9XG5cbiAgICAgIGlmIChjb2xsZWN0aW9uLl9yZWZyZXNoVGltZW91dCkge1xuICAgICAgICBjbGVhclRpbWVvdXQoY29sbGVjdGlvbi5fcmVmcmVzaFRpbWVvdXQpO1xuICAgICAgfVxuXG4gICAgICBpZiAoXG4gICAgICAgIGNvbGxlY3Rpb24uX2FjdGl2ZSAmJlxuICAgICAgICAoIWNvbGxlY3Rpb24uZW5kIHx8IGNvbGxlY3Rpb24uZW5kID4gbmV3IERhdGUoKSlcbiAgICAgICkge1xuICAgICAgICAvLyBUaGUgc3RhdHMgYXJlIGNyZWF0ZWQgZXZlcnkgaG91clxuICAgICAgICAvLyBTY2hlZHVsZSBhIHJlZnJlc2ggZm9yIDIwIG1pbnV0ZXMgcGFzdCB0aGUgaG91clxuICAgICAgICAvLyBJZiB0aGUgZW5kIGlzIGxhcmdlciB0aGFuIHRoZSBjdXJyZW50IHRpbWUuXG4gICAgICAgIGNvbnN0IG5leHRGZXRjaCA9IG5ldyBEYXRlKCk7XG4gICAgICAgIGlmIChuZXh0RmV0Y2guZ2V0TWludXRlcygpID49IDIwKSB7XG4gICAgICAgICAgbmV4dEZldGNoLnNldEhvdXJzKG5leHRGZXRjaC5nZXRIb3VycygpICsgMSk7XG4gICAgICAgIH1cbiAgICAgICAgbmV4dEZldGNoLnNldE1pbnV0ZXMoMjAsIDAsIDApO1xuXG4gICAgICAgIGNvbGxlY3Rpb24uX3JlZnJlc2hUaW1lb3V0ID0gd2luZG93LnNldFRpbWVvdXQoXG4gICAgICAgICAgKCkgPT4gY29sbGVjdGlvbi5yZWZyZXNoKCksXG4gICAgICAgICAgbmV4dEZldGNoLmdldFRpbWUoKSAtIERhdGUubm93KClcbiAgICAgICAgKTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIGdldEVuZXJneURhdGEoXG4gICAgICAgIGhhc3MsXG4gICAgICAgIGNvbGxlY3Rpb24ucHJlZnMsXG4gICAgICAgIGNvbGxlY3Rpb24uc3RhcnQsXG4gICAgICAgIGNvbGxlY3Rpb24uZW5kLFxuICAgICAgICBjb2xsZWN0aW9uLmNvbXBhcmVcbiAgICAgICk7XG4gICAgfVxuICApIGFzIEVuZXJneUNvbGxlY3Rpb247XG5cbiAgY29uc3Qgb3JpZ1N1YnNjcmliZSA9IGNvbGxlY3Rpb24uc3Vic2NyaWJlO1xuXG4gIGNvbGxlY3Rpb24uc3Vic2NyaWJlID0gKHN1YnNjcmliZXI6IChkYXRhOiBFbmVyZ3lEYXRhKSA9PiB2b2lkKSA9PiB7XG4gICAgY29uc3QgdW5zdWIgPSBvcmlnU3Vic2NyaWJlKHN1YnNjcmliZXIpO1xuICAgIGNvbGxlY3Rpb24uX2FjdGl2ZSsrO1xuICAgIHJldHVybiAoKSA9PiB7XG4gICAgICBjb2xsZWN0aW9uLl9hY3RpdmUtLTtcbiAgICAgIGlmIChjb2xsZWN0aW9uLl9hY3RpdmUgPCAxKSB7XG4gICAgICAgIGNsZWFyVGltZW91dChjb2xsZWN0aW9uLl9yZWZyZXNoVGltZW91dCk7XG4gICAgICAgIGNvbGxlY3Rpb24uX3JlZnJlc2hUaW1lb3V0ID0gdW5kZWZpbmVkO1xuICAgICAgfVxuICAgICAgdW5zdWIoKTtcbiAgICB9O1xuICB9O1xuXG4gIGNvbGxlY3Rpb24uX2FjdGl2ZSA9IDA7XG4gIGNvbGxlY3Rpb24ucHJlZnMgPSBvcHRpb25zLnByZWZzO1xuICBjb25zdCBub3cgPSBuZXcgRGF0ZSgpO1xuICAvLyBTZXQgc3RhcnQgdG8gc3RhcnQgb2YgdG9kYXkgaWYgd2UgaGF2ZSBkYXRhIGZvciB0b2RheSwgb3RoZXJ3aXNlIHllc3RlcmRheVxuICBjb2xsZWN0aW9uLnN0YXJ0ID0gbm93LmdldEhvdXJzKCkgPiAwID8gc3RhcnRPZlRvZGF5KCkgOiBzdGFydE9mWWVzdGVyZGF5KCk7XG4gIGNvbGxlY3Rpb24uZW5kID0gbm93LmdldEhvdXJzKCkgPiAwID8gZW5kT2ZUb2RheSgpIDogZW5kT2ZZZXN0ZXJkYXkoKTtcblxuICBjb25zdCBzY2hlZHVsZVVwZGF0ZVBlcmlvZCA9ICgpID0+IHtcbiAgICBjb2xsZWN0aW9uLl91cGRhdGVQZXJpb2RUaW1lb3V0ID0gd2luZG93LnNldFRpbWVvdXQoXG4gICAgICAoKSA9PiB7XG4gICAgICAgIGNvbGxlY3Rpb24uc3RhcnQgPSBzdGFydE9mVG9kYXkoKTtcbiAgICAgICAgY29sbGVjdGlvbi5lbmQgPSBlbmRPZlRvZGF5KCk7XG4gICAgICAgIHNjaGVkdWxlVXBkYXRlUGVyaW9kKCk7XG4gICAgICB9LFxuICAgICAgYWRkSG91cnMoZW5kT2ZUb2RheSgpLCAxKS5nZXRUaW1lKCkgLSBEYXRlLm5vdygpIC8vIFN3aXRjaCB0byBuZXh0IGRheSBhbiBob3VyIGFmdGVyIHRoZSBkYXkgY2hhbmdlZFxuICAgICk7XG4gIH07XG4gIHNjaGVkdWxlVXBkYXRlUGVyaW9kKCk7XG5cbiAgY29sbGVjdGlvbi5jbGVhclByZWZzID0gKCkgPT4ge1xuICAgIGNvbGxlY3Rpb24ucHJlZnMgPSB1bmRlZmluZWQ7XG4gIH07XG4gIGNvbGxlY3Rpb24uc2V0UGVyaW9kID0gKG5ld1N0YXJ0OiBEYXRlLCBuZXdFbmQ/OiBEYXRlKSA9PiB7XG4gICAgY29sbGVjdGlvbi5zdGFydCA9IG5ld1N0YXJ0O1xuICAgIGNvbGxlY3Rpb24uZW5kID0gbmV3RW5kO1xuICAgIGlmIChcbiAgICAgIGNvbGxlY3Rpb24uc3RhcnQuZ2V0VGltZSgpID09PSBzdGFydE9mVG9kYXkoKS5nZXRUaW1lKCkgJiZcbiAgICAgIGNvbGxlY3Rpb24uZW5kPy5nZXRUaW1lKCkgPT09IGVuZE9mVG9kYXkoKS5nZXRUaW1lKCkgJiZcbiAgICAgICFjb2xsZWN0aW9uLl91cGRhdGVQZXJpb2RUaW1lb3V0XG4gICAgKSB7XG4gICAgICBzY2hlZHVsZVVwZGF0ZVBlcmlvZCgpO1xuICAgIH0gZWxzZSBpZiAoY29sbGVjdGlvbi5fdXBkYXRlUGVyaW9kVGltZW91dCkge1xuICAgICAgY2xlYXJUaW1lb3V0KGNvbGxlY3Rpb24uX3VwZGF0ZVBlcmlvZFRpbWVvdXQpO1xuICAgICAgY29sbGVjdGlvbi5fdXBkYXRlUGVyaW9kVGltZW91dCA9IHVuZGVmaW5lZDtcbiAgICB9XG4gIH07XG4gIGNvbGxlY3Rpb24uc2V0Q29tcGFyZSA9IChjb21wYXJlOiBib29sZWFuKSA9PiB7XG4gICAgY29sbGVjdGlvbi5jb21wYXJlID0gY29tcGFyZTtcbiAgfTtcbiAgcmV0dXJuIGNvbGxlY3Rpb247XG59O1xuXG5leHBvcnQgY29uc3QgZ2V0RW5lcmd5U29sYXJGb3JlY2FzdHMgPSAoaGFzczogSG9tZUFzc2lzdGFudCkgPT5cbiAgaGFzcy5jYWxsV1M8RW5lcmd5U29sYXJGb3JlY2FzdHM+KHtcbiAgICB0eXBlOiBcImVuZXJneS9zb2xhcl9mb3JlY2FzdFwiLFxuICB9KTtcblxuY29uc3QgZW5lcmd5R2FzVW5pdENsYXNzID0gW1widm9sdW1lXCIsIFwiZW5lcmd5XCJdIGFzIGNvbnN0O1xuZXhwb3J0IHR5cGUgRW5lcmd5R2FzVW5pdENsYXNzID0gKHR5cGVvZiBlbmVyZ3lHYXNVbml0Q2xhc3MpW251bWJlcl07XG5cbmV4cG9ydCBjb25zdCBnZXRFbmVyZ3lHYXNVbml0Q2xhc3MgPSAoXG4gIHByZWZzOiBFbmVyZ3lQcmVmZXJlbmNlcyxcbiAgc3RhdGlzdGljc01ldGFEYXRhOiBSZWNvcmQ8c3RyaW5nLCBTdGF0aXN0aWNzTWV0YURhdGE+ID0ge30sXG4gIGV4Y2x1ZGVTb3VyY2U/OiBzdHJpbmdcbik6IEVuZXJneUdhc1VuaXRDbGFzcyB8IHVuZGVmaW5lZCA9PiB7XG4gIGZvciAoY29uc3Qgc291cmNlIG9mIHByZWZzLmVuZXJneV9zb3VyY2VzKSB7XG4gICAgaWYgKHNvdXJjZS50eXBlICE9PSBcImdhc1wiKSB7XG4gICAgICBjb250aW51ZTtcbiAgICB9XG4gICAgaWYgKGV4Y2x1ZGVTb3VyY2UgJiYgZXhjbHVkZVNvdXJjZSA9PT0gc291cmNlLnN0YXRfZW5lcmd5X2Zyb20pIHtcbiAgICAgIGNvbnRpbnVlO1xuICAgIH1cbiAgICBjb25zdCBzdGF0aXN0aWNJZFdpdGhNZXRhID0gc3RhdGlzdGljc01ldGFEYXRhW3NvdXJjZS5zdGF0X2VuZXJneV9mcm9tXTtcbiAgICBpZiAoXG4gICAgICBlbmVyZ3lHYXNVbml0Q2xhc3MuaW5jbHVkZXMoXG4gICAgICAgIHN0YXRpc3RpY0lkV2l0aE1ldGE/LnVuaXRfY2xhc3MgYXMgRW5lcmd5R2FzVW5pdENsYXNzXG4gICAgICApXG4gICAgKSB7XG4gICAgICByZXR1cm4gc3RhdGlzdGljSWRXaXRoTWV0YS51bml0X2NsYXNzIGFzIEVuZXJneUdhc1VuaXRDbGFzcztcbiAgICB9XG4gIH1cbiAgcmV0dXJuIHVuZGVmaW5lZDtcbn07XG5cbmV4cG9ydCBjb25zdCBnZXRFbmVyZ3lHYXNVbml0ID0gKFxuICBoYXNzOiBIb21lQXNzaXN0YW50LFxuICBwcmVmczogRW5lcmd5UHJlZmVyZW5jZXMsXG4gIHN0YXRpc3RpY3NNZXRhRGF0YTogUmVjb3JkPHN0cmluZywgU3RhdGlzdGljc01ldGFEYXRhPiA9IHt9XG4pOiBzdHJpbmcgfCB1bmRlZmluZWQgPT4ge1xuICBjb25zdCB1bml0Q2xhc3MgPSBnZXRFbmVyZ3lHYXNVbml0Q2xhc3MocHJlZnMsIHN0YXRpc3RpY3NNZXRhRGF0YSk7XG4gIGlmICh1bml0Q2xhc3MgPT09IHVuZGVmaW5lZCkge1xuICAgIHJldHVybiB1bmRlZmluZWQ7XG4gIH1cbiAgcmV0dXJuIHVuaXRDbGFzcyA9PT0gXCJlbmVyZ3lcIlxuICAgID8gXCJrV2hcIlxuICAgIDogaGFzcy5jb25maWcudW5pdF9zeXN0ZW0ubGVuZ3RoID09PSBcImttXCJcbiAgICA/IFwibcKzXCJcbiAgICA6IFwiZnTCs1wiO1xufTtcblxuZXhwb3J0IGNvbnN0IGdldEVuZXJneVdhdGVyVW5pdCA9IChoYXNzOiBIb21lQXNzaXN0YW50KTogc3RyaW5nIHwgdW5kZWZpbmVkID0+XG4gIGhhc3MuY29uZmlnLnVuaXRfc3lzdGVtLmxlbmd0aCA9PT0gXCJrbVwiID8gXCJMXCIgOiBcImdhbFwiO1xuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./src/data/energy.ts\n");

/***/ })

}]);