"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(self["webpackChunkhome_assistant_frontend"] = self["webpackChunkhome_assistant_frontend"] || []).push([["src_panels_lovelace_cards_energy_hui-energy-usage-graph-card_ts"],{

/***/ "./src/mixins/subscribe-mixin.ts":
/*!***************************************!*\
  !*** ./src/mixins/subscribe-mixin.ts ***!
  \***************************************/
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   SubscribeMixin: function() { return /* binding */ SubscribeMixin; }\n/* harmony export */ });\n/* harmony import */ var _babel_runtime_helpers_createForOfIteratorHelper__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @babel/runtime/helpers/createForOfIteratorHelper */ \"./node_modules/@babel/runtime/helpers/esm/createForOfIteratorHelper.js\");\n/* harmony import */ var _babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @babel/runtime/helpers/createClass */ \"./node_modules/@babel/runtime/helpers/esm/createClass.js\");\n/* harmony import */ var _babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @babel/runtime/helpers/classCallCheck */ \"./node_modules/@babel/runtime/helpers/esm/classCallCheck.js\");\n/* harmony import */ var _babel_runtime_helpers_assertThisInitialized__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @babel/runtime/helpers/assertThisInitialized */ \"./node_modules/@babel/runtime/helpers/esm/assertThisInitialized.js\");\n/* harmony import */ var _babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @babel/runtime/helpers/inherits */ \"./node_modules/@babel/runtime/helpers/esm/inherits.js\");\n/* harmony import */ var _babel_runtime_helpers_createSuper__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @babel/runtime/helpers/createSuper */ \"./node_modules/@babel/runtime/helpers/esm/createSuper.js\");\n/* harmony import */ var _babel_runtime_helpers_decorate__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! @babel/runtime/helpers/decorate */ \"./node_modules/@babel/runtime/helpers/esm/decorate.js\");\n/* harmony import */ var _babel_runtime_helpers_get__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! @babel/runtime/helpers/get */ \"./node_modules/@babel/runtime/helpers/esm/get.js\");\n/* harmony import */ var _babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! @babel/runtime/helpers/getPrototypeOf */ \"./node_modules/@babel/runtime/helpers/esm/getPrototypeOf.js\");\n/* harmony import */ var lit_decorators__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! lit/decorators */ \"./node_modules/lit/decorators.js\");\n\n\n\n\n\n\n\n\n\n\nvar SubscribeMixin = function SubscribeMixin(superClass) {\n  var SubscribeClass = (0,_babel_runtime_helpers_decorate__WEBPACK_IMPORTED_MODULE_6__[\"default\"])(null, function (_initialize, _superClass) {\n    var SubscribeClass = /*#__PURE__*/function (_superClass2) {\n      (0,_babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_4__[\"default\"])(SubscribeClass, _superClass2);\n      var _super = (0,_babel_runtime_helpers_createSuper__WEBPACK_IMPORTED_MODULE_5__[\"default\"])(SubscribeClass);\n      function SubscribeClass() {\n        var _this;\n        (0,_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_2__[\"default\"])(this, SubscribeClass);\n        for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n          args[_key] = arguments[_key];\n        }\n        _this = _super.call.apply(_super, [this].concat(args));\n        _initialize((0,_babel_runtime_helpers_assertThisInitialized__WEBPACK_IMPORTED_MODULE_3__[\"default\"])(_this));\n        return _this;\n      }\n      return (0,_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1__[\"default\"])(SubscribeClass);\n    }(_superClass);\n    return {\n      F: SubscribeClass,\n      d: [{\n        kind: \"field\",\n        decorators: [(0,lit_decorators__WEBPACK_IMPORTED_MODULE_9__.property)({\n          attribute: false\n        })],\n        key: \"hass\",\n        value: void 0\n      }, {\n        kind: \"field\",\n        key: \"hassSubscribeRequiredHostProps\",\n        value: void 0\n      }, {\n        kind: \"field\",\n        key: \"__unsubs\",\n        value: void 0\n      }, {\n        kind: \"method\",\n        key: \"connectedCallback\",\n        value:\n        // we wait with subscribing till these properties are set on the host element\n\n        function connectedCallback() {\n          (0,_babel_runtime_helpers_get__WEBPACK_IMPORTED_MODULE_7__[\"default\"])((0,_babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_8__[\"default\"])(SubscribeClass.prototype), \"connectedCallback\", this).call(this);\n          this.__checkSubscribed();\n        }\n      }, {\n        kind: \"method\",\n        key: \"disconnectedCallback\",\n        value: function disconnectedCallback() {\n          (0,_babel_runtime_helpers_get__WEBPACK_IMPORTED_MODULE_7__[\"default\"])((0,_babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_8__[\"default\"])(SubscribeClass.prototype), \"disconnectedCallback\", this).call(this);\n          if (this.__unsubs) {\n            while (this.__unsubs.length) {\n              var unsub = this.__unsubs.pop();\n              if (unsub instanceof Promise) {\n                unsub.then(function (unsubFunc) {\n                  return unsubFunc();\n                });\n              } else {\n                unsub();\n              }\n            }\n            this.__unsubs = undefined;\n          }\n        }\n      }, {\n        kind: \"method\",\n        key: \"updated\",\n        value: function updated(changedProps) {\n          (0,_babel_runtime_helpers_get__WEBPACK_IMPORTED_MODULE_7__[\"default\"])((0,_babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_8__[\"default\"])(SubscribeClass.prototype), \"updated\", this).call(this, changedProps);\n          if (changedProps.has(\"hass\")) {\n            this.__checkSubscribed();\n            return;\n          }\n          if (!this.hassSubscribeRequiredHostProps) {\n            return;\n          }\n          var _iterator = (0,_babel_runtime_helpers_createForOfIteratorHelper__WEBPACK_IMPORTED_MODULE_0__[\"default\"])(changedProps.keys()),\n            _step;\n          try {\n            for (_iterator.s(); !(_step = _iterator.n()).done;) {\n              var key = _step.value;\n              if (this.hassSubscribeRequiredHostProps.includes(key)) {\n                this.__checkSubscribed();\n                return;\n              }\n            }\n          } catch (err) {\n            _iterator.e(err);\n          } finally {\n            _iterator.f();\n          }\n        }\n      }, {\n        kind: \"method\",\n        key: \"hassSubscribe\",\n        value: function hassSubscribe() {\n          return [];\n        }\n      }, {\n        kind: \"method\",\n        key: \"__checkSubscribed\",\n        value: function __checkSubscribed() {\n          var _this$hassSubscribeRe,\n            _this2 = this;\n          if (this.__unsubs !== undefined || !this.isConnected || this.hass === undefined || (_this$hassSubscribeRe = this.hassSubscribeRequiredHostProps) !== null && _this$hassSubscribeRe !== void 0 && _this$hassSubscribeRe.some(function (prop) {\n            return _this2[prop] === undefined;\n          })) {\n            return;\n          }\n          this.__unsubs = this.hassSubscribe();\n        }\n      }]\n    };\n  }, superClass);\n  return SubscribeClass;\n};//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvbWl4aW5zL3N1YnNjcmliZS1taXhpbi50cy5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUVBO0FBT0E7QUFFQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUVBOztBQUtBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBS0E7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBRUE7QUFBQTtBQUNBO0FBS0E7QUFBQTtBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBRUE7QUFDQSIsInNvdXJjZXMiOlsid2VicGFjazovL2hvbWUtYXNzaXN0YW50LWZyb250ZW5kLy4vc3JjL21peGlucy9zdWJzY3JpYmUtbWl4aW4udHM/ZjViMSJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBVbnN1YnNjcmliZUZ1bmMgfSBmcm9tIFwiaG9tZS1hc3Npc3RhbnQtanMtd2Vic29ja2V0XCI7XG5pbXBvcnQgeyBQcm9wZXJ0eVZhbHVlcywgUmVhY3RpdmVFbGVtZW50IH0gZnJvbSBcImxpdFwiO1xuaW1wb3J0IHsgcHJvcGVydHkgfSBmcm9tIFwibGl0L2RlY29yYXRvcnNcIjtcbmltcG9ydCB7IENvbnN0cnVjdG9yLCBIb21lQXNzaXN0YW50IH0gZnJvbSBcIi4uL3R5cGVzXCI7XG5cbmV4cG9ydCBpbnRlcmZhY2UgSGFzc1N1YnNjcmliZUVsZW1lbnQge1xuICBoYXNzU3Vic2NyaWJlKCk6IFVuc3Vic2NyaWJlRnVuY1tdO1xufVxuXG5leHBvcnQgY29uc3QgU3Vic2NyaWJlTWl4aW4gPSA8VCBleHRlbmRzIENvbnN0cnVjdG9yPFJlYWN0aXZlRWxlbWVudD4+KFxuICBzdXBlckNsYXNzOiBUXG4pID0+IHtcbiAgY2xhc3MgU3Vic2NyaWJlQ2xhc3MgZXh0ZW5kcyBzdXBlckNsYXNzIHtcbiAgICBAcHJvcGVydHkoeyBhdHRyaWJ1dGU6IGZhbHNlIH0pIHB1YmxpYyBoYXNzPzogSG9tZUFzc2lzdGFudDtcblxuICAgIC8vIHdlIHdhaXQgd2l0aCBzdWJzY3JpYmluZyB0aWxsIHRoZXNlIHByb3BlcnRpZXMgYXJlIHNldCBvbiB0aGUgaG9zdCBlbGVtZW50XG4gICAgcHJvdGVjdGVkIGhhc3NTdWJzY3JpYmVSZXF1aXJlZEhvc3RQcm9wcz86IHN0cmluZ1tdO1xuXG4gICAgcHJpdmF0ZSBfX3Vuc3Vicz86IEFycmF5PFVuc3Vic2NyaWJlRnVuYyB8IFByb21pc2U8VW5zdWJzY3JpYmVGdW5jPj47XG5cbiAgICBwdWJsaWMgY29ubmVjdGVkQ2FsbGJhY2soKSB7XG4gICAgICBzdXBlci5jb25uZWN0ZWRDYWxsYmFjaygpO1xuICAgICAgdGhpcy5fX2NoZWNrU3Vic2NyaWJlZCgpO1xuICAgIH1cblxuICAgIHB1YmxpYyBkaXNjb25uZWN0ZWRDYWxsYmFjaygpIHtcbiAgICAgIHN1cGVyLmRpc2Nvbm5lY3RlZENhbGxiYWNrKCk7XG4gICAgICBpZiAodGhpcy5fX3Vuc3Vicykge1xuICAgICAgICB3aGlsZSAodGhpcy5fX3Vuc3Vicy5sZW5ndGgpIHtcbiAgICAgICAgICBjb25zdCB1bnN1YiA9IHRoaXMuX191bnN1YnMucG9wKCkhO1xuICAgICAgICAgIGlmICh1bnN1YiBpbnN0YW5jZW9mIFByb21pc2UpIHtcbiAgICAgICAgICAgIHVuc3ViLnRoZW4oKHVuc3ViRnVuYykgPT4gdW5zdWJGdW5jKCkpO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB1bnN1YigpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICB0aGlzLl9fdW5zdWJzID0gdW5kZWZpbmVkO1xuICAgICAgfVxuICAgIH1cblxuICAgIHByb3RlY3RlZCB1cGRhdGVkKGNoYW5nZWRQcm9wczogUHJvcGVydHlWYWx1ZXMpIHtcbiAgICAgIHN1cGVyLnVwZGF0ZWQoY2hhbmdlZFByb3BzKTtcbiAgICAgIGlmIChjaGFuZ2VkUHJvcHMuaGFzKFwiaGFzc1wiKSkge1xuICAgICAgICB0aGlzLl9fY2hlY2tTdWJzY3JpYmVkKCk7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIGlmICghdGhpcy5oYXNzU3Vic2NyaWJlUmVxdWlyZWRIb3N0UHJvcHMpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgZm9yIChjb25zdCBrZXkgb2YgY2hhbmdlZFByb3BzLmtleXMoKSkge1xuICAgICAgICBpZiAodGhpcy5oYXNzU3Vic2NyaWJlUmVxdWlyZWRIb3N0UHJvcHMuaW5jbHVkZXMoa2V5IGFzIHN0cmluZykpIHtcbiAgICAgICAgICB0aGlzLl9fY2hlY2tTdWJzY3JpYmVkKCk7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuXG4gICAgcHJvdGVjdGVkIGhhc3NTdWJzY3JpYmUoKTogQXJyYXk8XG4gICAgICBVbnN1YnNjcmliZUZ1bmMgfCBQcm9taXNlPFVuc3Vic2NyaWJlRnVuYz5cbiAgICA+IHtcbiAgICAgIHJldHVybiBbXTtcbiAgICB9XG5cbiAgICBwcml2YXRlIF9fY2hlY2tTdWJzY3JpYmVkKCk6IHZvaWQge1xuICAgICAgaWYgKFxuICAgICAgICB0aGlzLl9fdW5zdWJzICE9PSB1bmRlZmluZWQgfHxcbiAgICAgICAgISh0aGlzIGFzIHVua25vd24gYXMgRWxlbWVudCkuaXNDb25uZWN0ZWQgfHxcbiAgICAgICAgdGhpcy5oYXNzID09PSB1bmRlZmluZWQgfHxcbiAgICAgICAgdGhpcy5oYXNzU3Vic2NyaWJlUmVxdWlyZWRIb3N0UHJvcHM/LnNvbWUoXG4gICAgICAgICAgKHByb3ApID0+IHRoaXNbcHJvcF0gPT09IHVuZGVmaW5lZFxuICAgICAgICApXG4gICAgICApIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgdGhpcy5fX3Vuc3VicyA9IHRoaXMuaGFzc1N1YnNjcmliZSgpO1xuICAgIH1cbiAgfVxuICByZXR1cm4gU3Vic2NyaWJlQ2xhc3M7XG59O1xuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./src/mixins/subscribe-mixin.ts\n");

/***/ }),

/***/ "./src/panels/lovelace/cards/energy/hui-energy-usage-graph-card.ts":
/*!*************************************************************************!*\
  !*** ./src/panels/lovelace/cards/energy/hui-energy-usage-graph-card.ts ***!
  \*************************************************************************/
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   HuiEnergyUsageGraphCard: function() { return /* binding */ HuiEnergyUsageGraphCard; }\n/* harmony export */ });\n/* harmony import */ var _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @babel/runtime/helpers/slicedToArray */ \"./node_modules/@babel/runtime/helpers/esm/slicedToArray.js\");\n/* harmony import */ var _babel_runtime_helpers_regeneratorRuntime__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @babel/runtime/helpers/regeneratorRuntime */ \"./node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\");\n/* harmony import */ var _babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @babel/runtime/helpers/toConsumableArray */ \"./node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\");\n/* harmony import */ var _babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @babel/runtime/helpers/asyncToGenerator */ \"./node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\");\n/* harmony import */ var _babel_runtime_helpers_createForOfIteratorHelper__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @babel/runtime/helpers/createForOfIteratorHelper */ \"./node_modules/@babel/runtime/helpers/esm/createForOfIteratorHelper.js\");\n/* harmony import */ var _babel_runtime_helpers_taggedTemplateLiteral__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @babel/runtime/helpers/taggedTemplateLiteral */ \"./node_modules/@babel/runtime/helpers/esm/taggedTemplateLiteral.js\");\n/* harmony import */ var _babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! @babel/runtime/helpers/createClass */ \"./node_modules/@babel/runtime/helpers/esm/createClass.js\");\n/* harmony import */ var _babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! @babel/runtime/helpers/classCallCheck */ \"./node_modules/@babel/runtime/helpers/esm/classCallCheck.js\");\n/* harmony import */ var _babel_runtime_helpers_assertThisInitialized__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! @babel/runtime/helpers/assertThisInitialized */ \"./node_modules/@babel/runtime/helpers/esm/assertThisInitialized.js\");\n/* harmony import */ var _babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! @babel/runtime/helpers/inherits */ \"./node_modules/@babel/runtime/helpers/esm/inherits.js\");\n/* harmony import */ var _babel_runtime_helpers_createSuper__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! @babel/runtime/helpers/createSuper */ \"./node_modules/@babel/runtime/helpers/esm/createSuper.js\");\n/* harmony import */ var _babel_runtime_helpers_decorate__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! @babel/runtime/helpers/decorate */ \"./node_modules/@babel/runtime/helpers/esm/decorate.js\");\n/* harmony import */ var date_fns_esm__WEBPACK_IMPORTED_MODULE_25__ = __webpack_require__(/*! date-fns/esm */ \"./node_modules/date-fns/esm/startOfToday/index.js\");\n/* harmony import */ var date_fns_esm__WEBPACK_IMPORTED_MODULE_26__ = __webpack_require__(/*! date-fns/esm */ \"./node_modules/date-fns/esm/endOfToday/index.js\");\n/* harmony import */ var date_fns_esm__WEBPACK_IMPORTED_MODULE_27__ = __webpack_require__(/*! date-fns/esm */ \"./node_modules/date-fns/esm/isToday/index.js\");\n/* harmony import */ var date_fns_esm__WEBPACK_IMPORTED_MODULE_29__ = __webpack_require__(/*! date-fns/esm */ \"./node_modules/date-fns/esm/differenceInDays/index.js\");\n/* harmony import */ var date_fns_esm__WEBPACK_IMPORTED_MODULE_30__ = __webpack_require__(/*! date-fns/esm */ \"./node_modules/date-fns/esm/differenceInHours/index.js\");\n/* harmony import */ var date_fns_esm__WEBPACK_IMPORTED_MODULE_31__ = __webpack_require__(/*! date-fns/esm */ \"./node_modules/date-fns/esm/addHours/index.js\");\n/* harmony import */ var lit__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! lit */ \"./node_modules/lit/index.js\");\n/* harmony import */ var lit_decorators__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! lit/decorators */ \"./node_modules/lit/decorators.js\");\n/* harmony import */ var lit_directives_class_map__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! lit/directives/class-map */ \"./node_modules/lit/directives/class-map.js\");\n/* harmony import */ var memoize_one__WEBPACK_IMPORTED_MODULE_28__ = __webpack_require__(/*! memoize-one */ \"./node_modules/memoize-one/dist/memoize-one.esm.js\");\n/* harmony import */ var _common_color_convert_color__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ../../../../common/color/convert-color */ \"./src/common/color/convert-color.ts\");\n/* harmony import */ var _common_color_lab__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ../../../../common/color/lab */ \"./src/common/color/lab.ts\");\n/* harmony import */ var _common_datetime_format_date__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! ../../../../common/datetime/format_date */ \"./src/common/datetime/format_date.ts\");\n/* harmony import */ var _common_datetime_format_time__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! ../../../../common/datetime/format_time */ \"./src/common/datetime/format_time.ts\");\n/* harmony import */ var _common_number_format_number__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(/*! ../../../../common/number/format_number */ \"./src/common/number/format_number.ts\");\n/* harmony import */ var _components_chart_ha_chart_base__WEBPACK_IMPORTED_MODULE_20__ = __webpack_require__(/*! ../../../../components/chart/ha-chart-base */ \"./src/components/chart/ha-chart-base.ts\");\n/* harmony import */ var _components_ha_card__WEBPACK_IMPORTED_MODULE_21__ = __webpack_require__(/*! ../../../../components/ha-card */ \"./src/components/ha-card.ts\");\n/* harmony import */ var _data_energy__WEBPACK_IMPORTED_MODULE_22__ = __webpack_require__(/*! ../../../../data/energy */ \"./src/data/energy.ts\");\n/* harmony import */ var _data_recorder__WEBPACK_IMPORTED_MODULE_23__ = __webpack_require__(/*! ../../../../data/recorder */ \"./src/data/recorder.ts\");\n/* harmony import */ var _mixins_subscribe_mixin__WEBPACK_IMPORTED_MODULE_24__ = __webpack_require__(/*! ../../../../mixins/subscribe-mixin */ \"./src/mixins/subscribe-mixin.ts\");\n\n\n\n\n\n\n\n\n\n\n\n\nvar _templateObject, _templateObject2, _templateObject3, _templateObject4;\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nvar HuiEnergyUsageGraphCard = (0,_babel_runtime_helpers_decorate__WEBPACK_IMPORTED_MODULE_11__[\"default\"])([(0,lit_decorators__WEBPACK_IMPORTED_MODULE_13__.customElement)(\"hui-energy-usage-graph-card\")], function (_initialize, _SubscribeMixin) {\n  var HuiEnergyUsageGraphCard = /*#__PURE__*/function (_SubscribeMixin2) {\n    (0,_babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_9__[\"default\"])(HuiEnergyUsageGraphCard, _SubscribeMixin2);\n    var _super = (0,_babel_runtime_helpers_createSuper__WEBPACK_IMPORTED_MODULE_10__[\"default\"])(HuiEnergyUsageGraphCard);\n    function HuiEnergyUsageGraphCard() {\n      var _this;\n      (0,_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_7__[\"default\"])(this, HuiEnergyUsageGraphCard);\n      for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n        args[_key] = arguments[_key];\n      }\n      _this = _super.call.apply(_super, [this].concat(args));\n      _initialize((0,_babel_runtime_helpers_assertThisInitialized__WEBPACK_IMPORTED_MODULE_8__[\"default\"])(_this));\n      return _this;\n    }\n    return (0,_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_6__[\"default\"])(HuiEnergyUsageGraphCard);\n  }(_SubscribeMixin);\n  return {\n    F: HuiEnergyUsageGraphCard,\n    d: [{\n      kind: \"field\",\n      decorators: [(0,lit_decorators__WEBPACK_IMPORTED_MODULE_13__.property)({\n        attribute: false\n      })],\n      key: \"hass\",\n      value: void 0\n    }, {\n      kind: \"field\",\n      decorators: [(0,lit_decorators__WEBPACK_IMPORTED_MODULE_13__.state)()],\n      key: \"_config\",\n      value: void 0\n    }, {\n      kind: \"field\",\n      decorators: [(0,lit_decorators__WEBPACK_IMPORTED_MODULE_13__.state)()],\n      key: \"_chartData\",\n      value: function value() {\n        return {\n          datasets: []\n        };\n      }\n    }, {\n      kind: \"field\",\n      decorators: [(0,lit_decorators__WEBPACK_IMPORTED_MODULE_13__.state)()],\n      key: \"_start\",\n      value: function value() {\n        return (0,date_fns_esm__WEBPACK_IMPORTED_MODULE_25__[\"default\"])();\n      }\n    }, {\n      kind: \"field\",\n      decorators: [(0,lit_decorators__WEBPACK_IMPORTED_MODULE_13__.state)()],\n      key: \"_end\",\n      value: function value() {\n        return (0,date_fns_esm__WEBPACK_IMPORTED_MODULE_26__[\"default\"])();\n      }\n    }, {\n      kind: \"field\",\n      decorators: [(0,lit_decorators__WEBPACK_IMPORTED_MODULE_13__.state)()],\n      key: \"_compareStart\",\n      value: void 0\n    }, {\n      kind: \"field\",\n      decorators: [(0,lit_decorators__WEBPACK_IMPORTED_MODULE_13__.state)()],\n      key: \"_compareEnd\",\n      value: void 0\n    }, {\n      kind: \"field\",\n      key: \"hassSubscribeRequiredHostProps\",\n      value: function value() {\n        return [\"_config\"];\n      }\n    }, {\n      kind: \"method\",\n      key: \"hassSubscribe\",\n      value: function hassSubscribe() {\n        var _this$_config,\n          _this2 = this;\n        return [(0,_data_energy__WEBPACK_IMPORTED_MODULE_22__.getEnergyDataCollection)(this.hass, {\n          key: (_this$_config = this._config) === null || _this$_config === void 0 ? void 0 : _this$_config.collection_key\n        }).subscribe(function (data) {\n          return _this2._getStatistics(data);\n        })];\n      }\n    }, {\n      kind: \"method\",\n      key: \"getCardSize\",\n      value: function getCardSize() {\n        return 3;\n      }\n    }, {\n      kind: \"method\",\n      key: \"setConfig\",\n      value: function setConfig(config) {\n        this._config = config;\n      }\n    }, {\n      kind: \"method\",\n      key: \"render\",\n      value: function render() {\n        if (!this.hass || !this._config) {\n          return lit__WEBPACK_IMPORTED_MODULE_12__.nothing;\n        }\n        return (0,lit__WEBPACK_IMPORTED_MODULE_12__.html)(_templateObject || (_templateObject = (0,_babel_runtime_helpers_taggedTemplateLiteral__WEBPACK_IMPORTED_MODULE_5__[\"default\"])([\"\\n      <ha-card>\\n        \", \"\\n        <div\\n          class=\\\"content \", \"\\\"\\n        >\\n          <ha-chart-base\\n            .hass=\", \"\\n            .data=\", \"\\n            .options=\", \"\\n            chart-type=\\\"bar\\\"\\n          ></ha-chart-base>\\n          \", \"\\n        </div>\\n      </ha-card>\\n    \"])), this._config.title ? (0,lit__WEBPACK_IMPORTED_MODULE_12__.html)(_templateObject2 || (_templateObject2 = (0,_babel_runtime_helpers_taggedTemplateLiteral__WEBPACK_IMPORTED_MODULE_5__[\"default\"])([\"<h1 class=\\\"card-header\\\">\", \"</h1>\"])), this._config.title) : \"\", (0,lit_directives_class_map__WEBPACK_IMPORTED_MODULE_14__.classMap)({\n          \"has-header\": !!this._config.title\n        }), this.hass, this._chartData, this._createOptions(this._start, this._end, this.hass.locale, this._compareStart, this._compareEnd), !this._chartData.datasets.some(function (dataset) {\n          return dataset.data.length;\n        }) ? (0,lit__WEBPACK_IMPORTED_MODULE_12__.html)(_templateObject3 || (_templateObject3 = (0,_babel_runtime_helpers_taggedTemplateLiteral__WEBPACK_IMPORTED_MODULE_5__[\"default\"])([\"<div class=\\\"no-data\\\">\\n                \", \"\\n              </div>\"])), (0,date_fns_esm__WEBPACK_IMPORTED_MODULE_27__[\"default\"])(this._start) ? this.hass.localize(\"ui.panel.lovelace.cards.energy.no_data\") : this.hass.localize(\"ui.panel.lovelace.cards.energy.no_data_period\")) : \"\");\n      }\n    }, {\n      kind: \"field\",\n      key: \"_createOptions\",\n      value: function value() {\n        var _this3 = this;\n        return (0,memoize_one__WEBPACK_IMPORTED_MODULE_28__[\"default\"])(function (start, end, locale, compareStart, compareEnd) {\n          var dayDifference = (0,date_fns_esm__WEBPACK_IMPORTED_MODULE_29__[\"default\"])(end, start);\n          var compare = compareStart !== undefined && compareEnd !== undefined;\n          if (compare) {\n            var difference = (0,date_fns_esm__WEBPACK_IMPORTED_MODULE_30__[\"default\"])(end, start);\n            var differenceCompare = (0,date_fns_esm__WEBPACK_IMPORTED_MODULE_30__[\"default\"])(compareEnd, compareStart);\n            // If the compare period doesn't match the main period, adjust them to match\n            if (differenceCompare > difference) {\n              end = (0,date_fns_esm__WEBPACK_IMPORTED_MODULE_31__[\"default\"])(end, differenceCompare - difference);\n            } else if (difference > differenceCompare) {\n              compareEnd = (0,date_fns_esm__WEBPACK_IMPORTED_MODULE_31__[\"default\"])(compareEnd, difference - differenceCompare);\n            }\n          }\n          var options = {\n            parsing: false,\n            animation: false,\n            interaction: {\n              mode: \"x\"\n            },\n            scales: {\n              x: {\n                type: \"time\",\n                suggestedMin: start.getTime(),\n                suggestedMax: end.getTime(),\n                adapters: {\n                  date: {\n                    locale: locale\n                  }\n                },\n                ticks: {\n                  maxRotation: 0,\n                  sampleSize: 5,\n                  autoSkipPadding: 20,\n                  font: function font(context) {\n                    return context.tick && context.tick.major ? {\n                      weight: \"bold\"\n                    } : {};\n                  }\n                },\n                time: {\n                  tooltipFormat: dayDifference > 35 ? \"monthyear\" : dayDifference > 7 ? \"date\" : dayDifference > 2 ? \"weekday\" : dayDifference > 0 ? \"datetime\" : \"hour\",\n                  minUnit: dayDifference > 35 ? \"month\" : dayDifference > 2 ? \"day\" : \"hour\"\n                }\n              },\n              y: {\n                stacked: true,\n                type: \"linear\",\n                title: {\n                  display: true,\n                  text: \"kWh\"\n                },\n                ticks: {\n                  beginAtZero: true,\n                  callback: function callback(value) {\n                    return (0,_common_number_format_number__WEBPACK_IMPORTED_MODULE_19__.formatNumber)(Math.abs(value), locale);\n                  }\n                }\n              }\n            },\n            plugins: {\n              tooltip: {\n                position: \"nearest\",\n                filter: function filter(val) {\n                  return val.formattedValue !== \"0\";\n                },\n                callbacks: {\n                  title: function title(datasets) {\n                    if (dayDifference > 0) {\n                      return datasets[0].label;\n                    }\n                    var date = new Date(datasets[0].parsed.x);\n                    return \"\".concat(compare ? \"\".concat((0,_common_datetime_format_date__WEBPACK_IMPORTED_MODULE_17__.formatDateShort)(date, locale), \": \") : \"\").concat((0,_common_datetime_format_time__WEBPACK_IMPORTED_MODULE_18__.formatTime)(date, locale), \" \\u2013 \").concat((0,_common_datetime_format_time__WEBPACK_IMPORTED_MODULE_18__.formatTime)((0,date_fns_esm__WEBPACK_IMPORTED_MODULE_31__[\"default\"])(date, 1), locale));\n                  },\n                  label: function label(context) {\n                    return \"\".concat(context.dataset.label, \": \").concat((0,_common_number_format_number__WEBPACK_IMPORTED_MODULE_19__.formatNumber)(Math.abs(context.parsed.y), locale), \" kWh\");\n                  },\n                  footer: function footer(contexts) {\n                    var totalConsumed = 0;\n                    var totalReturned = 0;\n                    var _iterator = (0,_babel_runtime_helpers_createForOfIteratorHelper__WEBPACK_IMPORTED_MODULE_4__[\"default\"])(contexts),\n                      _step;\n                    try {\n                      for (_iterator.s(); !(_step = _iterator.n()).done;) {\n                        var context = _step.value;\n                        var value = context.dataset.data[context.dataIndex].y;\n                        if (value > 0) {\n                          totalConsumed += value;\n                        } else {\n                          totalReturned += Math.abs(value);\n                        }\n                      }\n                    } catch (err) {\n                      _iterator.e(err);\n                    } finally {\n                      _iterator.f();\n                    }\n                    return [totalConsumed ? _this3.hass.localize(\"ui.panel.lovelace.cards.energy.energy_usage_graph.total_consumed\", {\n                      num: (0,_common_number_format_number__WEBPACK_IMPORTED_MODULE_19__.formatNumber)(totalConsumed, locale)\n                    }) : \"\", totalReturned ? _this3.hass.localize(\"ui.panel.lovelace.cards.energy.energy_usage_graph.total_returned\", {\n                      num: (0,_common_number_format_number__WEBPACK_IMPORTED_MODULE_19__.formatNumber)(totalReturned, locale)\n                    }) : \"\"].filter(Boolean);\n                  }\n                }\n              },\n              filler: {\n                propagate: false\n              },\n              legend: {\n                display: false,\n                labels: {\n                  usePointStyle: true\n                }\n              }\n            },\n            elements: {\n              bar: {\n                borderWidth: 1.5,\n                borderRadius: 4\n              },\n              point: {\n                hitRadius: 50\n              }\n            },\n            // @ts-expect-error\n            locale: (0,_common_number_format_number__WEBPACK_IMPORTED_MODULE_19__.numberFormatToLocale)(locale)\n          };\n          if (compare) {\n            options.scales.xAxisCompare = Object.assign(Object.assign({}, options.scales.x), {}, {\n              suggestedMin: compareStart.getTime(),\n              suggestedMax: compareEnd.getTime(),\n              display: false\n            });\n          }\n          return options;\n        });\n      }\n    }, {\n      kind: \"method\",\n      key: \"_getStatistics\",\n      value: function () {\n        var _getStatistics2 = (0,_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_3__[\"default\"])( /*#__PURE__*/(0,_babel_runtime_helpers_regeneratorRuntime__WEBPACK_IMPORTED_MODULE_1__[\"default\"])().mark(function _callee(energyData) {\n          var datasets, statIds, _iterator2, _step2, source, _iterator3, _step3, flowFrom, _iterator4, _step4, flowTo, computedStyles, colors, labels;\n          return (0,_babel_runtime_helpers_regeneratorRuntime__WEBPACK_IMPORTED_MODULE_1__[\"default\"])().wrap(function _callee$(_context) {\n            while (1) switch (_context.prev = _context.next) {\n              case 0:\n                datasets = [];\n                statIds = {};\n                _iterator2 = (0,_babel_runtime_helpers_createForOfIteratorHelper__WEBPACK_IMPORTED_MODULE_4__[\"default\"])(energyData.prefs.energy_sources);\n                _context.prev = 3;\n                _iterator2.s();\n              case 5:\n                if ((_step2 = _iterator2.n()).done) {\n                  _context.next = 21;\n                  break;\n                }\n                source = _step2.value;\n                if (!(source.type === \"solar\")) {\n                  _context.next = 10;\n                  break;\n                }\n                if (statIds.solar) {\n                  statIds.solar.push(source.stat_energy_from);\n                } else {\n                  statIds.solar = [source.stat_energy_from];\n                }\n                return _context.abrupt(\"continue\", 19);\n              case 10:\n                if (!(source.type === \"battery\")) {\n                  _context.next = 13;\n                  break;\n                }\n                if (statIds.to_battery) {\n                  statIds.to_battery.push(source.stat_energy_to);\n                  statIds.from_battery.push(source.stat_energy_from);\n                } else {\n                  statIds.to_battery = [source.stat_energy_to];\n                  statIds.from_battery = [source.stat_energy_from];\n                }\n                return _context.abrupt(\"continue\", 19);\n              case 13:\n                if (!(source.type !== \"grid\")) {\n                  _context.next = 15;\n                  break;\n                }\n                return _context.abrupt(\"continue\", 19);\n              case 15:\n                // grid source\n                _iterator3 = (0,_babel_runtime_helpers_createForOfIteratorHelper__WEBPACK_IMPORTED_MODULE_4__[\"default\"])(source.flow_from);\n                try {\n                  for (_iterator3.s(); !(_step3 = _iterator3.n()).done;) {\n                    flowFrom = _step3.value;\n                    if (statIds.from_grid) {\n                      statIds.from_grid.push(flowFrom.stat_energy_from);\n                    } else {\n                      statIds.from_grid = [flowFrom.stat_energy_from];\n                    }\n                  }\n                } catch (err) {\n                  _iterator3.e(err);\n                } finally {\n                  _iterator3.f();\n                }\n                _iterator4 = (0,_babel_runtime_helpers_createForOfIteratorHelper__WEBPACK_IMPORTED_MODULE_4__[\"default\"])(source.flow_to);\n                try {\n                  for (_iterator4.s(); !(_step4 = _iterator4.n()).done;) {\n                    flowTo = _step4.value;\n                    if (statIds.to_grid) {\n                      statIds.to_grid.push(flowTo.stat_energy_to);\n                    } else {\n                      statIds.to_grid = [flowTo.stat_energy_to];\n                    }\n                  }\n                } catch (err) {\n                  _iterator4.e(err);\n                } finally {\n                  _iterator4.f();\n                }\n              case 19:\n                _context.next = 5;\n                break;\n              case 21:\n                _context.next = 26;\n                break;\n              case 23:\n                _context.prev = 23;\n                _context.t0 = _context[\"catch\"](3);\n                _iterator2.e(_context.t0);\n              case 26:\n                _context.prev = 26;\n                _iterator2.f();\n                return _context.finish(26);\n              case 29:\n                computedStyles = getComputedStyle(this);\n                colors = {\n                  to_grid: computedStyles.getPropertyValue(\"--energy-grid-return-color\").trim(),\n                  to_battery: computedStyles.getPropertyValue(\"--energy-battery-in-color\").trim(),\n                  from_grid: computedStyles.getPropertyValue(\"--energy-grid-consumption-color\").trim(),\n                  used_grid: computedStyles.getPropertyValue(\"--energy-grid-consumption-color\").trim(),\n                  used_solar: computedStyles.getPropertyValue(\"--energy-solar-color\").trim(),\n                  used_battery: computedStyles.getPropertyValue(\"--energy-battery-out-color\").trim()\n                };\n                labels = {\n                  used_grid: this.hass.localize(\"ui.panel.lovelace.cards.energy.energy_usage_graph.combined_from_grid\"),\n                  used_solar: this.hass.localize(\"ui.panel.lovelace.cards.energy.energy_usage_graph.consumed_solar\"),\n                  used_battery: this.hass.localize(\"ui.panel.lovelace.cards.energy.energy_usage_graph.consumed_battery\")\n                };\n                this._start = energyData.start;\n                this._end = energyData.end || (0,date_fns_esm__WEBPACK_IMPORTED_MODULE_26__[\"default\"])();\n                this._compareStart = energyData.startCompare;\n                this._compareEnd = energyData.endCompare;\n                datasets.push.apply(datasets, (0,_babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_2__[\"default\"])(this._processDataSet(energyData.stats, energyData.statsMetadata, statIds, colors, labels, false)));\n                if (energyData.statsCompare) {\n                  // Add empty dataset to align the bars\n                  datasets.push({\n                    order: 0,\n                    data: []\n                  });\n                  datasets.push({\n                    order: 999,\n                    data: [],\n                    xAxisID: \"xAxisCompare\"\n                  });\n                  datasets.push.apply(datasets, (0,_babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_2__[\"default\"])(this._processDataSet(energyData.statsCompare, energyData.statsMetadata, statIds, colors, labels, true)));\n                }\n                this._chartData = {\n                  datasets: datasets\n                };\n              case 39:\n              case \"end\":\n                return _context.stop();\n            }\n          }, _callee, this, [[3, 23, 26, 29]]);\n        }));\n        function _getStatistics(_x) {\n          return _getStatistics2.apply(this, arguments);\n        }\n        return _getStatistics;\n      }()\n    }, {\n      kind: \"method\",\n      key: \"_processDataSet\",\n      value: function _processDataSet(statistics, statisticsMetaData, statIdsByCat, colors, labels) {\n        var _this4 = this;\n        var compare = arguments.length > 5 && arguments[5] !== undefined ? arguments[5] : false;\n        var data = [];\n        var combinedData = {};\n        var summedData = {};\n        Object.entries(statIdsByCat).forEach(function (_ref) {\n          var _ref2 = (0,_babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0__[\"default\"])(_ref, 2),\n            key = _ref2[0],\n            statIds = _ref2[1];\n          var sum = [\"solar\", \"to_grid\", \"from_grid\", \"to_battery\", \"from_battery\"].includes(key);\n          var add = ![\"solar\", \"from_battery\"].includes(key);\n          var totalStats = {};\n          var sets = {};\n          statIds.forEach(function (id) {\n            var stats = statistics[id];\n            if (!stats) {\n              return;\n            }\n            var set = {};\n            stats.forEach(function (stat) {\n              if (stat.change === null || stat.change === undefined) {\n                return;\n              }\n              var val = stat.change;\n              // Get total of solar and to grid to calculate the solar energy used\n              if (sum) {\n                totalStats[stat.start] = stat.start in totalStats ? totalStats[stat.start] + val : val;\n              }\n              if (add && !(stat.start in set)) {\n                set[stat.start] = val;\n              }\n            });\n            sets[id] = set;\n          });\n          if (sum) {\n            summedData[key] = totalStats;\n          }\n          if (add) {\n            combinedData[key] = sets;\n          }\n        });\n        var grid_to_battery = {};\n        var battery_to_grid = {};\n        if ((summedData.to_grid || summedData.to_battery) && summedData.solar) {\n          var used_solar = {};\n          for (var _i = 0, _Object$keys = Object.keys(summedData.solar); _i < _Object$keys.length; _i++) {\n            var _summedData$to_grid, _summedData$to_batter;\n            var _start = _Object$keys[_i];\n            used_solar[_start] = (summedData.solar[_start] || 0) - (((_summedData$to_grid = summedData.to_grid) === null || _summedData$to_grid === void 0 ? void 0 : _summedData$to_grid[_start]) || 0) - (((_summedData$to_batter = summedData.to_battery) === null || _summedData$to_batter === void 0 ? void 0 : _summedData$to_batter[_start]) || 0);\n            if (used_solar[_start] < 0) {\n              if (summedData.to_battery) {\n                var _summedData$from_grid;\n                grid_to_battery[_start] = used_solar[_start] * -1;\n                if (grid_to_battery[_start] > (((_summedData$from_grid = summedData.from_grid) === null || _summedData$from_grid === void 0 ? void 0 : _summedData$from_grid[_start]) || 0)) {\n                  var _summedData$from_grid2, _summedData$from_grid3;\n                  battery_to_grid[_start] = Math.min(0, grid_to_battery[_start] - (((_summedData$from_grid2 = summedData.from_grid) === null || _summedData$from_grid2 === void 0 ? void 0 : _summedData$from_grid2[_start]) || 0));\n                  grid_to_battery[_start] = (_summedData$from_grid3 = summedData.from_grid) === null || _summedData$from_grid3 === void 0 ? void 0 : _summedData$from_grid3[_start];\n                }\n              }\n              used_solar[_start] = 0;\n            }\n          }\n          combinedData.used_solar = {\n            used_solar: used_solar\n          };\n        }\n        if (summedData.from_battery) {\n          if (summedData.to_grid) {\n            var used_battery = {};\n            for (var _i2 = 0, _Object$keys2 = Object.keys(summedData.from_battery); _i2 < _Object$keys2.length; _i2++) {\n              var _start2 = _Object$keys2[_i2];\n              used_battery[_start2] = (summedData.from_battery[_start2] || 0) - (battery_to_grid[_start2] || 0);\n            }\n            combinedData.used_battery = {\n              used_battery: used_battery\n            };\n          } else {\n            combinedData.used_battery = {\n              used_battery: summedData.from_battery\n            };\n          }\n        }\n        if (combinedData.from_grid && summedData.to_battery) {\n          var used_grid = {};\n          var _loop = function _loop() {\n            var start = _Object$keys3[_i3];\n            var noOfSources = 0;\n            var source;\n            for (var _i4 = 0, _Object$entries = Object.entries(combinedData.from_grid); _i4 < _Object$entries.length; _i4++) {\n              var _Object$entries$_i = (0,_babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0__[\"default\"])(_Object$entries[_i4], 2),\n                key = _Object$entries$_i[0],\n                stats = _Object$entries$_i[1];\n              if (stats[start]) {\n                source = key;\n                noOfSources++;\n              }\n              if (noOfSources > 1) {\n                break;\n              }\n            }\n            if (noOfSources === 1) {\n              combinedData.from_grid[source][start] -= grid_to_battery[start] || 0;\n            } else {\n              var total_from_grid = 0;\n              Object.values(combinedData.from_grid).forEach(function (stats) {\n                total_from_grid += stats[start] || 0;\n                delete stats[start];\n              });\n              used_grid[start] = total_from_grid - (grid_to_battery[start] || 0);\n            }\n          };\n          for (var _i3 = 0, _Object$keys3 = Object.keys(grid_to_battery); _i3 < _Object$keys3.length; _i3++) {\n            _loop();\n          }\n          combinedData.used_grid = {\n            used_grid: used_grid\n          };\n        }\n        var allKeys = [];\n        Object.values(combinedData).forEach(function (sources) {\n          Object.values(sources).forEach(function (source) {\n            allKeys = allKeys.concat(Object.keys(source));\n          });\n        });\n        var uniqueKeys = Array.from(new Set(allKeys));\n        Object.entries(combinedData).forEach(function (_ref3) {\n          var _ref4 = (0,_babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0__[\"default\"])(_ref3, 2),\n            type = _ref4[0],\n            sources = _ref4[1];\n          Object.entries(sources).forEach(function (_ref5, idx) {\n            var _ref6 = (0,_babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0__[\"default\"])(_ref5, 2),\n              statId = _ref6[0],\n              source = _ref6[1];\n            var modifiedColor = idx > 0 ? _this4.hass.themes.darkMode ? (0,_common_color_lab__WEBPACK_IMPORTED_MODULE_16__.labBrighten)((0,_common_color_convert_color__WEBPACK_IMPORTED_MODULE_15__.rgb2lab)((0,_common_color_convert_color__WEBPACK_IMPORTED_MODULE_15__.hex2rgb)(colors[type])), idx) : (0,_common_color_lab__WEBPACK_IMPORTED_MODULE_16__.labDarken)((0,_common_color_convert_color__WEBPACK_IMPORTED_MODULE_15__.rgb2lab)((0,_common_color_convert_color__WEBPACK_IMPORTED_MODULE_15__.hex2rgb)(colors[type])), idx) : undefined;\n            var borderColor = modifiedColor ? (0,_common_color_convert_color__WEBPACK_IMPORTED_MODULE_15__.rgb2hex)((0,_common_color_convert_color__WEBPACK_IMPORTED_MODULE_15__.lab2rgb)(modifiedColor)) : colors[type];\n            var points = [];\n            // Process chart data.\n            for (var _i5 = 0, _uniqueKeys = uniqueKeys; _i5 < _uniqueKeys.length; _i5++) {\n              var key = _uniqueKeys[_i5];\n              var value = source[key] || 0;\n              points.push({\n                x: Number(key),\n                y: value && [\"to_grid\", \"to_battery\"].includes(type) ? -1 * value : value\n              });\n            }\n            data.push({\n              label: type in labels ? labels[type] : (0,_data_recorder__WEBPACK_IMPORTED_MODULE_23__.getStatisticLabel)(_this4.hass, statId, statisticsMetaData[statId]),\n              order: type === \"used_solar\" ? 1 : type === \"to_battery\" ? Object.keys(combinedData).length : idx + 2,\n              borderColor: compare ? borderColor + \"7F\" : borderColor,\n              backgroundColor: compare ? borderColor + \"32\" : borderColor + \"7F\",\n              stack: \"stack\",\n              data: points,\n              xAxisID: compare ? \"xAxisCompare\" : undefined\n            });\n          });\n        });\n        return data;\n      }\n    }, {\n      kind: \"get\",\n      static: true,\n      key: \"styles\",\n      value: function styles() {\n        return (0,lit__WEBPACK_IMPORTED_MODULE_12__.css)(_templateObject4 || (_templateObject4 = (0,_babel_runtime_helpers_taggedTemplateLiteral__WEBPACK_IMPORTED_MODULE_5__[\"default\"])([\"\\n      ha-card {\\n        height: 100%;\\n      }\\n      .card-header {\\n        padding-bottom: 0;\\n      }\\n      .content {\\n        padding: 16px;\\n      }\\n      .has-header {\\n        padding-top: 0;\\n      }\\n      .no-data {\\n        position: absolute;\\n        height: 100%;\\n        top: 0;\\n        left: 0;\\n        right: 0;\\n        display: flex;\\n        justify-content: center;\\n        align-items: center;\\n        padding: 20%;\\n        margin-left: 32px;\\n        box-sizing: border-box;\\n      }\\n    \"])));\n      }\n    }]\n  };\n}, (0,_mixins_subscribe_mixin__WEBPACK_IMPORTED_MODULE_24__.SubscribeMixin)(lit__WEBPACK_IMPORTED_MODULE_12__.LitElement));//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvcGFuZWxzL2xvdmVsYWNlL2NhcmRzL2VuZXJneS9odWktZW5lcmd5LXVzYWdlLWdyYXBoLWNhcmQudHMuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQU1BO0FBU0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQU1BO0FBQ0E7QUFDQTtBQUNBO0FBSUE7QUFDQTtBQUNBO0FBQ0E7QUFNQTtBQUtBO0FBQUE7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUlBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBRUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUVBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUVBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBRUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFFQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBRUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFFQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBRUE7QUFBQTtBQUNBO0FBRUE7QUFDQTtBQUFBO0FBQUE7QUFFQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBR0E7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBR0E7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBR0E7QUFDQTtBQUNBO0FBRUE7QUFPQTtBQUNBO0FBY0E7QUFBQTtBQVlBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBVUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFFQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFVQTtBQU1BO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQU1BO0FBQ0E7QUFBQTtBQUlBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBSUE7QUFBQTtBQU1BO0FBQUE7QUFJQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFBQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUVBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFFQTtBQU1BO0FBRUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUlBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBSUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUlBO0FBQUE7QUFDQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBR0E7QUFDQTtBQUNBO0FBR0E7QUFHQTtBQUdBO0FBR0E7QUFHQTtBQUdBO0FBQ0E7QUFDQTtBQUdBO0FBR0E7QUFHQTtBQUVBO0FBQ0E7QUFFQTtBQUNBO0FBRUE7QUFXQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFVQTtBQUVBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQTBCQTtBQUFBO0FBQ0E7QUFFQTtBQVNBO0FBUUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQU9BO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFDQTtBQUlBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBSUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFHQTtBQUNBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUF0QkE7QUFBQTtBQUFBO0FBdUJBO0FBQUE7QUFBQTtBQUNBO0FBRUE7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFFQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFNQTtBQUlBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFJQTtBQUNBO0FBRUE7QUFDQTtBQVFBO0FBTUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBR0E7QUEyQkE7QUFBQTtBQUFBO0FBQUEiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9ob21lLWFzc2lzdGFudC1mcm9udGVuZC8uL3NyYy9wYW5lbHMvbG92ZWxhY2UvY2FyZHMvZW5lcmd5L2h1aS1lbmVyZ3ktdXNhZ2UtZ3JhcGgtY2FyZC50cz9hMDM5Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7XG4gIENoYXJ0RGF0YSxcbiAgQ2hhcnREYXRhc2V0LFxuICBDaGFydE9wdGlvbnMsXG4gIFNjYXR0ZXJEYXRhUG9pbnQsXG59IGZyb20gXCJjaGFydC5qc1wiO1xuaW1wb3J0IHtcbiAgYWRkSG91cnMsXG4gIGRpZmZlcmVuY2VJbkRheXMsXG4gIGRpZmZlcmVuY2VJbkhvdXJzLFxuICBlbmRPZlRvZGF5LFxuICBpc1RvZGF5LFxuICBzdGFydE9mVG9kYXksXG59IGZyb20gXCJkYXRlLWZucy9lc21cIjtcbmltcG9ydCB7IFVuc3Vic2NyaWJlRnVuYyB9IGZyb20gXCJob21lLWFzc2lzdGFudC1qcy13ZWJzb2NrZXRcIjtcbmltcG9ydCB7IGNzcywgQ1NTUmVzdWx0R3JvdXAsIGh0bWwsIExpdEVsZW1lbnQsIG5vdGhpbmcgfSBmcm9tIFwibGl0XCI7XG5pbXBvcnQgeyBjdXN0b21FbGVtZW50LCBwcm9wZXJ0eSwgc3RhdGUgfSBmcm9tIFwibGl0L2RlY29yYXRvcnNcIjtcbmltcG9ydCB7IGNsYXNzTWFwIH0gZnJvbSBcImxpdC9kaXJlY3RpdmVzL2NsYXNzLW1hcFwiO1xuaW1wb3J0IG1lbW9pemVPbmUgZnJvbSBcIm1lbW9pemUtb25lXCI7XG5pbXBvcnQge1xuICBoZXgycmdiLFxuICBsYWIycmdiLFxuICByZ2IyaGV4LFxuICByZ2IybGFiLFxufSBmcm9tIFwiLi4vLi4vLi4vLi4vY29tbW9uL2NvbG9yL2NvbnZlcnQtY29sb3JcIjtcbmltcG9ydCB7IGxhYkJyaWdodGVuLCBsYWJEYXJrZW4gfSBmcm9tIFwiLi4vLi4vLi4vLi4vY29tbW9uL2NvbG9yL2xhYlwiO1xuaW1wb3J0IHsgZm9ybWF0RGF0ZVNob3J0IH0gZnJvbSBcIi4uLy4uLy4uLy4uL2NvbW1vbi9kYXRldGltZS9mb3JtYXRfZGF0ZVwiO1xuaW1wb3J0IHsgZm9ybWF0VGltZSB9IGZyb20gXCIuLi8uLi8uLi8uLi9jb21tb24vZGF0ZXRpbWUvZm9ybWF0X3RpbWVcIjtcbmltcG9ydCB7XG4gIGZvcm1hdE51bWJlcixcbiAgbnVtYmVyRm9ybWF0VG9Mb2NhbGUsXG59IGZyb20gXCIuLi8uLi8uLi8uLi9jb21tb24vbnVtYmVyL2Zvcm1hdF9udW1iZXJcIjtcbmltcG9ydCBcIi4uLy4uLy4uLy4uL2NvbXBvbmVudHMvY2hhcnQvaGEtY2hhcnQtYmFzZVwiO1xuaW1wb3J0IFwiLi4vLi4vLi4vLi4vY29tcG9uZW50cy9oYS1jYXJkXCI7XG5pbXBvcnQgeyBFbmVyZ3lEYXRhLCBnZXRFbmVyZ3lEYXRhQ29sbGVjdGlvbiB9IGZyb20gXCIuLi8uLi8uLi8uLi9kYXRhL2VuZXJneVwiO1xuaW1wb3J0IHtcbiAgZ2V0U3RhdGlzdGljTGFiZWwsXG4gIFN0YXRpc3RpY3MsXG4gIFN0YXRpc3RpY3NNZXRhRGF0YSxcbn0gZnJvbSBcIi4uLy4uLy4uLy4uL2RhdGEvcmVjb3JkZXJcIjtcbmltcG9ydCB7IEZyb250ZW5kTG9jYWxlRGF0YSB9IGZyb20gXCIuLi8uLi8uLi8uLi9kYXRhL3RyYW5zbGF0aW9uXCI7XG5pbXBvcnQgeyBTdWJzY3JpYmVNaXhpbiB9IGZyb20gXCIuLi8uLi8uLi8uLi9taXhpbnMvc3Vic2NyaWJlLW1peGluXCI7XG5pbXBvcnQgeyBIb21lQXNzaXN0YW50IH0gZnJvbSBcIi4uLy4uLy4uLy4uL3R5cGVzXCI7XG5pbXBvcnQgeyBMb3ZlbGFjZUNhcmQgfSBmcm9tIFwiLi4vLi4vdHlwZXNcIjtcbmltcG9ydCB7IEVuZXJneVVzYWdlR3JhcGhDYXJkQ29uZmlnIH0gZnJvbSBcIi4uL3R5cGVzXCI7XG5cbkBjdXN0b21FbGVtZW50KFwiaHVpLWVuZXJneS11c2FnZS1ncmFwaC1jYXJkXCIpXG5leHBvcnQgY2xhc3MgSHVpRW5lcmd5VXNhZ2VHcmFwaENhcmRcbiAgZXh0ZW5kcyBTdWJzY3JpYmVNaXhpbihMaXRFbGVtZW50KVxuICBpbXBsZW1lbnRzIExvdmVsYWNlQ2FyZFxue1xuICBAcHJvcGVydHkoeyBhdHRyaWJ1dGU6IGZhbHNlIH0pIHB1YmxpYyBoYXNzITogSG9tZUFzc2lzdGFudDtcblxuICBAc3RhdGUoKSBwcml2YXRlIF9jb25maWc/OiBFbmVyZ3lVc2FnZUdyYXBoQ2FyZENvbmZpZztcblxuICBAc3RhdGUoKSBwcml2YXRlIF9jaGFydERhdGE6IENoYXJ0RGF0YSA9IHtcbiAgICBkYXRhc2V0czogW10sXG4gIH07XG5cbiAgQHN0YXRlKCkgcHJpdmF0ZSBfc3RhcnQgPSBzdGFydE9mVG9kYXkoKTtcblxuICBAc3RhdGUoKSBwcml2YXRlIF9lbmQgPSBlbmRPZlRvZGF5KCk7XG5cbiAgQHN0YXRlKCkgcHJpdmF0ZSBfY29tcGFyZVN0YXJ0PzogRGF0ZTtcblxuICBAc3RhdGUoKSBwcml2YXRlIF9jb21wYXJlRW5kPzogRGF0ZTtcblxuICBwcm90ZWN0ZWQgaGFzc1N1YnNjcmliZVJlcXVpcmVkSG9zdFByb3BzID0gW1wiX2NvbmZpZ1wiXTtcblxuICBwdWJsaWMgaGFzc1N1YnNjcmliZSgpOiBVbnN1YnNjcmliZUZ1bmNbXSB7XG4gICAgcmV0dXJuIFtcbiAgICAgIGdldEVuZXJneURhdGFDb2xsZWN0aW9uKHRoaXMuaGFzcywge1xuICAgICAgICBrZXk6IHRoaXMuX2NvbmZpZz8uY29sbGVjdGlvbl9rZXksXG4gICAgICB9KS5zdWJzY3JpYmUoKGRhdGEpID0+IHRoaXMuX2dldFN0YXRpc3RpY3MoZGF0YSkpLFxuICAgIF07XG4gIH1cblxuICBwdWJsaWMgZ2V0Q2FyZFNpemUoKTogUHJvbWlzZTxudW1iZXI+IHwgbnVtYmVyIHtcbiAgICByZXR1cm4gMztcbiAgfVxuXG4gIHB1YmxpYyBzZXRDb25maWcoY29uZmlnOiBFbmVyZ3lVc2FnZUdyYXBoQ2FyZENvbmZpZyk6IHZvaWQge1xuICAgIHRoaXMuX2NvbmZpZyA9IGNvbmZpZztcbiAgfVxuXG4gIHByb3RlY3RlZCByZW5kZXIoKSB7XG4gICAgaWYgKCF0aGlzLmhhc3MgfHwgIXRoaXMuX2NvbmZpZykge1xuICAgICAgcmV0dXJuIG5vdGhpbmc7XG4gICAgfVxuXG4gICAgcmV0dXJuIGh0bWxgXG4gICAgICA8aGEtY2FyZD5cbiAgICAgICAgJHt0aGlzLl9jb25maWcudGl0bGVcbiAgICAgICAgICA/IGh0bWxgPGgxIGNsYXNzPVwiY2FyZC1oZWFkZXJcIj4ke3RoaXMuX2NvbmZpZy50aXRsZX08L2gxPmBcbiAgICAgICAgICA6IFwiXCJ9XG4gICAgICAgIDxkaXZcbiAgICAgICAgICBjbGFzcz1cImNvbnRlbnQgJHtjbGFzc01hcCh7XG4gICAgICAgICAgICBcImhhcy1oZWFkZXJcIjogISF0aGlzLl9jb25maWcudGl0bGUsXG4gICAgICAgICAgfSl9XCJcbiAgICAgICAgPlxuICAgICAgICAgIDxoYS1jaGFydC1iYXNlXG4gICAgICAgICAgICAuaGFzcz0ke3RoaXMuaGFzc31cbiAgICAgICAgICAgIC5kYXRhPSR7dGhpcy5fY2hhcnREYXRhfVxuICAgICAgICAgICAgLm9wdGlvbnM9JHt0aGlzLl9jcmVhdGVPcHRpb25zKFxuICAgICAgICAgICAgICB0aGlzLl9zdGFydCxcbiAgICAgICAgICAgICAgdGhpcy5fZW5kLFxuICAgICAgICAgICAgICB0aGlzLmhhc3MubG9jYWxlLFxuICAgICAgICAgICAgICB0aGlzLl9jb21wYXJlU3RhcnQsXG4gICAgICAgICAgICAgIHRoaXMuX2NvbXBhcmVFbmRcbiAgICAgICAgICAgICl9XG4gICAgICAgICAgICBjaGFydC10eXBlPVwiYmFyXCJcbiAgICAgICAgICA+PC9oYS1jaGFydC1iYXNlPlxuICAgICAgICAgICR7IXRoaXMuX2NoYXJ0RGF0YS5kYXRhc2V0cy5zb21lKChkYXRhc2V0KSA9PiBkYXRhc2V0LmRhdGEubGVuZ3RoKVxuICAgICAgICAgICAgPyBodG1sYDxkaXYgY2xhc3M9XCJuby1kYXRhXCI+XG4gICAgICAgICAgICAgICAgJHtpc1RvZGF5KHRoaXMuX3N0YXJ0KVxuICAgICAgICAgICAgICAgICAgPyB0aGlzLmhhc3MubG9jYWxpemUoXCJ1aS5wYW5lbC5sb3ZlbGFjZS5jYXJkcy5lbmVyZ3kubm9fZGF0YVwiKVxuICAgICAgICAgICAgICAgICAgOiB0aGlzLmhhc3MubG9jYWxpemUoXG4gICAgICAgICAgICAgICAgICAgICAgXCJ1aS5wYW5lbC5sb3ZlbGFjZS5jYXJkcy5lbmVyZ3kubm9fZGF0YV9wZXJpb2RcIlxuICAgICAgICAgICAgICAgICAgICApfVxuICAgICAgICAgICAgICA8L2Rpdj5gXG4gICAgICAgICAgICA6IFwiXCJ9XG4gICAgICAgIDwvZGl2PlxuICAgICAgPC9oYS1jYXJkPlxuICAgIGA7XG4gIH1cblxuICBwcml2YXRlIF9jcmVhdGVPcHRpb25zID0gbWVtb2l6ZU9uZShcbiAgICAoXG4gICAgICBzdGFydDogRGF0ZSxcbiAgICAgIGVuZDogRGF0ZSxcbiAgICAgIGxvY2FsZTogRnJvbnRlbmRMb2NhbGVEYXRhLFxuICAgICAgY29tcGFyZVN0YXJ0PzogRGF0ZSxcbiAgICAgIGNvbXBhcmVFbmQ/OiBEYXRlXG4gICAgKTogQ2hhcnRPcHRpb25zID0+IHtcbiAgICAgIGNvbnN0IGRheURpZmZlcmVuY2UgPSBkaWZmZXJlbmNlSW5EYXlzKGVuZCwgc3RhcnQpO1xuICAgICAgY29uc3QgY29tcGFyZSA9IGNvbXBhcmVTdGFydCAhPT0gdW5kZWZpbmVkICYmIGNvbXBhcmVFbmQgIT09IHVuZGVmaW5lZDtcbiAgICAgIGlmIChjb21wYXJlKSB7XG4gICAgICAgIGNvbnN0IGRpZmZlcmVuY2UgPSBkaWZmZXJlbmNlSW5Ib3VycyhlbmQsIHN0YXJ0KTtcbiAgICAgICAgY29uc3QgZGlmZmVyZW5jZUNvbXBhcmUgPSBkaWZmZXJlbmNlSW5Ib3Vycyhjb21wYXJlRW5kISwgY29tcGFyZVN0YXJ0ISk7XG4gICAgICAgIC8vIElmIHRoZSBjb21wYXJlIHBlcmlvZCBkb2Vzbid0IG1hdGNoIHRoZSBtYWluIHBlcmlvZCwgYWRqdXN0IHRoZW0gdG8gbWF0Y2hcbiAgICAgICAgaWYgKGRpZmZlcmVuY2VDb21wYXJlID4gZGlmZmVyZW5jZSkge1xuICAgICAgICAgIGVuZCA9IGFkZEhvdXJzKGVuZCwgZGlmZmVyZW5jZUNvbXBhcmUgLSBkaWZmZXJlbmNlKTtcbiAgICAgICAgfSBlbHNlIGlmIChkaWZmZXJlbmNlID4gZGlmZmVyZW5jZUNvbXBhcmUpIHtcbiAgICAgICAgICBjb21wYXJlRW5kID0gYWRkSG91cnMoY29tcGFyZUVuZCEsIGRpZmZlcmVuY2UgLSBkaWZmZXJlbmNlQ29tcGFyZSk7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgY29uc3Qgb3B0aW9uczogQ2hhcnRPcHRpb25zID0ge1xuICAgICAgICBwYXJzaW5nOiBmYWxzZSxcbiAgICAgICAgYW5pbWF0aW9uOiBmYWxzZSxcbiAgICAgICAgaW50ZXJhY3Rpb246IHtcbiAgICAgICAgICBtb2RlOiBcInhcIixcbiAgICAgICAgfSxcbiAgICAgICAgc2NhbGVzOiB7XG4gICAgICAgICAgeDoge1xuICAgICAgICAgICAgdHlwZTogXCJ0aW1lXCIsXG4gICAgICAgICAgICBzdWdnZXN0ZWRNaW46IHN0YXJ0LmdldFRpbWUoKSxcbiAgICAgICAgICAgIHN1Z2dlc3RlZE1heDogZW5kLmdldFRpbWUoKSxcbiAgICAgICAgICAgIGFkYXB0ZXJzOiB7XG4gICAgICAgICAgICAgIGRhdGU6IHtcbiAgICAgICAgICAgICAgICBsb2NhbGU6IGxvY2FsZSxcbiAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB0aWNrczoge1xuICAgICAgICAgICAgICBtYXhSb3RhdGlvbjogMCxcbiAgICAgICAgICAgICAgc2FtcGxlU2l6ZTogNSxcbiAgICAgICAgICAgICAgYXV0b1NraXBQYWRkaW5nOiAyMCxcbiAgICAgICAgICAgICAgZm9udDogKGNvbnRleHQpID0+XG4gICAgICAgICAgICAgICAgY29udGV4dC50aWNrICYmIGNvbnRleHQudGljay5tYWpvclxuICAgICAgICAgICAgICAgICAgPyAoeyB3ZWlnaHQ6IFwiYm9sZFwiIH0gYXMgYW55KVxuICAgICAgICAgICAgICAgICAgOiB7fSxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB0aW1lOiB7XG4gICAgICAgICAgICAgIHRvb2x0aXBGb3JtYXQ6XG4gICAgICAgICAgICAgICAgZGF5RGlmZmVyZW5jZSA+IDM1XG4gICAgICAgICAgICAgICAgICA/IFwibW9udGh5ZWFyXCJcbiAgICAgICAgICAgICAgICAgIDogZGF5RGlmZmVyZW5jZSA+IDdcbiAgICAgICAgICAgICAgICAgID8gXCJkYXRlXCJcbiAgICAgICAgICAgICAgICAgIDogZGF5RGlmZmVyZW5jZSA+IDJcbiAgICAgICAgICAgICAgICAgID8gXCJ3ZWVrZGF5XCJcbiAgICAgICAgICAgICAgICAgIDogZGF5RGlmZmVyZW5jZSA+IDBcbiAgICAgICAgICAgICAgICAgID8gXCJkYXRldGltZVwiXG4gICAgICAgICAgICAgICAgICA6IFwiaG91clwiLFxuICAgICAgICAgICAgICBtaW5Vbml0OlxuICAgICAgICAgICAgICAgIGRheURpZmZlcmVuY2UgPiAzNVxuICAgICAgICAgICAgICAgICAgPyBcIm1vbnRoXCJcbiAgICAgICAgICAgICAgICAgIDogZGF5RGlmZmVyZW5jZSA+IDJcbiAgICAgICAgICAgICAgICAgID8gXCJkYXlcIlxuICAgICAgICAgICAgICAgICAgOiBcImhvdXJcIixcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgfSxcbiAgICAgICAgICB5OiB7XG4gICAgICAgICAgICBzdGFja2VkOiB0cnVlLFxuICAgICAgICAgICAgdHlwZTogXCJsaW5lYXJcIixcbiAgICAgICAgICAgIHRpdGxlOiB7XG4gICAgICAgICAgICAgIGRpc3BsYXk6IHRydWUsXG4gICAgICAgICAgICAgIHRleHQ6IFwia1doXCIsXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgdGlja3M6IHtcbiAgICAgICAgICAgICAgYmVnaW5BdFplcm86IHRydWUsXG4gICAgICAgICAgICAgIGNhbGxiYWNrOiAodmFsdWUpID0+IGZvcm1hdE51bWJlcihNYXRoLmFicyh2YWx1ZSksIGxvY2FsZSksXG4gICAgICAgICAgICB9LFxuICAgICAgICAgIH0sXG4gICAgICAgIH0sXG4gICAgICAgIHBsdWdpbnM6IHtcbiAgICAgICAgICB0b29sdGlwOiB7XG4gICAgICAgICAgICBwb3NpdGlvbjogXCJuZWFyZXN0XCIsXG4gICAgICAgICAgICBmaWx0ZXI6ICh2YWwpID0+IHZhbC5mb3JtYXR0ZWRWYWx1ZSAhPT0gXCIwXCIsXG4gICAgICAgICAgICBjYWxsYmFja3M6IHtcbiAgICAgICAgICAgICAgdGl0bGU6IChkYXRhc2V0cykgPT4ge1xuICAgICAgICAgICAgICAgIGlmIChkYXlEaWZmZXJlbmNlID4gMCkge1xuICAgICAgICAgICAgICAgICAgcmV0dXJuIGRhdGFzZXRzWzBdLmxhYmVsO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBjb25zdCBkYXRlID0gbmV3IERhdGUoZGF0YXNldHNbMF0ucGFyc2VkLngpO1xuICAgICAgICAgICAgICAgIHJldHVybiBgJHtcbiAgICAgICAgICAgICAgICAgIGNvbXBhcmUgPyBgJHtmb3JtYXREYXRlU2hvcnQoZGF0ZSwgbG9jYWxlKX06IGAgOiBcIlwiXG4gICAgICAgICAgICAgICAgfSR7Zm9ybWF0VGltZShkYXRlLCBsb2NhbGUpfSDigJMgJHtmb3JtYXRUaW1lKFxuICAgICAgICAgICAgICAgICAgYWRkSG91cnMoZGF0ZSwgMSksXG4gICAgICAgICAgICAgICAgICBsb2NhbGVcbiAgICAgICAgICAgICAgICApfWA7XG4gICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgIGxhYmVsOiAoY29udGV4dCkgPT5cbiAgICAgICAgICAgICAgICBgJHtjb250ZXh0LmRhdGFzZXQubGFiZWx9OiAke2Zvcm1hdE51bWJlcihcbiAgICAgICAgICAgICAgICAgIE1hdGguYWJzKGNvbnRleHQucGFyc2VkLnkpLFxuICAgICAgICAgICAgICAgICAgbG9jYWxlXG4gICAgICAgICAgICAgICAgKX0ga1doYCxcbiAgICAgICAgICAgICAgZm9vdGVyOiAoY29udGV4dHMpID0+IHtcbiAgICAgICAgICAgICAgICBsZXQgdG90YWxDb25zdW1lZCA9IDA7XG4gICAgICAgICAgICAgICAgbGV0IHRvdGFsUmV0dXJuZWQgPSAwO1xuICAgICAgICAgICAgICAgIGZvciAoY29uc3QgY29udGV4dCBvZiBjb250ZXh0cykge1xuICAgICAgICAgICAgICAgICAgY29uc3QgdmFsdWUgPSAoY29udGV4dC5kYXRhc2V0LmRhdGFbY29udGV4dC5kYXRhSW5kZXhdIGFzIGFueSlcbiAgICAgICAgICAgICAgICAgICAgLnk7XG4gICAgICAgICAgICAgICAgICBpZiAodmFsdWUgPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgIHRvdGFsQ29uc3VtZWQgKz0gdmFsdWU7XG4gICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB0b3RhbFJldHVybmVkICs9IE1hdGguYWJzKHZhbHVlKTtcbiAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIFtcbiAgICAgICAgICAgICAgICAgIHRvdGFsQ29uc3VtZWRcbiAgICAgICAgICAgICAgICAgICAgPyB0aGlzLmhhc3MubG9jYWxpemUoXG4gICAgICAgICAgICAgICAgICAgICAgICBcInVpLnBhbmVsLmxvdmVsYWNlLmNhcmRzLmVuZXJneS5lbmVyZ3lfdXNhZ2VfZ3JhcGgudG90YWxfY29uc3VtZWRcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIHsgbnVtOiBmb3JtYXROdW1iZXIodG90YWxDb25zdW1lZCwgbG9jYWxlKSB9XG4gICAgICAgICAgICAgICAgICAgICAgKVxuICAgICAgICAgICAgICAgICAgICA6IFwiXCIsXG4gICAgICAgICAgICAgICAgICB0b3RhbFJldHVybmVkXG4gICAgICAgICAgICAgICAgICAgID8gdGhpcy5oYXNzLmxvY2FsaXplKFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJ1aS5wYW5lbC5sb3ZlbGFjZS5jYXJkcy5lbmVyZ3kuZW5lcmd5X3VzYWdlX2dyYXBoLnRvdGFsX3JldHVybmVkXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICB7IG51bTogZm9ybWF0TnVtYmVyKHRvdGFsUmV0dXJuZWQsIGxvY2FsZSkgfVxuICAgICAgICAgICAgICAgICAgICAgIClcbiAgICAgICAgICAgICAgICAgICAgOiBcIlwiLFxuICAgICAgICAgICAgICAgIF0uZmlsdGVyKEJvb2xlYW4pO1xuICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICB9LFxuICAgICAgICAgIGZpbGxlcjoge1xuICAgICAgICAgICAgcHJvcGFnYXRlOiBmYWxzZSxcbiAgICAgICAgICB9LFxuICAgICAgICAgIGxlZ2VuZDoge1xuICAgICAgICAgICAgZGlzcGxheTogZmFsc2UsXG4gICAgICAgICAgICBsYWJlbHM6IHtcbiAgICAgICAgICAgICAgdXNlUG9pbnRTdHlsZTogdHJ1ZSxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgfSxcbiAgICAgICAgfSxcbiAgICAgICAgZWxlbWVudHM6IHtcbiAgICAgICAgICBiYXI6IHsgYm9yZGVyV2lkdGg6IDEuNSwgYm9yZGVyUmFkaXVzOiA0IH0sXG4gICAgICAgICAgcG9pbnQ6IHtcbiAgICAgICAgICAgIGhpdFJhZGl1czogNTAsXG4gICAgICAgICAgfSxcbiAgICAgICAgfSxcbiAgICAgICAgLy8gQHRzLWV4cGVjdC1lcnJvclxuICAgICAgICBsb2NhbGU6IG51bWJlckZvcm1hdFRvTG9jYWxlKGxvY2FsZSksXG4gICAgICB9O1xuICAgICAgaWYgKGNvbXBhcmUpIHtcbiAgICAgICAgb3B0aW9ucy5zY2FsZXMhLnhBeGlzQ29tcGFyZSA9IHtcbiAgICAgICAgICAuLi4ob3B0aW9ucy5zY2FsZXMhLnggYXMgUmVjb3JkPHN0cmluZywgYW55PiksXG4gICAgICAgICAgc3VnZ2VzdGVkTWluOiBjb21wYXJlU3RhcnQhLmdldFRpbWUoKSxcbiAgICAgICAgICBzdWdnZXN0ZWRNYXg6IGNvbXBhcmVFbmQhLmdldFRpbWUoKSxcbiAgICAgICAgICBkaXNwbGF5OiBmYWxzZSxcbiAgICAgICAgfTtcbiAgICAgIH1cbiAgICAgIHJldHVybiBvcHRpb25zO1xuICAgIH1cbiAgKTtcblxuICBwcml2YXRlIGFzeW5jIF9nZXRTdGF0aXN0aWNzKGVuZXJneURhdGE6IEVuZXJneURhdGEpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICBjb25zdCBkYXRhc2V0czogQ2hhcnREYXRhc2V0PFwiYmFyXCIsIFNjYXR0ZXJEYXRhUG9pbnRbXT5bXSA9IFtdO1xuXG4gICAgY29uc3Qgc3RhdElkczoge1xuICAgICAgdG9fZ3JpZD86IHN0cmluZ1tdO1xuICAgICAgZnJvbV9ncmlkPzogc3RyaW5nW107XG4gICAgICBzb2xhcj86IHN0cmluZ1tdO1xuICAgICAgdG9fYmF0dGVyeT86IHN0cmluZ1tdO1xuICAgICAgZnJvbV9iYXR0ZXJ5Pzogc3RyaW5nW107XG4gICAgfSA9IHt9O1xuXG4gICAgZm9yIChjb25zdCBzb3VyY2Ugb2YgZW5lcmd5RGF0YS5wcmVmcy5lbmVyZ3lfc291cmNlcykge1xuICAgICAgaWYgKHNvdXJjZS50eXBlID09PSBcInNvbGFyXCIpIHtcbiAgICAgICAgaWYgKHN0YXRJZHMuc29sYXIpIHtcbiAgICAgICAgICBzdGF0SWRzLnNvbGFyLnB1c2goc291cmNlLnN0YXRfZW5lcmd5X2Zyb20pO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHN0YXRJZHMuc29sYXIgPSBbc291cmNlLnN0YXRfZW5lcmd5X2Zyb21dO1xuICAgICAgICB9XG4gICAgICAgIGNvbnRpbnVlO1xuICAgICAgfVxuXG4gICAgICBpZiAoc291cmNlLnR5cGUgPT09IFwiYmF0dGVyeVwiKSB7XG4gICAgICAgIGlmIChzdGF0SWRzLnRvX2JhdHRlcnkpIHtcbiAgICAgICAgICBzdGF0SWRzLnRvX2JhdHRlcnkucHVzaChzb3VyY2Uuc3RhdF9lbmVyZ3lfdG8pO1xuICAgICAgICAgIHN0YXRJZHMuZnJvbV9iYXR0ZXJ5IS5wdXNoKHNvdXJjZS5zdGF0X2VuZXJneV9mcm9tKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBzdGF0SWRzLnRvX2JhdHRlcnkgPSBbc291cmNlLnN0YXRfZW5lcmd5X3RvXTtcbiAgICAgICAgICBzdGF0SWRzLmZyb21fYmF0dGVyeSA9IFtzb3VyY2Uuc3RhdF9lbmVyZ3lfZnJvbV07XG4gICAgICAgIH1cbiAgICAgICAgY29udGludWU7XG4gICAgICB9XG5cbiAgICAgIGlmIChzb3VyY2UudHlwZSAhPT0gXCJncmlkXCIpIHtcbiAgICAgICAgY29udGludWU7XG4gICAgICB9XG5cbiAgICAgIC8vIGdyaWQgc291cmNlXG4gICAgICBmb3IgKGNvbnN0IGZsb3dGcm9tIG9mIHNvdXJjZS5mbG93X2Zyb20pIHtcbiAgICAgICAgaWYgKHN0YXRJZHMuZnJvbV9ncmlkKSB7XG4gICAgICAgICAgc3RhdElkcy5mcm9tX2dyaWQucHVzaChmbG93RnJvbS5zdGF0X2VuZXJneV9mcm9tKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBzdGF0SWRzLmZyb21fZ3JpZCA9IFtmbG93RnJvbS5zdGF0X2VuZXJneV9mcm9tXTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgZm9yIChjb25zdCBmbG93VG8gb2Ygc291cmNlLmZsb3dfdG8pIHtcbiAgICAgICAgaWYgKHN0YXRJZHMudG9fZ3JpZCkge1xuICAgICAgICAgIHN0YXRJZHMudG9fZ3JpZC5wdXNoKGZsb3dUby5zdGF0X2VuZXJneV90byk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgc3RhdElkcy50b19ncmlkID0gW2Zsb3dUby5zdGF0X2VuZXJneV90b107XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG5cbiAgICBjb25zdCBjb21wdXRlZFN0eWxlcyA9IGdldENvbXB1dGVkU3R5bGUodGhpcyk7XG4gICAgY29uc3QgY29sb3JzID0ge1xuICAgICAgdG9fZ3JpZDogY29tcHV0ZWRTdHlsZXNcbiAgICAgICAgLmdldFByb3BlcnR5VmFsdWUoXCItLWVuZXJneS1ncmlkLXJldHVybi1jb2xvclwiKVxuICAgICAgICAudHJpbSgpLFxuICAgICAgdG9fYmF0dGVyeTogY29tcHV0ZWRTdHlsZXNcbiAgICAgICAgLmdldFByb3BlcnR5VmFsdWUoXCItLWVuZXJneS1iYXR0ZXJ5LWluLWNvbG9yXCIpXG4gICAgICAgIC50cmltKCksXG4gICAgICBmcm9tX2dyaWQ6IGNvbXB1dGVkU3R5bGVzXG4gICAgICAgIC5nZXRQcm9wZXJ0eVZhbHVlKFwiLS1lbmVyZ3ktZ3JpZC1jb25zdW1wdGlvbi1jb2xvclwiKVxuICAgICAgICAudHJpbSgpLFxuICAgICAgdXNlZF9ncmlkOiBjb21wdXRlZFN0eWxlc1xuICAgICAgICAuZ2V0UHJvcGVydHlWYWx1ZShcIi0tZW5lcmd5LWdyaWQtY29uc3VtcHRpb24tY29sb3JcIilcbiAgICAgICAgLnRyaW0oKSxcbiAgICAgIHVzZWRfc29sYXI6IGNvbXB1dGVkU3R5bGVzXG4gICAgICAgIC5nZXRQcm9wZXJ0eVZhbHVlKFwiLS1lbmVyZ3ktc29sYXItY29sb3JcIilcbiAgICAgICAgLnRyaW0oKSxcbiAgICAgIHVzZWRfYmF0dGVyeTogY29tcHV0ZWRTdHlsZXNcbiAgICAgICAgLmdldFByb3BlcnR5VmFsdWUoXCItLWVuZXJneS1iYXR0ZXJ5LW91dC1jb2xvclwiKVxuICAgICAgICAudHJpbSgpLFxuICAgIH07XG4gICAgY29uc3QgbGFiZWxzID0ge1xuICAgICAgdXNlZF9ncmlkOiB0aGlzLmhhc3MubG9jYWxpemUoXG4gICAgICAgIFwidWkucGFuZWwubG92ZWxhY2UuY2FyZHMuZW5lcmd5LmVuZXJneV91c2FnZV9ncmFwaC5jb21iaW5lZF9mcm9tX2dyaWRcIlxuICAgICAgKSxcbiAgICAgIHVzZWRfc29sYXI6IHRoaXMuaGFzcy5sb2NhbGl6ZShcbiAgICAgICAgXCJ1aS5wYW5lbC5sb3ZlbGFjZS5jYXJkcy5lbmVyZ3kuZW5lcmd5X3VzYWdlX2dyYXBoLmNvbnN1bWVkX3NvbGFyXCJcbiAgICAgICksXG4gICAgICB1c2VkX2JhdHRlcnk6IHRoaXMuaGFzcy5sb2NhbGl6ZShcbiAgICAgICAgXCJ1aS5wYW5lbC5sb3ZlbGFjZS5jYXJkcy5lbmVyZ3kuZW5lcmd5X3VzYWdlX2dyYXBoLmNvbnN1bWVkX2JhdHRlcnlcIlxuICAgICAgKSxcbiAgICB9O1xuXG4gICAgdGhpcy5fc3RhcnQgPSBlbmVyZ3lEYXRhLnN0YXJ0O1xuICAgIHRoaXMuX2VuZCA9IGVuZXJneURhdGEuZW5kIHx8IGVuZE9mVG9kYXkoKTtcblxuICAgIHRoaXMuX2NvbXBhcmVTdGFydCA9IGVuZXJneURhdGEuc3RhcnRDb21wYXJlO1xuICAgIHRoaXMuX2NvbXBhcmVFbmQgPSBlbmVyZ3lEYXRhLmVuZENvbXBhcmU7XG5cbiAgICBkYXRhc2V0cy5wdXNoKFxuICAgICAgLi4udGhpcy5fcHJvY2Vzc0RhdGFTZXQoXG4gICAgICAgIGVuZXJneURhdGEuc3RhdHMsXG4gICAgICAgIGVuZXJneURhdGEuc3RhdHNNZXRhZGF0YSxcbiAgICAgICAgc3RhdElkcyxcbiAgICAgICAgY29sb3JzLFxuICAgICAgICBsYWJlbHMsXG4gICAgICAgIGZhbHNlXG4gICAgICApXG4gICAgKTtcblxuICAgIGlmIChlbmVyZ3lEYXRhLnN0YXRzQ29tcGFyZSkge1xuICAgICAgLy8gQWRkIGVtcHR5IGRhdGFzZXQgdG8gYWxpZ24gdGhlIGJhcnNcbiAgICAgIGRhdGFzZXRzLnB1c2goe1xuICAgICAgICBvcmRlcjogMCxcbiAgICAgICAgZGF0YTogW10sXG4gICAgICB9KTtcbiAgICAgIGRhdGFzZXRzLnB1c2goe1xuICAgICAgICBvcmRlcjogOTk5LFxuICAgICAgICBkYXRhOiBbXSxcbiAgICAgICAgeEF4aXNJRDogXCJ4QXhpc0NvbXBhcmVcIixcbiAgICAgIH0pO1xuXG4gICAgICBkYXRhc2V0cy5wdXNoKFxuICAgICAgICAuLi50aGlzLl9wcm9jZXNzRGF0YVNldChcbiAgICAgICAgICBlbmVyZ3lEYXRhLnN0YXRzQ29tcGFyZSxcbiAgICAgICAgICBlbmVyZ3lEYXRhLnN0YXRzTWV0YWRhdGEsXG4gICAgICAgICAgc3RhdElkcyxcbiAgICAgICAgICBjb2xvcnMsXG4gICAgICAgICAgbGFiZWxzLFxuICAgICAgICAgIHRydWVcbiAgICAgICAgKVxuICAgICAgKTtcbiAgICB9XG5cbiAgICB0aGlzLl9jaGFydERhdGEgPSB7XG4gICAgICBkYXRhc2V0cyxcbiAgICB9O1xuICB9XG5cbiAgcHJpdmF0ZSBfcHJvY2Vzc0RhdGFTZXQoXG4gICAgc3RhdGlzdGljczogU3RhdGlzdGljcyxcbiAgICBzdGF0aXN0aWNzTWV0YURhdGE6IFJlY29yZDxzdHJpbmcsIFN0YXRpc3RpY3NNZXRhRGF0YT4sXG4gICAgc3RhdElkc0J5Q2F0OiB7XG4gICAgICB0b19ncmlkPzogc3RyaW5nW10gfCB1bmRlZmluZWQ7XG4gICAgICBmcm9tX2dyaWQ/OiBzdHJpbmdbXSB8IHVuZGVmaW5lZDtcbiAgICAgIHNvbGFyPzogc3RyaW5nW10gfCB1bmRlZmluZWQ7XG4gICAgICB0b19iYXR0ZXJ5Pzogc3RyaW5nW10gfCB1bmRlZmluZWQ7XG4gICAgICBmcm9tX2JhdHRlcnk/OiBzdHJpbmdbXSB8IHVuZGVmaW5lZDtcbiAgICB9LFxuICAgIGNvbG9yczoge1xuICAgICAgdG9fZ3JpZDogc3RyaW5nO1xuICAgICAgdG9fYmF0dGVyeTogc3RyaW5nO1xuICAgICAgZnJvbV9ncmlkOiBzdHJpbmc7XG4gICAgICB1c2VkX2dyaWQ6IHN0cmluZztcbiAgICAgIHVzZWRfc29sYXI6IHN0cmluZztcbiAgICAgIHVzZWRfYmF0dGVyeTogc3RyaW5nO1xuICAgIH0sXG4gICAgbGFiZWxzOiB7XG4gICAgICB1c2VkX2dyaWQ6IHN0cmluZztcbiAgICAgIHVzZWRfc29sYXI6IHN0cmluZztcbiAgICAgIHVzZWRfYmF0dGVyeTogc3RyaW5nO1xuICAgIH0sXG4gICAgY29tcGFyZSA9IGZhbHNlXG4gICkge1xuICAgIGNvbnN0IGRhdGE6IENoYXJ0RGF0YXNldDxcImJhclwiLCBTY2F0dGVyRGF0YVBvaW50W10+W10gPSBbXTtcblxuICAgIGNvbnN0IGNvbWJpbmVkRGF0YToge1xuICAgICAgdG9fZ3JpZD86IHsgW3N0YXRJZDogc3RyaW5nXTogeyBbc3RhcnQ6IG51bWJlcl06IG51bWJlciB9IH07XG4gICAgICB0b19iYXR0ZXJ5PzogeyBbc3RhdElkOiBzdHJpbmddOiB7IFtzdGFydDogbnVtYmVyXTogbnVtYmVyIH0gfTtcbiAgICAgIGZyb21fZ3JpZD86IHsgW3N0YXRJZDogc3RyaW5nXTogeyBbc3RhcnQ6IG51bWJlcl06IG51bWJlciB9IH07XG4gICAgICB1c2VkX2dyaWQ/OiB7IFtzdGF0SWQ6IHN0cmluZ106IHsgW3N0YXJ0OiBudW1iZXJdOiBudW1iZXIgfSB9O1xuICAgICAgdXNlZF9zb2xhcj86IHsgW3N0YXRJZDogc3RyaW5nXTogeyBbc3RhcnQ6IG51bWJlcl06IG51bWJlciB9IH07XG4gICAgICB1c2VkX2JhdHRlcnk/OiB7IFtzdGF0SWQ6IHN0cmluZ106IHsgW3N0YXJ0OiBudW1iZXJdOiBudW1iZXIgfSB9O1xuICAgIH0gPSB7fTtcblxuICAgIGNvbnN0IHN1bW1lZERhdGE6IHtcbiAgICAgIHRvX2dyaWQ/OiB7IFtzdGFydDogbnVtYmVyXTogbnVtYmVyIH07XG4gICAgICBmcm9tX2dyaWQ/OiB7IFtzdGFydDogbnVtYmVyXTogbnVtYmVyIH07XG4gICAgICB0b19iYXR0ZXJ5PzogeyBbc3RhcnQ6IG51bWJlcl06IG51bWJlciB9O1xuICAgICAgZnJvbV9iYXR0ZXJ5PzogeyBbc3RhcnQ6IG51bWJlcl06IG51bWJlciB9O1xuICAgICAgc29sYXI/OiB7IFtzdGFydDogbnVtYmVyXTogbnVtYmVyIH07XG4gICAgfSA9IHt9O1xuXG4gICAgT2JqZWN0LmVudHJpZXMoc3RhdElkc0J5Q2F0KS5mb3JFYWNoKChba2V5LCBzdGF0SWRzXSkgPT4ge1xuICAgICAgY29uc3Qgc3VtID0gW1xuICAgICAgICBcInNvbGFyXCIsXG4gICAgICAgIFwidG9fZ3JpZFwiLFxuICAgICAgICBcImZyb21fZ3JpZFwiLFxuICAgICAgICBcInRvX2JhdHRlcnlcIixcbiAgICAgICAgXCJmcm9tX2JhdHRlcnlcIixcbiAgICAgIF0uaW5jbHVkZXMoa2V5KTtcbiAgICAgIGNvbnN0IGFkZCA9ICFbXCJzb2xhclwiLCBcImZyb21fYmF0dGVyeVwiXS5pbmNsdWRlcyhrZXkpO1xuICAgICAgY29uc3QgdG90YWxTdGF0czogeyBbc3RhcnQ6IG51bWJlcl06IG51bWJlciB9ID0ge307XG4gICAgICBjb25zdCBzZXRzOiB7IFtzdGF0SWQ6IHN0cmluZ106IHsgW3N0YXJ0OiBudW1iZXJdOiBudW1iZXIgfSB9ID0ge307XG4gICAgICBzdGF0SWRzIS5mb3JFYWNoKChpZCkgPT4ge1xuICAgICAgICBjb25zdCBzdGF0cyA9IHN0YXRpc3RpY3NbaWRdO1xuICAgICAgICBpZiAoIXN0YXRzKSB7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc3Qgc2V0ID0ge307XG4gICAgICAgIHN0YXRzLmZvckVhY2goKHN0YXQpID0+IHtcbiAgICAgICAgICBpZiAoc3RhdC5jaGFuZ2UgPT09IG51bGwgfHwgc3RhdC5jaGFuZ2UgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgIH1cbiAgICAgICAgICBjb25zdCB2YWwgPSBzdGF0LmNoYW5nZTtcbiAgICAgICAgICAvLyBHZXQgdG90YWwgb2Ygc29sYXIgYW5kIHRvIGdyaWQgdG8gY2FsY3VsYXRlIHRoZSBzb2xhciBlbmVyZ3kgdXNlZFxuICAgICAgICAgIGlmIChzdW0pIHtcbiAgICAgICAgICAgIHRvdGFsU3RhdHNbc3RhdC5zdGFydF0gPVxuICAgICAgICAgICAgICBzdGF0LnN0YXJ0IGluIHRvdGFsU3RhdHMgPyB0b3RhbFN0YXRzW3N0YXQuc3RhcnRdICsgdmFsIDogdmFsO1xuICAgICAgICAgIH1cbiAgICAgICAgICBpZiAoYWRkICYmICEoc3RhdC5zdGFydCBpbiBzZXQpKSB7XG4gICAgICAgICAgICBzZXRbc3RhdC5zdGFydF0gPSB2YWw7XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgc2V0c1tpZF0gPSBzZXQ7XG4gICAgICB9KTtcbiAgICAgIGlmIChzdW0pIHtcbiAgICAgICAgc3VtbWVkRGF0YVtrZXldID0gdG90YWxTdGF0cztcbiAgICAgIH1cbiAgICAgIGlmIChhZGQpIHtcbiAgICAgICAgY29tYmluZWREYXRhW2tleV0gPSBzZXRzO1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgY29uc3QgZ3JpZF90b19iYXR0ZXJ5ID0ge307XG4gICAgY29uc3QgYmF0dGVyeV90b19ncmlkID0ge307XG4gICAgaWYgKChzdW1tZWREYXRhLnRvX2dyaWQgfHwgc3VtbWVkRGF0YS50b19iYXR0ZXJ5KSAmJiBzdW1tZWREYXRhLnNvbGFyKSB7XG4gICAgICBjb25zdCB1c2VkX3NvbGFyID0ge307XG4gICAgICBmb3IgKGNvbnN0IHN0YXJ0IG9mIE9iamVjdC5rZXlzKHN1bW1lZERhdGEuc29sYXIpKSB7XG4gICAgICAgIHVzZWRfc29sYXJbc3RhcnRdID1cbiAgICAgICAgICAoc3VtbWVkRGF0YS5zb2xhcltzdGFydF0gfHwgMCkgLVxuICAgICAgICAgIChzdW1tZWREYXRhLnRvX2dyaWQ/LltzdGFydF0gfHwgMCkgLVxuICAgICAgICAgIChzdW1tZWREYXRhLnRvX2JhdHRlcnk/LltzdGFydF0gfHwgMCk7XG4gICAgICAgIGlmICh1c2VkX3NvbGFyW3N0YXJ0XSA8IDApIHtcbiAgICAgICAgICBpZiAoc3VtbWVkRGF0YS50b19iYXR0ZXJ5KSB7XG4gICAgICAgICAgICBncmlkX3RvX2JhdHRlcnlbc3RhcnRdID0gdXNlZF9zb2xhcltzdGFydF0gKiAtMTtcbiAgICAgICAgICAgIGlmIChncmlkX3RvX2JhdHRlcnlbc3RhcnRdID4gKHN1bW1lZERhdGEuZnJvbV9ncmlkPy5bc3RhcnRdIHx8IDApKSB7XG4gICAgICAgICAgICAgIGJhdHRlcnlfdG9fZ3JpZFtzdGFydF0gPSBNYXRoLm1pbihcbiAgICAgICAgICAgICAgICAwLFxuICAgICAgICAgICAgICAgIGdyaWRfdG9fYmF0dGVyeVtzdGFydF0gLSAoc3VtbWVkRGF0YS5mcm9tX2dyaWQ/LltzdGFydF0gfHwgMClcbiAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgZ3JpZF90b19iYXR0ZXJ5W3N0YXJ0XSA9IHN1bW1lZERhdGEuZnJvbV9ncmlkPy5bc3RhcnRdO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgICB1c2VkX3NvbGFyW3N0YXJ0XSA9IDA7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIGNvbWJpbmVkRGF0YS51c2VkX3NvbGFyID0geyB1c2VkX3NvbGFyIH07XG4gICAgfVxuXG4gICAgaWYgKHN1bW1lZERhdGEuZnJvbV9iYXR0ZXJ5KSB7XG4gICAgICBpZiAoc3VtbWVkRGF0YS50b19ncmlkKSB7XG4gICAgICAgIGNvbnN0IHVzZWRfYmF0dGVyeSA9IHt9O1xuICAgICAgICBmb3IgKGNvbnN0IHN0YXJ0IG9mIE9iamVjdC5rZXlzKHN1bW1lZERhdGEuZnJvbV9iYXR0ZXJ5KSkge1xuICAgICAgICAgIHVzZWRfYmF0dGVyeVtzdGFydF0gPVxuICAgICAgICAgICAgKHN1bW1lZERhdGEuZnJvbV9iYXR0ZXJ5IVtzdGFydF0gfHwgMCkgLVxuICAgICAgICAgICAgKGJhdHRlcnlfdG9fZ3JpZFtzdGFydF0gfHwgMCk7XG4gICAgICAgIH1cbiAgICAgICAgY29tYmluZWREYXRhLnVzZWRfYmF0dGVyeSA9IHsgdXNlZF9iYXR0ZXJ5IH07XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBjb21iaW5lZERhdGEudXNlZF9iYXR0ZXJ5ID0geyB1c2VkX2JhdHRlcnk6IHN1bW1lZERhdGEuZnJvbV9iYXR0ZXJ5IH07XG4gICAgICB9XG4gICAgfVxuXG4gICAgaWYgKGNvbWJpbmVkRGF0YS5mcm9tX2dyaWQgJiYgc3VtbWVkRGF0YS50b19iYXR0ZXJ5KSB7XG4gICAgICBjb25zdCB1c2VkX2dyaWQgPSB7fTtcbiAgICAgIGZvciAoY29uc3Qgc3RhcnQgb2YgT2JqZWN0LmtleXMoZ3JpZF90b19iYXR0ZXJ5KSkge1xuICAgICAgICBsZXQgbm9PZlNvdXJjZXMgPSAwO1xuICAgICAgICBsZXQgc291cmNlOiBzdHJpbmc7XG4gICAgICAgIGZvciAoY29uc3QgW2tleSwgc3RhdHNdIG9mIE9iamVjdC5lbnRyaWVzKGNvbWJpbmVkRGF0YS5mcm9tX2dyaWQpKSB7XG4gICAgICAgICAgaWYgKHN0YXRzW3N0YXJ0XSkge1xuICAgICAgICAgICAgc291cmNlID0ga2V5O1xuICAgICAgICAgICAgbm9PZlNvdXJjZXMrKztcbiAgICAgICAgICB9XG4gICAgICAgICAgaWYgKG5vT2ZTb3VyY2VzID4gMSkge1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlmIChub09mU291cmNlcyA9PT0gMSkge1xuICAgICAgICAgIGNvbWJpbmVkRGF0YS5mcm9tX2dyaWRbc291cmNlIV1bc3RhcnRdIC09IGdyaWRfdG9fYmF0dGVyeVtzdGFydF0gfHwgMDtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBsZXQgdG90YWxfZnJvbV9ncmlkID0gMDtcbiAgICAgICAgICBPYmplY3QudmFsdWVzKGNvbWJpbmVkRGF0YS5mcm9tX2dyaWQpLmZvckVhY2goKHN0YXRzKSA9PiB7XG4gICAgICAgICAgICB0b3RhbF9mcm9tX2dyaWQgKz0gc3RhdHNbc3RhcnRdIHx8IDA7XG4gICAgICAgICAgICBkZWxldGUgc3RhdHNbc3RhcnRdO1xuICAgICAgICAgIH0pO1xuICAgICAgICAgIHVzZWRfZ3JpZFtzdGFydF0gPSB0b3RhbF9mcm9tX2dyaWQgLSAoZ3JpZF90b19iYXR0ZXJ5W3N0YXJ0XSB8fCAwKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgY29tYmluZWREYXRhLnVzZWRfZ3JpZCA9IHsgdXNlZF9ncmlkIH07XG4gICAgfVxuXG4gICAgbGV0IGFsbEtleXM6IHN0cmluZ1tdID0gW107XG5cbiAgICBPYmplY3QudmFsdWVzKGNvbWJpbmVkRGF0YSkuZm9yRWFjaCgoc291cmNlcykgPT4ge1xuICAgICAgT2JqZWN0LnZhbHVlcyhzb3VyY2VzKS5mb3JFYWNoKChzb3VyY2UpID0+IHtcbiAgICAgICAgYWxsS2V5cyA9IGFsbEtleXMuY29uY2F0KE9iamVjdC5rZXlzKHNvdXJjZSkpO1xuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICBjb25zdCB1bmlxdWVLZXlzID0gQXJyYXkuZnJvbShuZXcgU2V0KGFsbEtleXMpKTtcblxuICAgIE9iamVjdC5lbnRyaWVzKGNvbWJpbmVkRGF0YSkuZm9yRWFjaCgoW3R5cGUsIHNvdXJjZXNdKSA9PiB7XG4gICAgICBPYmplY3QuZW50cmllcyhzb3VyY2VzKS5mb3JFYWNoKChbc3RhdElkLCBzb3VyY2VdLCBpZHgpID0+IHtcbiAgICAgICAgY29uc3QgbW9kaWZpZWRDb2xvciA9XG4gICAgICAgICAgaWR4ID4gMFxuICAgICAgICAgICAgPyB0aGlzLmhhc3MudGhlbWVzLmRhcmtNb2RlXG4gICAgICAgICAgICAgID8gbGFiQnJpZ2h0ZW4ocmdiMmxhYihoZXgycmdiKGNvbG9yc1t0eXBlXSkpLCBpZHgpXG4gICAgICAgICAgICAgIDogbGFiRGFya2VuKHJnYjJsYWIoaGV4MnJnYihjb2xvcnNbdHlwZV0pKSwgaWR4KVxuICAgICAgICAgICAgOiB1bmRlZmluZWQ7XG4gICAgICAgIGNvbnN0IGJvcmRlckNvbG9yID0gbW9kaWZpZWRDb2xvclxuICAgICAgICAgID8gcmdiMmhleChsYWIycmdiKG1vZGlmaWVkQ29sb3IpKVxuICAgICAgICAgIDogY29sb3JzW3R5cGVdO1xuXG4gICAgICAgIGNvbnN0IHBvaW50czogU2NhdHRlckRhdGFQb2ludFtdID0gW107XG4gICAgICAgIC8vIFByb2Nlc3MgY2hhcnQgZGF0YS5cbiAgICAgICAgZm9yIChjb25zdCBrZXkgb2YgdW5pcXVlS2V5cykge1xuICAgICAgICAgIGNvbnN0IHZhbHVlID0gc291cmNlW2tleV0gfHwgMDtcbiAgICAgICAgICBwb2ludHMucHVzaCh7XG4gICAgICAgICAgICB4OiBOdW1iZXIoa2V5KSxcbiAgICAgICAgICAgIHk6XG4gICAgICAgICAgICAgIHZhbHVlICYmIFtcInRvX2dyaWRcIiwgXCJ0b19iYXR0ZXJ5XCJdLmluY2x1ZGVzKHR5cGUpXG4gICAgICAgICAgICAgICAgPyAtMSAqIHZhbHVlXG4gICAgICAgICAgICAgICAgOiB2YWx1ZSxcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuXG4gICAgICAgIGRhdGEucHVzaCh7XG4gICAgICAgICAgbGFiZWw6XG4gICAgICAgICAgICB0eXBlIGluIGxhYmVsc1xuICAgICAgICAgICAgICA/IGxhYmVsc1t0eXBlXVxuICAgICAgICAgICAgICA6IGdldFN0YXRpc3RpY0xhYmVsKFxuICAgICAgICAgICAgICAgICAgdGhpcy5oYXNzLFxuICAgICAgICAgICAgICAgICAgc3RhdElkLFxuICAgICAgICAgICAgICAgICAgc3RhdGlzdGljc01ldGFEYXRhW3N0YXRJZF1cbiAgICAgICAgICAgICAgICApLFxuICAgICAgICAgIG9yZGVyOlxuICAgICAgICAgICAgdHlwZSA9PT0gXCJ1c2VkX3NvbGFyXCJcbiAgICAgICAgICAgICAgPyAxXG4gICAgICAgICAgICAgIDogdHlwZSA9PT0gXCJ0b19iYXR0ZXJ5XCJcbiAgICAgICAgICAgICAgPyBPYmplY3Qua2V5cyhjb21iaW5lZERhdGEpLmxlbmd0aFxuICAgICAgICAgICAgICA6IGlkeCArIDIsXG4gICAgICAgICAgYm9yZGVyQ29sb3I6IGNvbXBhcmUgPyBib3JkZXJDb2xvciArIFwiN0ZcIiA6IGJvcmRlckNvbG9yLFxuICAgICAgICAgIGJhY2tncm91bmRDb2xvcjogY29tcGFyZSA/IGJvcmRlckNvbG9yICsgXCIzMlwiIDogYm9yZGVyQ29sb3IgKyBcIjdGXCIsXG4gICAgICAgICAgc3RhY2s6IFwic3RhY2tcIixcbiAgICAgICAgICBkYXRhOiBwb2ludHMsXG4gICAgICAgICAgeEF4aXNJRDogY29tcGFyZSA/IFwieEF4aXNDb21wYXJlXCIgOiB1bmRlZmluZWQsXG4gICAgICAgIH0pO1xuICAgICAgfSk7XG4gICAgfSk7XG4gICAgcmV0dXJuIGRhdGE7XG4gIH1cblxuICBzdGF0aWMgZ2V0IHN0eWxlcygpOiBDU1NSZXN1bHRHcm91cCB7XG4gICAgcmV0dXJuIGNzc2BcbiAgICAgIGhhLWNhcmQge1xuICAgICAgICBoZWlnaHQ6IDEwMCU7XG4gICAgICB9XG4gICAgICAuY2FyZC1oZWFkZXIge1xuICAgICAgICBwYWRkaW5nLWJvdHRvbTogMDtcbiAgICAgIH1cbiAgICAgIC5jb250ZW50IHtcbiAgICAgICAgcGFkZGluZzogMTZweDtcbiAgICAgIH1cbiAgICAgIC5oYXMtaGVhZGVyIHtcbiAgICAgICAgcGFkZGluZy10b3A6IDA7XG4gICAgICB9XG4gICAgICAubm8tZGF0YSB7XG4gICAgICAgIHBvc2l0aW9uOiBhYnNvbHV0ZTtcbiAgICAgICAgaGVpZ2h0OiAxMDAlO1xuICAgICAgICB0b3A6IDA7XG4gICAgICAgIGxlZnQ6IDA7XG4gICAgICAgIHJpZ2h0OiAwO1xuICAgICAgICBkaXNwbGF5OiBmbGV4O1xuICAgICAgICBqdXN0aWZ5LWNvbnRlbnQ6IGNlbnRlcjtcbiAgICAgICAgYWxpZ24taXRlbXM6IGNlbnRlcjtcbiAgICAgICAgcGFkZGluZzogMjAlO1xuICAgICAgICBtYXJnaW4tbGVmdDogMzJweDtcbiAgICAgICAgYm94LXNpemluZzogYm9yZGVyLWJveDtcbiAgICAgIH1cbiAgICBgO1xuICB9XG59XG5cbmRlY2xhcmUgZ2xvYmFsIHtcbiAgaW50ZXJmYWNlIEhUTUxFbGVtZW50VGFnTmFtZU1hcCB7XG4gICAgXCJodWktZW5lcmd5LXVzYWdlLWdyYXBoLWNhcmRcIjogSHVpRW5lcmd5VXNhZ2VHcmFwaENhcmQ7XG4gIH1cbn1cbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./src/panels/lovelace/cards/energy/hui-energy-usage-graph-card.ts\n");

/***/ })

}]);